
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.27.0" theme-name="Stellar" theme-version="1.27.0">
  
  <meta name="generator" content="Hexo 7.1.1">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>VulnerabilityInsightDocs：二. 离线密码破解 - SafeKiller Zone</title>

  
    <meta name="description" content="总字符数: 58.63K                代码: 37.36K, 文本: 13.63K               预计阅读时间: 3.69 小时               身份认证 禁止明文传输密码 每次认证使用HASH算法加密密码传输(HASH算法加密容易、解密困难) 服务器端用户数据库应加盐加密保存   破解思路 嗅探获取密码HASH 利用漏洞登录服务器并从用户数据">
<meta property="og:type" content="website">
<meta property="og:title" content="二. 离线密码破解">
<meta property="og:url" content="https://jiangjiyue.github.io/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E7%A6%BB%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html">
<meta property="og:site_name" content="SafeKiller Zone">
<meta property="og:description" content="总字符数: 58.63K                代码: 37.36K, 文本: 13.63K               预计阅读时间: 3.69 小时               身份认证 禁止明文传输密码 每次认证使用HASH算法加密密码传输(HASH算法加密容易、解密困难) 服务器端用户数据库应加盐加密保存   破解思路 嗅探获取密码HASH 利用漏洞登录服务器并从用户数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300739975.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402022052626.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402022052865.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300740538.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300857200.webp">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300800706.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300801317.jpeg">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300747300.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748383.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748288.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748582.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748371.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749270.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749061.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749628.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749639.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749515.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300906674.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300906261.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300750190.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300750914.png">
<meta property="article:published_time" content="2009-04-22T19:24:48.000Z">
<meta property="article:modified_time" content="2024-02-09T08:13:36.000Z">
<meta property="article:author" content="Kill3r">
<meta property="article:tag" content="Linux, Nginx, Zabbix, ELK, Security, Penetration">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png">
  
  
  
  <meta name="keywords" content="Linux, Nginx, Zabbix, ELK, Security, Penetration">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="SafeKiller Zone" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.27.0">

  
    <link rel="shortcut icon" href="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401260729165.jpg">
  

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" /><link rel="stylesheet" href="/css/darkmode.css">
</head>
<body>



<div class="l_body s:aa content tech" id="start" layout="wiki" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><div class="icon"><img no-lazy class="icon" src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402020909750.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/image/2659360.svg';"></div><a class="title" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html"><div class="main" ff="title">VulnerabilityInsightDocs</div><div class="sub normal cap">漏洞篇</div><div class="sub hover cap" style="opacity:0"> 涵盖网络安全漏洞识别与防御、风险评估及攻防演练</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" data-filter="/wiki/VulnerabilityInsightDocs" placeholder="搜索常见漏洞分析内容..."></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item active" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="导航" href="/sites/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="社交" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a><a class="nav-item" title="更多" href="/tools/" style="color:#d55afa"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2s10 4.477 10 10" opacity=".5"/><path fill="currentColor" d="M12.75 9a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V15a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25z"/></svg></a></nav>
</div>
<div class="widgets">

<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">漏洞挖掘理论</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html#start"><span class="toc-text">一. 从输入讲起</span></a></div><div class="widget-header dis-select"><span class="name">暴力破解</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%BC%B1%E5%8F%A3%E4%BB%A4.html"><span class="toc-text">二. 弱口令</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%9C%A8%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="toc-text">二. 在线密码破解</span></a><a class="link active" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E7%A6%BB%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="toc-text">二. 离线密码破解</span><svg class="active-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M21 11.098v4.993c0 3.096 0 4.645-.734 5.321c-.35.323-.792.526-1.263.58c-.987.113-2.14-.907-4.445-2.946c-1.02-.901-1.529-1.352-2.118-1.47a2.225 2.225 0 0 0-.88 0c-.59.118-1.099.569-2.118 1.47c-2.305 2.039-3.458 3.059-4.445 2.945a2.238 2.238 0 0 1-1.263-.579C3 20.736 3 19.188 3 16.091v-4.994C3 6.81 3 4.666 4.318 3.333C5.636 2 7.758 2 12 2c4.243 0 6.364 0 7.682 1.332C21 4.665 21 6.81 21 11.098" opacity=".5"/><path fill="currentColor" d="M9 5.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg></a></div><div class="widget-header dis-select"><span class="name">数据库安全</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%89.%20SQL%E6%B3%A8%E5%85%A5.html"><span class="toc-text">三. SQL注入</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%89.%20SqlMap%E4%BD%BF%E7%94%A8.html"><span class="toc-text">三. SqlMap使用</span></a></div><div class="widget-header dis-select"><span class="name">XSS跨站脚本攻击</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%94.%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC.html"><span class="toc-text">五. XSS跨站脚本</span></a></div><div class="widget-header dis-select"><span class="name">文件上传</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%85%AD.%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html"><span class="toc-text">六. 文件上传</span></a></div><div class="widget-header dis-select"><span class="name">文件包含</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%83.%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB.html"><span class="toc-text">七. 文件包含</span></a></div><div class="widget-header dis-select"><span class="name">同源策略</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%85%AB.%20%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5.html"><span class="toc-text">八. 同源策略</span></a></div><div class="widget-header dis-select"><span class="name">CSRF跨站请求伪造</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B9%9D.%20CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0.html"><span class="toc-text">九. CSRF跨站请求伪造</span></a></div><div class="widget-header dis-select"><span class="name">SSRF服务端请求伪造</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81.%20SSRF%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0.html"><span class="toc-text">十. SSRF服务端请求伪造</span></a></div><div class="widget-header dis-select"><span class="name">九、远程代码执行&命令执行</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%B8%80.%20RCE.html"><span class="toc-text">十一. RCE</span></a></div><div class="widget-header dis-select"><span class="name">XXE和XPath注入</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%8C.%20XXE&XPath.html"><span class="toc-text">十二. XXE&XPath</span></a></div><div class="widget-header dis-select"><span class="name">未授权访问</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%B8%89.%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE.html"><span class="toc-text">十三. 未授权访问</span></a></div><div class="widget-header dis-select"><span class="name">逻辑漏洞</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="toc-text">十四. 逻辑漏洞</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="toc-text">十四. 业务逻辑漏洞</span></a></div><div class="widget-header dis-select"><span class="name">反序列化</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%94.%20PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.html"><span class="toc-text">十五. PHP反序列化</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%94.%20Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.html"><span class="toc-text">十五. Java反序列化</span></a></div></widget>



<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span><a class="cap-action" id="rss" title="Subscribe" href="/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M5 21q-.825 0-1.412-.587T3 19q0-.825.588-1.412T5 17q.825 0 1.413.588T7 19q0 .825-.587 1.413T5 21m13.5 0q-.65 0-1.088-.475T16.9 19.4q-.275-2.425-1.312-4.537T12.9 11.1q-1.65-1.65-3.762-2.687T4.6 7.1q-.65-.075-1.125-.512T3 5.5q0-.65.45-1.062t1.075-.363q3.075.275 5.763 1.563t4.737 3.337q2.05 2.05 3.338 4.738t1.562 5.762q.05.625-.363 1.075T18.5 21m-6 0q-.625 0-1.075-.437T10.85 19.5q-.225-1.225-.787-2.262T8.65 15.35q-.85-.85-1.888-1.412T4.5 13.15q-.625-.125-1.062-.575T3 11.5q0-.65.45-1.075t1.075-.325q1.825.25 3.413 1.063t2.837 2.062q1.25 1.25 2.063 2.838t1.062 3.412q.1.625-.325 1.075T12.5 21"/></svg></a></div><div class="widget-body fs14"><a class="item title" href="/wiki/VirtDocs/%E4%B8%89.%20%E5%A4%A7%E5%9E%8B%E5%88%86%E5%B8%83%E5%BC%8Fk8s%E9%9B%86%E7%BE%A4%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html"><span class="title"><strong>VirtDocs</strong><span class="dot"></span>三. 大型分布式k8s集群从入门到精通</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E4%BA%94.%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>五. XSS跨站脚本</span></a><a class="item title" href="/wiki/VirtDocs/%E4%BA%8C.%20Docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html"><span class="title"><strong>VirtDocs</strong><span class="dot"></span>二. Docker从入门到精通</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%9C%A8%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>二. 在线密码破解</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>十四. 逻辑漏洞</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/JiangJiYue/" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa-brands fa-github"></i></a><a class="social" href="https://space.bilibili.com/238008115" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa-brands fa-bilibili fa-bounce"></i></a><a class="social" href="/atom.xml" rel="noopener noreferrer"><i class="fa-solid fa-rss fa-shake"></i></a><a class="social" href="/comments/" rel="noopener noreferrer"><i class="fa-regular fa-comment-dots"></i></a><a class="social" href="javaScript:void(0);" rel="noopener noreferrer"><i class="fa-solid fa-circle-half-stroke fa-flip"></i></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" id="menu" href="/wiki">文档</a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html">VulnerabilityInsightDocs</a></div>
<div class="flex-row" id="post-meta"><span class="text created">更新于：<time datetime="2024-02-09T08:13:36.000Z">2024-02-09</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>二. 离线密码破解</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><div class="tag-plugin grid" bg="card" style="grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));"><div class="cell" style="">
    <p>总字符数: 58.63K </p>
    </div>
    <div class="cell" style="">
    <p>代码: 37.36K, 文本: 13.63K</p>
    </div>
    <div class="cell" style="">
    <p>预计阅读时间: 3.69 小时</p>
    </div>
    </div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png" data-fancybox="true"/></div></div>
<blockquote>
<ul>
<li>身份认证<ul>
<li>禁止明文传输密码</li>
<li>每次认证使用HASH算法加密密码传输(HASH算法加密容易、解密困难)</li>
<li>服务器端用户数据库应加盐加密保存</li>
</ul>
</li>
<li>破解思路<ul>
<li>嗅探获取密码HASH</li>
<li>利用漏洞登录服务器并从用户数据库获取密码HASH</li>
<li>识别HASH类型<ul>
<li>长度字符集</li>
</ul>
</li>
<li>利用离线破解工具碰撞密码HASH</li>
</ul>
</li>
<li>优势<ul>
<li>离线不会触发密码锁定机制</li>
<li>不会产生大量登录失败日志引起管理员注意</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="哈希-密码基础"><a href="#哈希-密码基础" class="headerlink" title="哈希-密码基础"></a>哈希-密码基础</h2><h3 id="专业术语"><a href="#专业术语" class="headerlink" title="专业术语"></a>专业术语</h3><table>
<thead>
<tr>
<th>术语</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><code>Plaintext</code>:明文</td>
<td>加密或进行哈希计算之前的数据,通常是文本.但不总是,因为它可以是一张照片或其他文件.</td>
</tr>
<tr>
<td><code>Encoding</code>:编码</td>
<td>这不是一种加密形式,只是一种数据表示形式.如 base64或十六进制.</td>
</tr>
<tr>
<td><code>Hash</code>:哈希</td>
<td><code>hash</code>意译是散列,音译是哈希,哈希值是散列函数的输出.哈希也可以用作动词:<code>to hash</code>,意思是生成某些数据的<code>hash</code>(散列) 值.</td>
</tr>
<tr>
<td><code>Brute force</code>:暴力破解</td>
<td>通过尝试每个不同的密码或每个不同的密钥来破解加密</td>
</tr>
<tr>
<td><code>Cryptanalysis</code>:密码分析</td>
<td>通过发现基础数学的弱点来攻击密码学(通过发现基数的弱点来攻击密码加密技术)</td>
</tr>
</tbody></table>
<h3 id="哈希-散列-函数是什么"><a href="#哈希-散列-函数是什么" class="headerlink" title="哈希(散列)函数是什么?"></a>哈希(散列)函数是什么?</h3><h4 id="哈希函数介绍"><a href="#哈希函数介绍" class="headerlink" title="哈希函数介绍"></a>哈希函数介绍</h4><blockquote>
<p>​	Hash函数,又称<strong>杂凑函数、散列函数</strong>,它能够将<strong>任意长度的信息转换成固定长度的哈希值</strong>(数字摘要),并且任意不同长度消息或者文件所生成的哈希值是不一样的.</p>
</blockquote>
<blockquote>
<ol>
<li><strong>不可逆性:</strong> hash函数是没有key的,所以哈希函数是不可逆的,这意味着很难或不可能从哈希函数的输出返回到输入.即使对于相同的输入,好的哈希函数也应该产生唯一的哈希值.</li>
<li><strong>固定输出大小:</strong> 哈希函数的输出是固定大小的,不论输入数据的大小.这有助于确保输出的一致性,无论输入是多大.</li>
<li><strong>雪崩效应</strong>:在哈希函数或密码散列函数中,微小的输入变化会引起输出完全不同的现象.具体来说,如果输入数据发生了细微的修改,其对应的哈希值将会有很大的差异.</li>
<li><strong>无碰撞性</strong>:在输入空间中的任意两个不同的输入值生成的哈希值是唯一的,不会产生碰撞</li>
<li><strong>输出的编码:</strong> 哈希函数的输出通常是原始字节,可以通过不同的编码方式进行呈现,例如以64为基数的base64编码或十六进制形式.这样的编码不提供有关原始数据的有用信息.</li>
</ol>
<p>常见的Hash算法有:</p>
<ul>
<li>MD5算法:以512位数据块为单位来处理输入,产生<strong>128</strong>位的信息摘要.常用于文件校验.</li>
<li>SHA算法:以512位数据块为单位来处理输入,产生<strong>160</strong>位的哈希值,具有比MD5更强的安全性</li>
<li>SM3国产算法:消息分组长度为512比特,输出<strong>256</strong>位摘要</li>
</ul>
</blockquote>
<h4 id="hash碰撞"><a href="#hash碰撞" class="headerlink" title="hash碰撞"></a>hash碰撞</h4><blockquote>
<p>哈希碰撞是指两个不同的输入经过哈希函数后产生相同的输出.哈希函数的设计目标是尽可能避免碰撞,但由于输入空间大于输出空间,必然存在某些输入将会产生相同的输出.然而,好的哈希算法应该使得找到碰撞变得非常困难.</p>
</blockquote>
<p>MD5和SHA-1确实已经受到攻击,且存在能够制造哈希碰撞的技术,使得它们不再被认为是安全的哈希算法.在实际应用中,特别是对于密码存储等敏感场景,推荐使用更安全的哈希算法,如SHA-256、SHA-3等.</p>
<div class="tag-plugin colorful folders" ><details class="folder" index="0"><summary><span>MD5碰撞的例子</span></summary><div class="body"><div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.mscs.dal.ca/~selinger/md5collision/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.mscs.dal.ca/~selinger/md5collision/</span></div><div class="bottom"><span class="title">https://www.mscs.dal.ca/~selinger/md5collision/</span><span class="cap desc footnote"></span></div></a></div></div></details><details class="folder" index="1"><summary><span>SHA-1碰撞的例子</span></summary><div class="body"><div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://shattered.io/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://shattered.io/</span></div><div class="bottom"><span class="title">https://shattered.io/</span><span class="cap desc footnote"></span></div></a></div></div></details></div>

<p>由于哈希碰撞的存在,确实不应该完全依赖于哈希算法来确保密码或数据的安全性.在密码存储中,推荐使用强大且抗碰撞能力较强的哈希算法,并结合适当的安全措施.</p>
<div class="tag-plugin colorful note" color="red"><div class="body"><p>例如:使用<code>盐(salt)</code>来增加密码的复杂性。</p></div></div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300739975.png" data-fancybox="true"/></div></div>

<h3 id="哈希的用途"><a href="#哈希的用途" class="headerlink" title="哈希的用途"></a>哈希的用途</h3><p>哈希用于网络安全的两个主要目的:      </p>
<ol>
<li><p>验证数据的完整性</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402022052626.png" data-fancybox="true"/></div></div>
</li>
<li><p>验证密码</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402022052865.png" data-fancybox="true"/></div></div></li>
</ol>
<h4 id="使用hash进行密码验证"><a href="#使用hash进行密码验证" class="headerlink" title="使用hash进行密码验证"></a>使用hash进行密码验证</h4><p>​	网络应用程序通常需要验证用户密码,明文存储密码会导致安全问题,如数据库泄露.数据泄露中常见的密码字典<code>rockyou.txt</code>源于明文存储的MySpace密码.密码明文存储使得攻击者能够轻松获得用户密码.</p>
<p>哈希函数是密码存储的安全选择,它是不可逆的,且不需要存储密钥.哈希碰撞是两个不同输入产生相同输出的情况,而彩虹表可用于快速查找哈希值对应的原始密码.为了防范相同密码的问题,可以使用<code>盐</code>增加哈希的复杂性.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300740538.png" data-fancybox="true"/></div></div>

<p>像<code>Crackstation</code>(哈希破解网站) 这样的网站内部会使用巨大的彩虹表为无盐哈希(散列)提供快速的密码破解.在已排序的哈希列表中进行查找确实非常快,比尝试直接破解哈希要快得多.</p>
<h4 id="防范彩虹表"><a href="#防范彩虹表" class="headerlink" title="防范彩虹表"></a>防范彩虹表</h4><p>​	为了应对彩虹表破解<code>hash</code>,我们可以在密码中添加一个 <code>Salt(加盐操作)</code>.</p>
<p><code>Salt</code>是随机生成并存储在数据库中的值,对于每个用户都是独一无二的.</p>
<p>​	理论上,你可以对所有用户使用相同的<code>salt</code>,但这意味着重复的密码仍然具有相同的<code>hash</code>,并且仍然可以使用该<code>salt</code>创建特定的密码.</p>
<p>​	<code>Salt</code>被添加到密码的开头或结尾,然后进行哈希计算,这意味着即使每个用户都有相同的密码,他们也会有不同的密码哈希.像<code>bcrypt</code>和<code>sha512crypt</code>这样的哈希(散列)函数会自动进行加盐,盐不需要保密.</p>
<div class="tag-plugin colorful folders" ><details class="folder" index="0"><summary><span>实际PHP代码中如何使用Salt</span></summary><div class="body"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 数据库参数配置</span></span><br><span class="line"><span class="variable">$host</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="variable">$dbUser</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbPassword</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="variable">$dbName</span> = <span class="string">&#x27;mydatabase&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用mysqli对象方式创建数据库连接</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="variable">$host</span>, <span class="variable">$dbUser</span>, <span class="variable">$dbPassword</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查数据库连接是否成功</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error . <span class="string">&quot;&lt;/br&gt;&quot;</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查数据库是否存在</span></span><br><span class="line"><span class="variable">$db_selected</span> = <span class="title function_ invoke__">mysqli_select_db</span>(<span class="variable">$conn</span>, <span class="variable">$dbName</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$db_selected</span>) &#123;</span><br><span class="line">    <span class="comment">// SQL语句,如果数据库不存在则创建数据库</span></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;CREATE DATABASE IF NOT EXISTS <span class="subst">$dbName</span>&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>) === <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Database created successfully&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Error creating database: &quot;</span> . <span class="variable">$conn</span>-&gt;error . <span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择连接的数据库</span></span><br><span class="line"><span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">select_db</span>(<span class="variable">$dbName</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查数据表是否存在</span></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;SHOW TABLES LIKE &#x27;users&#x27;&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// SQL语句,创建一个名为users的表,如果该表不存在的话</span></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;CREATE TABLE IF NOT EXISTS users (</span></span><br><span class="line"><span class="string">        id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">        username VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">        password VARCHAR(255) NOT NULL,</span></span><br><span class="line"><span class="string">        registration_date TIMESTAMP</span></span><br><span class="line"><span class="string">    )&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行创建表的SQL语句并检查是否成功</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>) === <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Table users created successfully&lt;/br&gt;&quot;</span>; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Error creating table: &quot;</span> . <span class="variable">$conn</span>-&gt;error . <span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取GET请求中的参数</span></span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]; <span class="comment">// 获取名为&#x27;action&#x27;的GET参数,该参数用来决定是执行注册还是登录操作</span></span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]; <span class="comment">// 获取名为&#x27;username&#x27;的GET参数</span></span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]; <span class="comment">// 获取名为&#x27;password&#x27;的GET参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册用户的逻辑处理</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> == <span class="string">&#x27;register&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$registration_date</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>); <span class="comment">// 获取当前时间作为注册时间</span></span><br><span class="line">    <span class="comment">// 使用MD5加密算法对密码和注册时间进行拼接加密</span></span><br><span class="line">    <span class="variable">$encryptedPassword</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span> . <span class="variable">$registration_date</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 准备SQL语句进行插入操作</span></span><br><span class="line">    <span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;INSERT INTO users (username, password, registration_date) VALUES (?, ?, ?)&quot;</span>);</span><br><span class="line">    <span class="comment">// 绑定参数到预处理语句</span></span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;sss&quot;</span>, <span class="variable">$username</span>, <span class="variable">$encryptedPassword</span>, <span class="variable">$registration_date</span>);</span><br><span class="line">    <span class="comment">// 执行预处理语句并检查是否成功</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;New record created successfully&lt;/br&gt;&quot;</span>; <span class="comment">// 用户注册成功的消息</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$stmt</span>-&gt;error; <span class="comment">// 如果注册失败,则显示错误消息</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 关闭预处理语句</span></span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录用户的逻辑处理</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> == <span class="string">&#x27;login&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 准备SQL语句进行用户信息检索</span></span><br><span class="line">    <span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;SELECT * FROM users WHERE username = ?&quot;</span>);</span><br><span class="line">    <span class="comment">// 绑定参数到预处理语句</span></span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bind_param</span>(<span class="string">&quot;s&quot;</span>, <span class="variable">$username</span>);</span><br><span class="line">    <span class="comment">// 执行预处理语句</span></span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">    <span class="comment">// 获取结果集</span></span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">get_result</span>();</span><br><span class="line">    <span class="comment">// 检查结果集中是否有记录(即是否有匹配的用户)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 提取结果集中的用户数据</span></span><br><span class="line">        <span class="variable">$user</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>();</span><br><span class="line">        <span class="comment">// 为了登录验证,将提交的密码和用户的注册时间再次进行MD5加密</span></span><br><span class="line">        <span class="variable">$encryptedPassword</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span> . <span class="variable">$user</span>[<span class="string">&#x27;registration_date&#x27;</span>]);</span><br><span class="line">        <span class="comment">// 比较数据库中的密码和加密后提交的密码是否一致</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$user</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$encryptedPassword</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;User logged in successfully&lt;/br&gt;&quot;</span>; <span class="comment">// 用户登录成功的消息</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Invalid username or password&lt;/br&gt;&quot;</span>; <span class="comment">// 如果密码不匹配,则显示无效的用户名或密码</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Invalid username or password&lt;/br&gt;&quot;</span>; <span class="comment">// 如果没有匹配的用户记录,则显示无效的用户名或密码</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 关闭预处理语句</span></span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭数据库连接</span></span><br><span class="line"><span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>http://127.0.0.1/salt.php?action=register&amp;username=kill3r&amp;password=password</code></p><p><code>http://127.0.0.1/salt.php?action=login&amp;username=kill3r&amp;password=password</code></p><table><thead><tr><th>Password</th><th>Salt</th><th>MD5 Hash</th></tr></thead><tbody><tr><td>password</td><td>(无salt)</td><td>5f4dcc3b5aa765d61d8327deb882cf99</td></tr><tr><td>password</td><td>2024-02-02 20:25:52</td><td>8b79ff043c42bcb1e287d8353418979c</td></tr></tbody></table><div class="tag-plugin colorful note" color="red"><div class="body"><p>不过为了提高代码的安全性,还可以考虑使用编程语言提供的密码存储和验证机制如PHP中的<code>password_hash()</code>和<code>password_verify()</code>函数.并且通过POST而非GET方法传输敏感数据</p></div></div><div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.php.net/manual/en/function.password-hash.php" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.php.net/manual/en/function.password-hash.php</span></div><div class="bottom"><span class="title">https://www.php.net/manual/en/function.password-hash.php</span><span class="cap desc footnote"></span></div></a></div><div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.php.net/manual/en/function.password-verify.php" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.php.net/manual/en/function.password-verify.php</span></div><div class="bottom"><span class="title">https://www.php.net/manual/en/function.password-verify.php</span><span class="cap desc footnote"></span></div></a></div></div></details></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.cmd5.com/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.cmd5.com/</span></div><div class="bottom"><span class="title">https://www.cmd5.com/</span><span class="cap desc footnote"></span></div></a></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.somd5.com/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.somd5.com/</span></div><div class="bottom"><span class="title">https://www.somd5.com/</span><span class="cap desc footnote"></span></div></a></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://www.sojson.com/encrypt_md5.html" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://www.sojson.com/encrypt_md5.html</span></div><div class="bottom"><span class="title">https://www.sojson.com/encrypt_md5.html</span><span class="cap desc footnote"></span></div></a></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://crackstation.net/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://crackstation.net/</span></div><div class="bottom"><span class="title">https://crackstation.net/</span><span class="cap desc footnote"></span></div></a></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://hashes.com/en/decrypt/hash" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://hashes.com/en/decrypt/hash</span></div><div class="bottom"><span class="title">https://hashes.com/en/decrypt/hash</span><span class="cap desc footnote"></span></div></a></div>

<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://crackstation.net/" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://crackstation.net/</span></div><div class="bottom"><span class="title">https://crackstation.net/</span><span class="cap desc footnote"></span></div></a></div>

<h2 id="彩虹表-密码基础"><a href="#彩虹表-密码基础" class="headerlink" title="彩虹表-密码基础"></a>彩虹表-密码基础</h2><blockquote>
<p>MD5的全称是<code>Message-Digest Algorithm 5</code>(信息-摘要算法)</p>
<p>特点是不可逆的,一般解密不了.那有没有想过,为什么各种工具网站都可以进行MD5解密呢?</p>
<p>彩虹表,了解一下.</p>
</blockquote>
<h3 id="如何存储密码才是安全的"><a href="#如何存储密码才是安全的" class="headerlink" title="如何存储密码才是安全的?"></a>如何存储密码才是安全的?</h3><p>密码存储有几种方式:</p>
<ul>
<li>直接存储密码明文<code>m</code></li>
<li>存储密码明文的哈希值<code>hash(m)</code></li>
<li>存储密码明文的加盐哈希<code>hash(m+salt)</code>,这里的<code>Salt</code>可以是用户名,手机号等,但必须保证每个用户的<code>Salt</code>都不一样才是安全的.</li>
</ul>
<p>如果数据库被入侵</p>
<ol>
<li>第一种方式:明文存储,无安全性可言.</li>
<li>第二种方式:虽然是入侵者得到的是<code>Hash</code>值,但由于彩虹表的存在,也很容易批量还原出密码明文来.</li>
<li>只有第三种方式才是相对安全的.</li>
</ol>
<h3 id="彩虹表不是-密码–-明文-的简单存储"><a href="#彩虹表不是-密码–-明文-的简单存储" class="headerlink" title="彩虹表不是 密码–&gt;明文 的简单存储"></a>彩虹表不是 密码–&gt;明文 的简单存储</h3><p>要从<code>c=hash(m)</code>逆向得到原始明文m,有三种办法:</p>
<ul>
<li>暴力破解法:时间成本太高.</li>
<li>字典法:提前构建一个<code>明文-&gt;密文</code>对应关系的一个大型数据库,破解时通过密文直接反查明文.但存储一个这样的数据库,空间成本是惊人的.</li>
<li>构建彩虹表:在字典法的基础上改进,以时间换空间.是现在破解哈希常用的办法.</li>
</ul>
<h2 id="彩虹表的前身–预先计算的散列链"><a href="#彩虹表的前身–预先计算的散列链" class="headerlink" title="彩虹表的前身–预先计算的散列链"></a>彩虹表的前身–预先计算的散列链</h2><div class="tag-plugin colorful folders" ><details class="folder" index="0"><summary><span>预先计算的散列链</span></summary><div class="body"><p>既然存储所有的明文密码对需要的空间太大,密码学家们想出了一种以计算时间降低存储空间的办法:<code>预计算的哈希链集</code>(<code>Precomputed hash chains</code>).<br>这是一条<code>k=2</code>哈希链:</p><blockquote><p>K的取值不是严格规定的,而是根据具体需求和安全性考虑选择的.在密码学中,K表示哈希链的长度,即链中节点的数量.较长的哈希链可以提供更高的安全性,但会增加存储和验证的开销.</p><p>选择适当的K值需要综合考虑以下因素:</p><ol><li>安全性要求:安全性要求较高的应用通常需要更长的哈希链来增加破解的难度.</li><li>存储空间:更长的哈希链会占用更多的存储空间,因此需要考虑存储成本和可扩展性.</li><li>验证速度:验证一个密码时,需要在哈希链上执行多次哈希运算.较长的哈希链会增加验证的时间开销.</li></ol><p>一般而言,选择K值是一个权衡取舍的过程,根据具体应用的需求和限制来确定.不同的场景可能需要不同的K值来平衡安全性和效率.</p><p>实际应用中,可以采用除了单一的哈希函数之外的更复杂的哈希结构、加盐等技术来增加密码的安全性.K的取值范围可以根据具体需求和应用场景来确定,通常从2开始,而常见的范围可以是2到数十之间.较小的K值适用于需要较低计算和存储开销的场景,但相对较弱于攻击.较大的K值可以提供更高的安全性,但会增加计算和存储的负担.</p></blockquote><p>哈希链</p><ul><li><p>H函数就是要破解的哈希函数.</p></li><li><p>约简函数(<code>reduction function</code>)R函数是构建这条链的时候定义的一个函数:它的值域和定义域与H函数相反.通过该函数可以将哈希值约简为一个与原文相同格式的值.</p><blockquote><p>约简函数(<code>reduction function</code>)又称归约函数.是彩虹表技术中的关键组成部分之一.它在散列链的构建和使用过程中发挥着重要作用.约简函数的主要目的是将散列值(密码的哈希结果)映射回原始明文密码的空间,从而在彩虹表中实现存储和破解密码的有效性和效率.</p></blockquote></li></ul><div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300857200.webp" data-fancybox="true"/></div></div><p>这条链是这样生成的:</p><ol><li>随机选择初始明文 <code>aaaaaa</code>,通过哈希函数<code>H(aaaaaa)</code>进行哈希运算,得到哈希值<code>281DAF40</code><ul><li>哈希函数<code>H()</code> 是一个确定性函数,将输入数据(在这种情况下是明文 <code>aaaaaa</code>)转换为具有固定长度的哈希值.哈希函数的特点是单向不可逆的,即无法从哈希值逆向计算出原始数据.因此,通过应用<code>H()</code>函数,我们可以将 <code>aaaaaa</code> 处理成哈希值 <code>281DAF40</code>.</li></ul></li><li>使用约简函数 <code>R()</code>,将哈希值 <code>281DAF40</code> 约简为与原文相同格式的值,得到明文 <code>sgfnyd</code>.<ul><li>约简函数 R() 是一个定义在哈希值空间上的函数,其作用是将哈希值映射回与原始明文相同格式的值.这样做是为了使哈希链中的后续哈希值能够继续通过哈希函数生成新的哈希值.</li><li>在这个例子中,&#96;&#96;R()<code>函数将哈希值</code>281DAF40<code>约简为明文</code>sgfnyd<code>,并确保明文的格式与最初的输入 </code>aaaaaa&#96; 相匹配.</li></ul></li><li>将明文 <code>sgfnyd</code> 再次通过哈希函数 H() 进行哈希运算,得到哈希值 <code>920ECF10</code>.<ul><li>现在,我们使用哈希函数 H() 处理明文 <code>sgfnyd</code>,并得到哈希值 <code>920ECF10</code>.这个哈希值将用作哈希链中的下一个节点,它与先前的哈希值 <code>281DAF40</code> 相关联.</li></ul></li><li>使用约简函数 R(),将哈希值 <code>920ECF10</code> 约简为明文 <code>kiebgt</code>.<ul><li>再次使用约简函数 R(),我们将哈希值 <code>920ECF10</code> 约简为明文 <code>kiebgt</code>.这样可以确保链中的明文保持一致,并且与之前的处理结果相匹配.</li></ul></li></ol><p>通过这些步骤的迭代,您可以构建一个哈希链,其中每个明文都通过哈希函数 H() 和约简函数 R() 相互关联.这种链的目的是验证数据的完整性和防篡改.</p><p>请注意,哈希函数的选择和约简函数的定义需要根据具体的安全需求进行.此外,在构建哈希链过程中,确保选择适当的哈希算法、安全策略和密钥管理等因素也是非常重要的.</p></div></details><details class="folder" index="1"><summary><span>预计算的哈希链集的使用</span></summary><div class="body"><p>当刚好得到的哈希值是 <code>920ECF10</code>,我们可以进行以下步骤来判断是否破解了哈希链集中的(<code>aaaaaa</code>,<code>kiebgt</code>)链条.</p><p>破解成功的情况:</p><ul><li><p>首先,我们对哈希值 <code>920ECF10</code> 进行一次约简运算,得到明文 <code>kiebgt</code>.</p></li><li><p>接下来,我们发现刚好命中了哈希链集中的(<code>aaaaaa</code>,<code>kiebgt</code>)链条.这意味着我们通过哈希链的计算过程,从初始明文 <code>aaaaaa</code> 开始重复计算,最终得到的哈希值恰好与目标哈希值 <code>920ECF10</code> 相匹配.</p><ul><li>要判断是否命中了哈希链集中的(<code>aaaaaa</code>,<code>kiebgt</code>)链条,需要按照以下步骤进行判断:<ol><li>首先,将明文 <code>aaaaaa</code>输入哈希函数 H() 进行哈希运算得到哈希值 <code>281DAF40</code>,然后再输入约简函数 R(),得到约简值 <code>sgfnyd</code>.</li><li>将约简值 <code>sgfnyd</code> 输入哈希函数 H() 进行哈希运算,得到哈希值 <code>920ECF10</code>.</li><li>比较得到的哈希值 <code>920ECF10</code> 是否与输入的哈希值相同.如果相同,则说明命中了哈希链集中的(<code>aaaaaa</code>,<code>kiebgt</code>)链条.这意味着输入的哈希值与链条中的下一个哈希值相匹配,并且通过约简函数 R() 可以得到与链条中的下一个明文相匹配的约简值.</li></ol></li></ul></li><li><p>由于哈希函数的单向性质,我们无法直接从哈希值逆推出原始明文.但根据我们的破解过程,我们已经确定了明文 <code>aaaaaa</code> 经过哈希链计算后得到的哈希值是 <code>920ECF10</code>,因此,我们可以说在这个特定的哈希链中,明文 <code>aaaaaa</code> 对应的哈希值就是 <code>920ECF10</code>.</p></li><li><p>所以,我们可以说在这种情况下,破解成功,并确定明文 <code>aaaaaa</code> 对应的哈希值以及整个哈希链.</p></li></ul><p>破解失败的情况:</p><ul><li>“密文不是 <code>920ECF10</code> 而是 <code>281DAF40</code>“:原来我们误以为目标哈希值是 <code>920ECF10</code>,但实际上它是 <code>281DAF40</code>.</li><li>“第一次 R 运算后的结果并未在末节点中找到”:我们进行第一次约简运算(R 运算),但得到的结果没有在哈希链的末节点中找到对应的值.</li><li>“则再重复一次 H 运算+R运算”:因此,我们再进行一次哈希运算(H 运算)和约简运算(R 运算).</li><li>“这时又得到了末节点中的值 <code>kiebgt</code>“:这次在末节点中找到了值 <code>kiebgt</code>.</li><li>“于是再从头开始运算”:由于找到了目标值 <code>kiebgt</code>,我们可以从初始明文 <code>aaaaaa</code> 开始重新进行哈希链计算.</li><li>“可知 <code>aaaaaa</code> 刚好可哈希值为 <code>281DAF40</code>“:经过重新计算,我们确认明文 <code>aaaaaa</code> 对应的哈希值确实是 <code>281DAF40</code>.</li></ul><p>另外,如果在重复了 k(&#x3D;2)次之后仍然没有在末节点中找到对应的值,那么破解被认为失败.</p></div></details><details class="folder" index="2"><summary><span>预计算的哈希链集的意义</span></summary><div class="body"><p>在哈希链攻击中,我们通过预先生成一组包含多条哈希链的集合,每条链的长度为k.当需要破解一个特定的哈希值时,只需要从预计算的哈希链集中找到与目标哈希值匹配的哈希链.由于每次破解只需要进行k次哈希运算,计算次数不会超过k.因此,相比于暴力破解方法,哈希链攻击能够大大节约时间.</p><p>另外,预计算的哈希链集中,每条链只保存了链的起始节点和结束节点,而不保存链中间的所有哈希值.这样相比于存储所有可能的明文哈希值,哈希链集所需的存储空间仅约为总哈希链数的倒数,即1&#x2F;k.因此,哈希链攻击也大大节约了存储空间的使用.</p></div></details><details class="folder" index="3"><summary><span>R函数的问题</span></summary><div class="body"><p>在预计算的哈希链集中,为了最大限度地发挥其作用,需要选择一个分布均匀的约简函数 R.当约简函数 R 不是分布均匀的时候,也就是当出现碰撞(两个不同的输入值得到相同的哈希值)时,就会出现下面这种情况</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">111</span> --H--&gt; EDEDED --R--&gt; <span class="number">222</span> --H--&gt; FEDEFE --R--&gt; <span class="number">333</span> --H--&gt; FEFEDC --R--&gt; <span class="number">444</span></span><br><span class="line"><span class="number">454</span> --H--&gt; FEDECE --R--&gt; <span class="number">333</span> --H--&gt; FEFEDC --R--&gt; <span class="number">444</span> -H--&gt; FEGEDC --R--&gt; <span class="number">555</span></span><br></pre></td></tr></table></figure><p>当两条哈希链发生重叠时,它们能够解密的明文数量远小于理论上的明文数量(即2×k).由于预计算的哈希链集只保存链条的首节点和末节点,而不保存中间的所有哈希值,因此无法快速发现这种重叠的链条.</p><p>假设有两条重叠的哈希链A和B,它们共享相同的哈希值.在解密过程中,只要找到任意一条哈希链的首节点和末节点,就可以通过逆向约简运算得到明文.然而,当存在重叠的哈希链时,其中一条链的首节点和末节点可能与另一条链的首节点和末节点相同.这意味着,在预计算的哈希链集中,实际上只能得到一条有效的链,而另一条链则被”覆盖”了,无法被利用解密其对应的明文.</p><p>因此,当发生重叠的链条时,能够解密的明文数量远小于理论上的明文数.由于预计算的哈希链集只保留了链条的首节点和末节点,无法直接检测到重复链条,因此这种重叠链条的存在需要特别注意.</p></div></details></div>

<h2 id="彩虹表"><a href="#彩虹表" class="headerlink" title="彩虹表"></a>彩虹表</h2><p>彩虹表的出现确实解决了哈希链攻击中的链重叠问题.在传统的哈希链攻击中,通过使用相同的R函数进行多次哈希迭代,不同链中的部分哈希值可能会发生重叠,导致无法正确匹配目标哈希值.</p>
<p>而彩虹表引入了多个不同的R函数(R1、R2、…、Rk)来进行每一步的哈希运算.这样,在生成每条哈希链时,使用不同的R函数可以避免链重叠问题.每个R函数都会产生不同的哈希映射,从而确保生成的哈希链之间没有重叠部分.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300800706.png" data-fancybox="true"/></div></div>

<blockquote>
<p>​	彩虹表是一种用于破解密码的方法,上图中的<code>k=3</code>表示每条哈希链由三个步骤组成.</p>
<p>​	为了降低R函数(映射函数)的冲突概率,彩虹表使用k个不同的R函数来执行每一步的操作.</p>
<p>​	具体来说,在每次迭代中,我们使用不同的R函数将哈希值映射回密码取值空间.这种密码破解方法称为彩虹表攻击.</p>
<p>实际的彩虹表中,哈希链通常比上面的示例要长得多.例如,在我们的例子中,全部84亿亿个<code>sha256</code>哈希值无法存储在彩虹表中.因此,我们可以将其转化为840亿个长度为1千万的哈希链.</p>
<p>在互联网上,甚至有一些预先计算好的彩虹表可以直接使用.因此,直接保存用户密码的<code>sha256</code>哈希值是非常不安全的做法.</p>
</blockquote>
<p>这样一来,及时发生碰撞,通常会是下面的情况:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 链条一</span><br><span class="line"><span class="number">111</span> --H--&gt; EDEDED --R1--&gt; <span class="number">222</span> --H--&gt; FEDEFE --R2--&gt; <span class="number">333</span> --H--&gt; FEFEDC --R3--&gt; <span class="number">444</span></span><br><span class="line"># 链条二</span><br><span class="line"><span class="number">454</span> --H--&gt; FEDECE --R1--&gt; <span class="number">333</span> --H--&gt; FEFEDC --R2--&gt; <span class="number">474</span> -H--&gt; FERFDC --R3--&gt; <span class="number">909</span></span><br></pre></td></tr></table></figure>

<p>链条1和链条2,这两个链条在某个位置上发生了碰撞,意味着它们的哈希值相同.</p>
<p>例如,在链条1的第二步操作后得到的哈希值与链条2的第一步操作后得到的哈希值相同.</p>
<p>然而,彩虹表在处理哈希碰撞时采用了一种特殊的策略.在彩虹表中,通过比较链条的末节点(即最后一个密码值),我们可以检测到碰撞,并且区分开这两个链条.换句话说,尽管它们在某个位置上产生了哈希碰撞,但由于它们最终的密码值不同,我们可以知道它们是不同的链条.</p>
<h3 id="彩虹表的使用"><a href="#彩虹表的使用" class="headerlink" title="彩虹表的使用"></a>彩虹表的使用</h3><p>彩虹表的使用比哈希链集稍微麻烦一些.</p>
<ul>
<li>首先,我们要假设待破解的密文位于某个哈希链的第k-1位置处.我们使用Rk函数对该密文进行逆向映射,得到一个中间值.</li>
<li>然后,我们在彩虹表的末节点中查找这个中间值是否存在.如果找到了相应的末节点,我们可以使用起始密码验证其正确性.</li>
<li>如果没有找到匹配的末节点,我们需要继续向前推进.我们假设密文位于第k-2位置处,然后进行Rk-1,H,Rk三步运算,得到新的中间值.</li>
<li>然后,我们再次在彩虹表的末节点中查找这个新的中间值.如果找到匹配的末节点,我们可以使用起始密码验证其正确性.</li>
<li>如果还是没有找到匹配的末节点,我们需要重复这个过程,每次向前推进一步,即进行Rk-1,H,Rk三步运算,直到达到最不利的情况,即需要执行完整的R1,H,…,Rk运算才能得出结论.</li>
</ul>
<p>如果无法在当前位置找到匹配的末节点,我们需要尝试不同的推进路径,以确保最终能够覆盖所有可能性.这种迭代操作的目的是确定给定的密文是否存在于彩虹表中,并找到相应的起始密码.</p>
<h3 id="彩虹表中时间、空间的平衡"><a href="#彩虹表中时间、空间的平衡" class="headerlink" title="彩虹表中时间、空间的平衡"></a>彩虹表中时间、空间的平衡</h3><p>对于哈希链集而言,最大计算次数是k,即在最坏情况下,需要进行k次哈希运算才能找到匹配.平均计算次数为<code>k/2</code>,因为每个明文经过哈希运算后,会得到两个结果,即起始密码和末节点.</p>
<p>而对于彩虹表来说,最大计算次数是<code>1+2+3+...+k</code>,即<code>k(k-1)/2</code>.这是因为彩虹表的每一列都需要经过不同次数的迭代运算.平均计算次数为<code>[(k+2) * (k+1)]/6</code>,这是根据彩虹表的结构和长度的数学推导得出的.</p>
<p>​	当k值较大时,彩虹表所需要的存储空间较小,因为它的每一列只需存储起始密码和末节点.而哈希链集在相同的密文数量下,需要存储更多的中间结果.因此,相对而言,彩虹表占用的空间较小.</p>
<p>​	但是,彩虹表在破解时间上可能会更长,尤其在k较大的情况下.这是因为彩虹表的计算次数较多,需要进行多次迭代运算才能找到匹配.而哈希链集由于每个明文只需要进行一次哈希运算,所以在相同的密文数量下,破解时间可能会相对较短.</p>
<p>因此,在选择使用哈希链集还是彩虹表时,需要综合考虑空间占用和破解时间之间的权衡.如果空间资源有限,可以选择使用彩虹表;如果追求更短的破解时间,可以选择使用哈希链集.</p>
<h3 id="常见的彩虹表和R函数举例"><a href="#常见的彩虹表和R函数举例" class="headerlink" title="常见的彩虹表和R函数举例"></a>常见的彩虹表和R函数举例</h3><ol>
<li><p>常见的彩虹表</p>
<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="http://project-rainbowcrack.com/table.htm" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">http://project-rainbowcrack.com/table.htm</span></div><div class="bottom"><span class="title">http://project-rainbowcrack.com/table.htm</span><span class="cap desc footnote"></span></div></a></div></li>
<li><p>R函数举例:假设明文为5位数字,则R函数是取哈希值中前5个数字.</p>
<div class="tag-plugin link dis-select"><a class="link-card rich" title="" href="https://crypto.stackexchange.com/questions/5900/example-rainbow-table-generation" target="_blank" rel="external nofollow noopener noreferrer" cardlink autofill="title,icon,desc"><div class="top"><div class="lazy img" data-bg="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/link/8f277b4ee0ecd.svg"></div><span class="cap link footnote">https://crypto.stackexchange.com/questions/5900/example-rainbow-table-generation</span></div><div class="bottom"><span class="title">https://crypto.stackexchange.com/questions/5900/example-rainbow-table-generation</span><span class="cap desc footnote"></span></div></a></div></li>
</ol>
<h3 id="彩虹表的获取"><a href="#彩虹表的获取" class="headerlink" title="彩虹表的获取"></a>彩虹表的获取</h3><p>可以自己编程生成彩虹表,也可以使用<code>RainbowCrack</code>或<code>Cain</code>等软件来生成.彩虹表的生成时间与字符集的大小、哈希链的长度成正比,如下图中<code>7位密码、全部字符集、哈希链长度为2万</code>的彩虹表大小为32G,本地生成大约需要332天,而从网上下载只需要2个小时左右,主流的彩虹表的大小普遍在100G以上,想要自己生成是几乎不可能的事.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300801317.jpeg" data-fancybox="true"/></div></div>

<p>彩虹表确实像它的名字一样美好,至少黑客眼里是这样.</p>
<p>上表是7位以内密码在不同字符集下构造出的彩虹表的情况,彩虹表中哈希链的长度和个数随着字符集的增长而增长,彩虹表的大小和生成时间也随之成倍增加.</p>
<p>7位数字组合在彩虹表面前简直就是秒破,即使最复杂的7位密码不到一个小时就能破解,如果采用普通的暴力攻击,破解时间可能需要三周.</p>
<h3 id="如何防御彩虹表"><a href="#如何防御彩虹表" class="headerlink" title="如何防御彩虹表"></a>如何防御彩虹表</h3><p>虽然彩虹表有着如此惊人的破解效率,但网站的安全人员仍然有办法防御彩虹表.最有效的方法就是<code>加盐</code>,加盐后的密码经过哈希加密得到的哈希串与加盐前的哈希串完全不同,黑客用彩虹表得到的密码根本就不是真正的密码.</p>
<p>即使黑客知道了<code>盐</code>的内容、加盐的位置,还需要对<code>H函数</code>和<code>R函数</code>进行修改,彩虹表也需要重新生成,因此加盐能大大增加利用彩虹表攻击的难度.</p>
<h2 id="归约函数"><a href="#归约函数" class="headerlink" title="归约函数"></a>归约函数</h2><blockquote>
<p>约简函数(<code>reduction function</code>)又称归约函数. </p>
<p>归约函数是一种抽象的函数概念,它用于将散列值映射回明文密码.具体的归约函数可以有不同的实现方式,但其基本目标是通过运算将散列值还原为明文密码.</p>
<p>一种常见的归约函数是简单的模运算.例如,可以将散列值对密码空间的大小取模,以得到还原后的明文密码.这样的归约函数可以表示为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reduced_password = hash_value % password_space_size</span><br></pre></td></tr></table></figure>

<p>其中,<code>hash_value</code>是散列值,<code>password_space_size</code>是密码空间的大小.</p>
<p>除了简单的模运算外,还可以使用其他更复杂的归约函数,例如异或运算、位移运算等.具体选择哪种归约函数取决于实际应用和安全需求.</p>
<p>需要注意的是,归约函数被设计为非可逆的,即从散列值到明文密码的还原过程是不可逆的.这是为了防止破解者能够轻易地通过逆向计算找到原始的明文密码.</p>
<p>因此,在彩虹表中,归约函数起到一个重要的作用,它影响着链的长度和破解的效率.通过选择合适的归约函数,可以在存储空间和破解速度之间做出权衡,以满足实际需求.</p>
</blockquote>
<h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><p>彩虹表之所以能够实现快速破解散列值,是因为它采用了预先计算大量散列值的方式.首先,将明文密码进行散列加密,生成初始的散列值.然后,通过应用归约函数对散列值进行处理,得到新的明文密码.接着,再次进行散列加密,重复该过程多次,直到生成足够数量的散列值.</p>
<p>通过计算足够数量的散列值并存储在彩虹表中,可以提高破解成功的概率.当需要破解某个散列值时,只需在彩虹表中查找是否存在对应的散列值,如果存在,则可以通过归约函数逆向推导出原始明文密码.</p>
<p>因此,理解归约函数的作用是彩虹表技术的核心.归约函数通过将散列值映射回明文密码,使得破解过程能够倒退回原始的密码空间.通过对散列值反复应用归约函数,可以生成一条包含明文密码和散列值的数据链.通过这种方式,彩虹表实现了在较小的存储空间内存储大量散列值和对应的明文密码,从而加快了破解的速度.</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>散列函数将原始明文密码映射为散列值,而归约函数则在彩虹表技术中将散列值映射回原始明文密码.然而,经过归约函数处理后的明文与生成该散列值的原始明文之间没有任何相似之处.</p>
<p>在彩虹表技术中,归约函数起到一个重要的作用,它通过一系列的操作将散列值还原为明文密码的近似值,使得破解者能够在彩虹表中查找对应的散列值.但需要明确的是,通过归约函数处理后的明文只是一个近似值,与生成该散列值的原始明文可能不完全相同.</p>
<p>这是因为归约函数是设计成非可逆的,即无法从散列值逆向计算出完全准确的原始明文密码.因此,经过归约函数处理后的明文密码仅仅是一个接近原始明文的候选值,而不是完全一致的结果.</p>
<p>彩虹表利用了归约函数的这个特性,通过存储和匹配大量的散列值和对应的归约函数处理后的明文密码,实现了快速的密码破解.破解者可以通过比对彩虹表中的散列值与归约函数处理后的明文密码,来寻找原始明文密码的近似值.</p>
<h3 id="阐述归约过程"><a href="#阐述归约过程" class="headerlink" title="阐述归约过程"></a>阐述归约过程</h3><p>对于彩虹表技术而言,生成一条数据链的过程包括多次迭代散列和归约操作,以构建包含明文和散列值的数据序列.这样的数据链可以用来快速破解散列值,并找到原始明文密码.</p>
<p>rtgen工具是一个用于生成彩虹表的工具,它会执行上述的迭代过程.首先,从一个明文密码开始,通过散列函数将其转换为散列值,然后使用归约函数将散列值映射回明文密码.接下来,再次使用散列函数对归约后的明文密码进行散列,再次使用归约函数映射回明文密码.如此反复进行多次迭代操作,直到生成数据链的长度满足需求.</p>
<p>在生成数据链时,仅需记录数据链的第一个节点(起始明文密码和对应的散列值)和最后一个节点(最终归约后的明文密码和对应的散列值).因为在彩虹表攻击中,只需要从起始节点开始,依次进行散列和归约操作,就可以在数据链中匹配到与目标散列值相同的散列值,并获取对应的明文密码.</p>
<p>需要注意的是,由于归约函数是非可逆的,生成的数据链中的明文密码是经过归约函数处理后的近似值,并不与原始明文密码完全相同.因此,在使用彩虹表进行破解时,需要对近似值进行一定的容错处理,以确保找到正确的明文密码.</p>
<h3 id="彩虹表破解散列值的基本思想"><a href="#彩虹表破解散列值的基本思想" class="headerlink" title="彩虹表破解散列值的基本思想"></a>彩虹表破解散列值的基本思想</h3><p>基于以上观察,我们可以得出以下结论:</p>
<p>在彩虹表技术中,为了增加破解的效率和减小空间消耗,通常会采用多个不同的归约函数.不同位置的节点会对应不同的归约函数,这是为了增加数据链的多样性和覆盖范围.</p>
<p>具体而言,每个数据链上的节点都包含一个明文密码和对应的散列值.每个节点通过特定的归约函数进行映射.当从链的起始节点开始进行散列和归约操作时,每次迭代都会应用不同的归约函数.</p>
<p>通过使用多个归约函数,可以生成多条具有不同规律和特性的数据链.这样做的目的是增加破解时的搜索空间,避免过于依赖单一的归约函数.由于不同的归约函数可能导致不同的映射结果,这意味着即使同一明文密码经过不同位置的节点进行归约,最终得到的散列值也可能不相同.</p>
<p>因此,通过在不同位置使用不同的归约函数,彩虹表能够覆盖更广泛的明文密码和散列值组合,提高破解效率.这样的设计能够减少数据链之间的冲突,并且可以通过使用多条数据链来提供更好的覆盖范围,提高破解成功的概率.</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>在目前的彩虹表技术中,通常会将归约函数的数量设置为与数据链的长度相等.这意味着每个彩虹表都对应一个归约函数,并且不同的归约函数会导致相同明文生成不同的散列结果.这种设计使得彩虹表中的散列结果具有更多的随机性和多样性.</p>
<p>通过使用不同的归约函数,彩虹表能够更好地覆盖明文密码和散列值的组合空间,增加破解时的搜索范围.由于不同的归约函数会导致不同的映射关系,相同的明文密码经过不同位置的节点进行归约后得到的散列值也会有所不同.这意味着即使在同一数据链上,相同的明文密码也可能对应多个不同的散列值.</p>
<p>因此,采用不同的归约函数可以为彩虹表提供更大的随机性和覆盖范围,增加破解过程中成功匹配散列值的概率.通过引入更多的归约函数,彩虹表可以更好地抵抗针对特定归约函数的攻击,提高密码破解的难度和耗费更多的计算资源.总之,归约函数的多样性是彩虹表技术中重要的设计因素之一,为破解散列值提供了更大的挑战.</p>
<h2 id="Windows-认证-密码基础"><a href="#Windows-认证-密码基础" class="headerlink" title="Windows 认证-密码基础"></a>Windows 认证-密码基础</h2><h3 id="Windows-Hash"><a href="#Windows-Hash" class="headerlink" title="Windows Hash"></a>Windows Hash</h3><p>分类如下:</p>
<ul>
<li><p>LM Hash</p>
</li>
<li><p>NTLM Hash</p>
</li>
<li><p>Net-NTLM Hash</p>
</li>
</ul>
<h4 id="Windows-Hash简介"><a href="#Windows-Hash简介" class="headerlink" title="Windows Hash简介"></a>Windows Hash简介</h4><ul>
<li><p>Windows系统内部不保存用户的明文密码,只保存密码的Hash值</p>
</li>
<li><p>本机用户的密码Hash是存放SAM<code>%SystemRoot%\system32\config\sam</code>文件中</p>
</li>
<li><p>域内用户的密码Hash是存在域控的NTDS.DIT文件中 </p>
<ul>
<li>数据库文件夹:<code>C:\\Windows\NTDS</code></li>
<li>日志文件文件夹:<code>C:\\Windows\NTDS</code></li>
<li>SYSVOL文件夹:<code>C:\\Windows\SYSVOL</code></li>
</ul>
</li>
</ul>
<p><strong>Windows系统导出密码的格式如下:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用户名:RID:LM-Hash:NTLM-Hash</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: </span><br></pre></td></tr></table></figure>

<ol>
<li><p>当Windows用户密码≤14个字符,SAM文件中是LM Hash值+NTLM-Hash值</p>
</li>
<li><p>当Windows用户密码＞14个字符,SAM文件中是NTLM-Hash值</p>
</li>
</ol>
<h4 id="NTLM-Hash"><a href="#NTLM-Hash" class="headerlink" title="NTLM Hash"></a>NTLM Hash</h4><p>NTLM Hash是支持Net NTLM认证协议及本地认证过程中的一个重要参与物,其长度为32位,由数字与字母组成.</p>
<p>当我们登录系统的时候,系统会将用户输入的密码计算成NTLM Hash,然后与sam数据库中该用户的哈希比对,匹配则登陆成功,不匹配则登陆失败</p>
<p>这里提到的NTLM哈希,是一种单向哈希算法,Windows将用户的密码计算成NTLM哈希之后才存储在电脑中,对于这个概念一定要牢牢记住,因为后面NTLM Hash会经常出现</p>
<p>大致的运算流程为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用户密码-&gt;HEX编码-&gt;Unicode编码-&gt;MD4</span><br></pre></td></tr></table></figure>

<p>用python计算密码’admin’的NTLM哈希:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> passlib.<span class="built_in">hash</span> <span class="keyword">import</span> nthash</span><br><span class="line"><span class="built_in">print</span>(nthash.<span class="built_in">hash</span>(<span class="string">&#x27;admin&#x27;</span>))</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300747300.png" data-fancybox="true"/></div></div>

<mark class="tag-plugin colorful mark" color="red">一定要保护好自己的SAM文件</mark>,现在的PE去密码也是这种方式

<p>本地认证中用来处理用户输入密码的进程即<code>lsass.exe</code>,密码会在这个进程中明文保存,供该进程将密码计算成<code>NTLM Hash</code>与<code>SAM</code>进行比对</p>
<p>我们使用<code>mimikatz</code>来获取的明文密码,便是在这个进程中读取到的</p>
<h4 id="LM-Hash"><a href="#LM-Hash" class="headerlink" title="LM Hash"></a>LM Hash</h4><ul>
<li><p>用户口令全部转为大写<mark class="tag-plugin colorful mark" color="red">老的windows的用户名密码不区分大小写</mark></p>
</li>
<li><p>用户口令转为16进制之后不足14个字符(28位)长度,用0补足</p>
</li>
<li><p>把密码的16进制字符串分成两个7byte部分</p>
</li>
<li><p>每部分转换成比特流,并且长度为56bt,长度不足使用0在左边补齐长度</p>
</li>
<li><p>再分7bit为一组末尾加0,转换为16进制,组成新的编码</p>
</li>
<li><p>分别用key为<code>KGS!@#$%</code>(<code>4B47532140232425</code>)进行DES加密</p>
</li>
<li><p>最后将二组DES加密后的编码拼接,获得LM-HASH值</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将所有小写字母转换为大写字母</span></span><br><span class="line">123ABC <span class="comment">#未达到7个字符</span></span><br><span class="line"><span class="comment"># 将密码转化为16进制,分两组,填充为14个字符,空余位使用0x00字符填补</span></span><br><span class="line">31323341424300000000000000</span><br><span class="line"><span class="comment"># 将密码分割为两组7个字节的块</span></span><br><span class="line">31323341424300000000000000001 <span class="comment"># 16进制</span></span><br><span class="line"><span class="comment"># 将每组转化为比特流,不足56Bit则在左边加0</span></span><br><span class="line">31323341424300-&gt;(转换为二进制)</span><br><span class="line">110001001100100011001101000001010000100100001100000000-&gt;(补足56Bit)</span><br><span class="line">00110001001100100011001101000001010000100100001100000000</span><br><span class="line"><span class="comment"># 将比特流按照7比特一组,分出8组,末尾加0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于后者都为0,结果可想而知,都是0</span></span><br><span class="line"><span class="comment"># 将每组比特流转换为16进制作为被加密的值,使用DES加密,字符串&quot;KGS!@#$%&quot;(0x4B47532140232425)为Key,得到8个结果,每个结果转换为16进制</span></span><br><span class="line">00110000100110001000110001101000000101000001001000001100</span><br><span class="line">00000000</span><br><span class="line"></span><br><span class="line">30988C6814120000-&gt;DES(30988C6814120C00)-&gt;48-D7-EB-91-2F-5E-69-7C</span><br><span class="line"><span class="comment"># 由于我们的密码不超过7字节,所以后面的一半是固定的:</span></span><br><span class="line">AA-D3-B4-35-B5-14-04-EE</span><br><span class="line"><span class="comment"># 连接两个DES加密字符串.这是LM哈希.</span></span><br><span class="line">48-D7-EB-91-2F-5E-69-7C-AA-D3-B4-35-B5-14-04-EE</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748383.png" data-fancybox="true"/></div></div>

<h4 id="本地认证流程"><a href="#本地认证流程" class="headerlink" title="本地认证流程"></a>本地认证流程</h4><p>Windows Logon Process(即Winlogon.exe),是Windows NT用户登录程序,用于管理用户登录和退出</p>
<p>Lsass用于微软Windows系统的安全机制.它用于本地安全和登录策略</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748288.png" data-fancybox="true"/></div></div>

<h3 id="Net-NTLM-Hash-Windows-网络认证"><a href="#Net-NTLM-Hash-Windows-网络认证" class="headerlink" title="Net NTLM Hash(Windows 网络认证)"></a>Net NTLM Hash(Windows 网络认证)</h3><p>在内网渗透中,经常遇到工作组环境,而工作组环境是一个逻辑上的网络环境(工作区),隶属于工作组的机器之间无法互相建立一个完美的信任机制,只能点对点,是比较落后的认证方式,没有信托机构</p>
<ul>
<li><p>假设A主机与B主机属于同一个工作组环境,A想访问B主机上的资料,需要将一个存在于B主机上的账户凭证发送至B主机,经过<br>认证才能够访问B主机上的资源</p>
</li>
<li><p>最常见的服务:SMB服务端口:445</p>
</li>
</ul>
<h4 id="NTLM-NT-LAN-Manager-协议"><a href="#NTLM-NT-LAN-Manager-协议" class="headerlink" title="NTLM(NT LAN Manager) 协议"></a>NTLM(NT LAN Manager) 协议</h4><p>早期SMB协议在网络上传输明文口令.后来出现LAN Manager Challenge&#x2F;Response验证机制,简称LM,它是如此简单以至很容易就被破解<br>微软提出了WindowsNT挑战&#x2F;响应验证机制,称之为NTLM.现在已经有了更新的NTLMv2以及Kerberos验证体系.</p>
<ol>
<li>挑战&#x2F;响应–协商</li>
</ol>
<p>​			客户端主要在这一步向服务器确认协议的版本,是v1还是v2</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748582.png" data-fancybox="true"/></div></div>

<ol>
<li><p>挑战&#x2F;响应–质询 </p>
<ul>
<li><p>客户端向服务器端发送用户信息(用户名)请求 </p>
</li>
<li><p>服务器接受到请求,生成一个16位的随机数,被称之为<code>Challenge</code>,使用登录用户名对应的<code>NTLM Hash</code>加密<code>Challenge(16位随机字符)</code><br>生成<code>Challenge1</code>.同时,生成<code>Challenge1</code>后,将<code>Challenge(16位随机字符)</code>发送给客户端<code>Net NTLM Hash=NTLM Hash(Challenge)</code> </p>
</li>
<li><p>客户端接受到<code>Challenge</code>后,使用将要登录到账户对应的<code>NTLM Hash</code>加密<code>Challenge</code>生成<code>Response</code>,然后将<code>Response</code>发送至服务器端. </p>
</li>
<li><p>服务器端收到客户端的<code>Response</code>后,比对<code>Chanllenge1</code>与<code>Response</code>是否相等,若相等,则认证通过.</p>
</li>
</ul>
</li>
<li><p>挑战&#x2F;响应–认证 </p>
</li>
<li><p>挑战&#x2F;响应–认证流程</p>
</li>
</ol>
<p><strong>注意:</strong></p>
<ol>
<li><p><code>Chanllenge</code>是Server产生的一个16字节的随机数,每次认证都不同</p>
</li>
<li><p><code>Response</code>的表现形式是<code>Net-NTLM Hash</code>,他是由客户端提供的密码Hash加密Server返回的Chanllenge产生的结果</p>
</li>
</ol>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300748371.png" data-fancybox="true"/></div></div>

<h4 id="NTLM-V2协议"><a href="#NTLM-V2协议" class="headerlink" title="NTLM V2协议"></a>NTLM V2协议</h4><p>​	<code>NTLM v1</code>与<code>NTLM V2</code>最显著的区别就是<code>Challenge</code>.与加密算法不同,共同点就是加密的原料都是<code>NTLM Hash</code>.<br><strong>不同点:</strong></p>
<ol>
<li><p>Challage:<code>NTLM V1</code>的<code>Challenge</code>有8位,<code>NTLM V2</code>的<code>Challenge</code>为16位.</p>
</li>
<li><p>Net-NTLM Hash:<code>NTLM V1</code>的主要加密算法是<code>DES</code>,<code>NTLM V2</code>的主要加密算法是<code>HMAC-MD5</code></p>
</li>
</ol>
<h2 id="哈希类型识别"><a href="#哈希类型识别" class="headerlink" title="哈希类型识别"></a>哈希类型识别</h2><h3 id="Hash-identifier"><a href="#Hash-identifier" class="headerlink" title="Hash-identifier"></a>Hash-identifier</h3><blockquote>
<p><code>hash-identifier</code>是一个用于识别哈希类型的工具.它可以根据输入的哈希值自动推断出哈希算法的类型.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> hash-identifier </span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line">   <span class="comment">#     __  __             __         ______    _____       #</span></span><br><span class="line">   <span class="comment">#    /\ \/\ \           /\ \     /\__  _\  /\  _ `\       #</span></span><br><span class="line">   <span class="comment">#    \ \ \_\ \     __      ____ \ \ \___    \/_/\ \/  \ \ \/\ \       #</span></span><br><span class="line">   <span class="comment">#     \ \  _  \  /&#x27;__`\   / ,__\ \ \  _ `\       \ \ \   \ \ \ \ \       #</span></span><br><span class="line">   <span class="comment">#      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \        \_\ \__ \ \ \_\ \       #</span></span><br><span class="line">   <span class="comment">#       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/       #</span></span><br><span class="line">   <span class="comment">#        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.1 #</span></span><br><span class="line">   <span class="comment">#                                 By Zion3R #</span></span><br><span class="line">   <span class="comment">#                            www.Blackploit.com #</span></span><br><span class="line">   <span class="comment">#                               Root@Blackploit.com #</span></span><br><span class="line">   <span class="comment">#########################################################################</span></span><br><span class="line"></span><br><span class="line">   -------------------------------------------------------------------------</span><br><span class="line"> HASH: 46ea1712d4b13b55b3f680cc5b8b54e8</span><br><span class="line"></span><br><span class="line">Possible Hashs:</span><br><span class="line">[+]  MD5</span><br><span class="line">[+]  Domain Cached Credentials - MD4(MD4((<span class="variable">$pass</span>)).(strtolower(<span class="variable">$username</span>)))</span><br></pre></td></tr></table></figure>

<h3 id="Hashid"><a href="#Hashid" class="headerlink" title="Hashid"></a>Hashid</h3><blockquote>
<p>这个工具取代了已经过时的hash-identifier!</p>
<p>hashID是一个使用正则表达式支持识别超过220种独特哈希类型的工具,它由Python 3编写而成.支持的哈希类型的详细列表可以在这里找到.</p>
<p>它能够识别单个哈希值,解析文件或读取目录中的多个文件,并识别其中的哈希值.hashID还能够在输出中包含相应的hashcat模式和&#x2F;或JohnTheRipper格式.</p>
<p>hashID可以在任何平台上使用Python 2 ≥ 2.7.x或Python 3 ≥ 3.3,并且可以即插即用.</p>
<mark class="tag-plugin colorful mark" color="warning">在Linux操作系统中识别哈希值时,请使用单引号以防止插值发生.</mark>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt]</span><br><span class="line">└─<span class="comment"># hashid -h</span></span><br><span class="line"></span><br><span class="line">使用hashid识别用于加密数据的不同类型的哈希算法</span><br><span class="line"></span><br><span class="line">用法:      </span><br><span class="line">hashid.py [-h] [-e] [-m] [-j] [-o FILE] [--version] INPUT</span><br><span class="line"></span><br><span class="line">位置参数:      </span><br><span class="line">  INPUT                    要分析的输入(默认为STDIN)</span><br><span class="line"></span><br><span class="line">选项:      </span><br><span class="line">  -e, --extended           列出包括加盐密码在内的所有可能的哈希算法</span><br><span class="line">  -m, --mode               在输出中显示相应的Hashcat模式</span><br><span class="line">  -j, --john               在输出中显示相应的JohnTheRipper格式</span><br><span class="line">  -o FILE, --outfile FILE  将输出写入文件</span><br><span class="line">  -h, --<span class="built_in">help</span>               显示此帮助消息并退出</span><br><span class="line">  --version                显示程序的版本号并退出</span><br><span class="line"></span><br><span class="line">许可证:      GPLv3+:      GNU通用公共许可证第3版或更高版&lt;http://gnu.org/licenses/gpl.html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt]</span><br><span class="line">└─<span class="comment"># hashid &#x27;0192023a7bbd73250516f069df18b500&#x27; -m</span></span><br><span class="line">Analyzing <span class="string">&#x27;0192023a7bbd73250516f069df18b500&#x27;</span></span><br><span class="line">[+] MD2</span><br><span class="line">[+] MD5 [Hashcat Mode: 0]</span><br><span class="line">[+] MD4 [Hashcat Mode: 900]</span><br><span class="line">[+] Double MD5 [Hashcat Mode: 2600]</span><br><span class="line">[+] LM [Hashcat Mode: 3000]</span><br><span class="line">[+] RIPEMD-128</span><br><span class="line">[+] Haval-128</span><br><span class="line">[+] Tiger-128</span><br><span class="line">[+] Skein-256(128)</span><br><span class="line">[+] Skein-512(128)</span><br><span class="line">[+] Lotus Notes/Domino 5 [Hashcat Mode: 8600]</span><br><span class="line">[+] Skype [Hashcat Mode: 23]</span><br><span class="line">[+] Snefru-128</span><br><span class="line">[+] NTLM [Hashcat Mode: 1000]</span><br><span class="line">[+] Domain Cached Credentials [Hashcat Mode: 1100]</span><br><span class="line">[+] Domain Cached Credentials 2 [Hashcat Mode: 2100]</span><br><span class="line">[+] DNSSEC(NSEC3) [Hashcat Mode: 8300]</span><br><span class="line">[+] RAdmin v2.x [Hashcat Mode: 9900]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(root㉿kill3r)-[/opt]</span><br><span class="line">└─<span class="comment"># hashid &#x27;$P$8ohUJ.1sdFw09/bMaAQPTGDNi2BIUt1&#x27; -m</span></span><br><span class="line">Analyzing <span class="string">&#x27;$P$8ohUJ.1sdFw09/bMaAQPTGDNi2BIUt1&#x27;</span></span><br><span class="line">[+] Wordpress ≥ v2.6.2 [Hashcat Mode: 400]</span><br><span class="line">[+] Joomla ≥ v2.5.18 [Hashcat Mode: 400]</span><br><span class="line">[+] PHPass<span class="string">&#x27; Portable Hash [Hashcat Mode: 400]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">┌──(root㉿kill3r)-[/opt]</span></span><br><span class="line"><span class="string">└─# hashid &#x27;</span>$racf$*AAAAAAAA*3c44ee7f409c9a9b<span class="string">&#x27; -m</span></span><br><span class="line"><span class="string">Analyzing &#x27;</span>$racf$*AAAAAAAA*3c44ee7f409c9a9b<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[+] RACF [Hashcat Mode: 8500]</span></span><br></pre></td></tr></table></figure>

<h2 id="HashCat"><a href="#HashCat" class="headerlink" title="HashCat"></a>HashCat</h2><h3 id="hashcat简介"><a href="#hashcat简介" class="headerlink" title="hashcat简介"></a>hashcat简介</h3><blockquote>
<p>Hashcat是自称世界上最快的密码恢复工具.它在2015年之前拥有专有代码库,但现在作为免费软件发布.适用于Linux,OS X和Windows的版本可以使用基于CPU或基于GPU的变体.支持hashcat的散列算法有Microsoft LM哈希,MD4,MD5,SHA系列,Unix加密格式,MySQL和Cisco PIX等.</p>
<p>hashcat支持多种计算核心:      </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GPU</span><br><span class="line">CPU</span><br><span class="line">APU</span><br><span class="line">DSP</span><br><span class="line">FPGA</span><br><span class="line">Coprocessor</span><br></pre></td></tr></table></figure>

<p>GPU的驱动要求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AMD GPUs on Linux require &quot;RadeonOpenCompute (ROCm)&quot; Software Platform (1.6.180 or later)</span><br><span class="line">AMD GPUs on Windows require &quot;AMD Radeon Software Crimson Edition&quot; (15.12 or later)</span><br><span class="line">Intel CPUs require &quot;OpenCL Runtime for Intel Core and Intel Xeon Processors&quot; (16.1.1 or later)</span><br><span class="line">Intel GPUs on Linux require &quot;OpenCL 2.0 GPU Driver Package for Linux&quot; (2.0 or later)</span><br><span class="line">Intel GPUs on Windows require &quot;OpenCL Driver for Intel Iris and Intel HD Graphics&quot;</span><br><span class="line">NVIDIA GPUs require &quot;NVIDIA Driver&quot; (367.x or later)</span><br></pre></td></tr></table></figure>

</blockquote>
<h3 id="hashcat常用命令"><a href="#hashcat常用命令" class="headerlink" title="hashcat常用命令"></a>hashcat常用命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-r 使用自定义破解规则 </span><br><span class="line">-o 指定破解成功后的 <span class="built_in">hash</span> 及所对应的明文密码的存放位置 </span><br><span class="line">-m 指定要破解的 <span class="built_in">hash</span> 类型,如果不指定类型,则默认是 MD5 </span><br><span class="line">-a 指定要使用的破解模式,其值参考后面对参数.<span class="string">&quot;-a 0&quot;</span> 字典攻击,<span class="string">&quot;-a 1&quot;</span> 组合攻击;<span class="string">&quot;-a 3&quot;</span> 掩码攻击 </span><br><span class="line">-D 指定 opencl 的设备类型 </span><br><span class="line">--show 显示已经破解的 <span class="built_in">hash</span> 及该 <span class="built_in">hash</span> 所对应的明文 </span><br><span class="line">--force 忽略破解过程中的警告信息,跑单条 <span class="built_in">hash</span> 可能需要加上此选项 </span><br><span class="line">--remove 删除已被破解成功的 <span class="built_in">hash</span> </span><br><span class="line">--username 忽略 <span class="built_in">hash</span> 文件中的指定的用户名,在破解 linux 系统用户密码 <span class="built_in">hash</span> 可能会用到 </span><br><span class="line">--increment 启用增量破解模式,你可以利用此模式让 hashcat 在指定的密码长度范围内执行破解过程 </span><br><span class="line">--increment-min 密码最小长度,后面直接等于一个整数即可,配置 increment 模式一起使用 </span><br><span class="line">--increment-max 密码最大长度,同上 </span><br><span class="line">--outfile-format 指定破解结果的输出格式 <span class="built_in">id</span> ,默认是 3 </span><br><span class="line">--self-test-disable 关闭启动自检</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -a 破解模式:</span></span><br><span class="line">0 | Straight (字典破解) </span><br><span class="line">1 | Combination (组合破解) </span><br><span class="line">3 | Brute-force (掩码暴力破解) </span><br><span class="line">6 | Hybrid Wordlist + Mask(字典+掩码破解) </span><br><span class="line">7 | Hybrid Mask + Wordlist(掩码+字典破解)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -D 指定设备类型:</span></span><br><span class="line">1 | CPU</span><br><span class="line">2 | GPU</span><br><span class="line">3 | FPGA, DSP, Co-Processor</span><br><span class="line"><span class="comment"># 一般使用 -D 2 指定 GPU 破解</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 掩码设置:</span></span><br><span class="line">l | abcdefghijklmnopqrstuvwxyz 纯小写字母 </span><br><span class="line">u | ABCDEFGHIJKLMNOPQRSTUVWXYZ 纯大写字母 </span><br><span class="line">d | 0123456789 纯数字 </span><br><span class="line">h | 0123456789abcdef 十六进制小写字母和数字 </span><br><span class="line">H | 0123456789ABCDEF 十六进制大写字母和数字 </span><br><span class="line">s | !<span class="string">&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~ 特殊字符 </span></span><br><span class="line"><span class="string">a | ?l?u?d?s 键盘上所有可见的字符 </span></span><br><span class="line"><span class="string">b | 0x00 - 0xff 匹配密码空格</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 掩码设置举例:</span></span><br><span class="line">八位数字密码:      ?d?d?d?d?d?d?d?d </span><br><span class="line">八位未知密码:      ?a?a?a?a?a?a?a?a </span><br><span class="line">前四位为大写字母,后面四位为数字:      ?u?u?u?u?d?d?d?d </span><br><span class="line">前四位为数字或者是小写字母,后四位为大写字母或者数字:      ?h?h?h?h?H?H?H?H </span><br><span class="line">前三个字符未知,中间为admin,后三位未知:      ?a?a?aadmin?a?a?a </span><br><span class="line">6-8位数字密码:      --increment --increment-min 6 --increment-max 8 ?d?d?d?d?d?d?d?d </span><br><span class="line">6-8位数字+小写字母密码:      --increment --increment-min 6 --increment-max 8 ?h?h?h?h?h?h?h?h</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自定义掩码规则:</span></span><br><span class="line">--custom-charset1 [chars]等价于 -1 </span><br><span class="line">--custom-charset2 [chars]等价于 -2 </span><br><span class="line">--custom-charset3 [chars]等价于 -3 </span><br><span class="line">--custom-charset4 [chars]等价于 -4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在掩码中用 ?1、?2、?3、?4 来表示</span></span><br><span class="line">注意:</span><br><span class="line">–custom-charset1 abcd ?1?1?1?1?1 等价于 -1 abcd ?1?1?1?1?1</span><br><span class="line">-3 abcdef -4 123456 ?3?3?3?3?4?4?4?4 表示前四位可能是 adbcdef,后四位可能是 123456</span><br></pre></td></tr></table></figure>

<h3 id="hash-id-对照表"><a href="#hash-id-对照表" class="headerlink" title="hash id 对照表"></a>hash id 对照表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">因为实在是太多了,所有我就贴一部分常见的<span class="built_in">hash</span>类型,要想了解所有的参数可到hashcat的Wiki上去看,或者直接hashcat --<span class="built_in">help</span>查看<span class="built_in">hash</span>对照表</span><br><span class="line">      <span class="comment"># | Name                                             | Category</span></span><br><span class="line">    900 | MD4                                              | Raw Hash</span><br><span class="line">      0 | MD5                                              | Raw Hash</span><br><span class="line">   5100 | Half MD5                                         | Raw Hash</span><br><span class="line">    100 | SHA1                                             | Raw Hash</span><br><span class="line">   1300 | SHA2-224                                         | Raw Hash</span><br><span class="line">   1400 | SHA2-256                                         | Raw Hash</span><br><span class="line">  10800 | SHA2-384                                         | Raw Hash</span><br><span class="line">   1700 | SHA2-512                                         | Raw Hash</span><br><span class="line">  17300 | SHA3-224                                         | Raw Hash</span><br><span class="line">  17400 | SHA3-256                                         | Raw Hash</span><br><span class="line">  17500 | SHA3-384                                         | Raw Hash</span><br><span class="line">  17600 | SHA3-512                                         | Raw Hash</span><br><span class="line">     10 | md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>)                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">     20 | md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>)                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">     30 | md5(utf16le(<span class="variable">$pass</span>).<span class="variable">$salt</span>)                        | Raw Hash, Salted and/or Iterated</span><br><span class="line">     40 | md5(<span class="variable">$salt</span>.utf16le(<span class="variable">$pass</span>))                        | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3800 | md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)                           | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3710 | md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))                            | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4010 | md5(<span class="variable">$salt</span>.md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4110 | md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   2600 | md5(md5(<span class="variable">$pass</span>))                                  | Raw Hash, Salted and/or Iterated</span><br><span class="line">   3910 | md5(md5(<span class="variable">$pass</span>).md5(<span class="variable">$salt</span>))                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4300 | md5(strtoupper(md5(<span class="variable">$pass</span>)))                      | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4400 | md5(sha1(<span class="variable">$pass</span>))                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">    110 | sha1(<span class="variable">$pass</span>.<span class="variable">$salt</span>)                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">    120 | sha1(<span class="variable">$salt</span>.<span class="variable">$pass</span>)                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">    130 | sha1(utf16le(<span class="variable">$pass</span>).<span class="variable">$salt</span>)                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">    140 | sha1(<span class="variable">$salt</span>.utf16le(<span class="variable">$pass</span>))                       | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4500 | sha1(sha1(<span class="variable">$pass</span>))                                | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4520 | sha1(<span class="variable">$salt</span>.sha1(<span class="variable">$pass</span>))                          | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4700 | sha1(md5(<span class="variable">$pass</span>))                                 | Raw Hash, Salted and/or Iterated</span><br><span class="line">   4900 | sha1(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)                          | Raw Hash, Salted and/or Iterated</span><br><span class="line">  14400 | sha1(CX)                                         | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1410 | sha256(<span class="variable">$pass</span>.<span class="variable">$salt</span>)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1420 | sha256(<span class="variable">$salt</span>.<span class="variable">$pass</span>)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1430 | sha256(utf16le(<span class="variable">$pass</span>).<span class="variable">$salt</span>)                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1440 | sha256(<span class="variable">$salt</span>.utf16le(<span class="variable">$pass</span>))                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1710 | sha512(<span class="variable">$pass</span>.<span class="variable">$salt</span>)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1720 | sha512(<span class="variable">$salt</span>.<span class="variable">$pass</span>)                              | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1730 | sha512(utf16le(<span class="variable">$pass</span>).<span class="variable">$salt</span>)                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">   1740 | sha512(<span class="variable">$salt</span>.utf16le(<span class="variable">$pass</span>))                     | Raw Hash, Salted and/or Iterated</span><br><span class="line">  14000 | DES (PT = <span class="variable">$salt</span>, key = <span class="variable">$pass</span>)                    | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  14100 | 3DES (PT = <span class="variable">$salt</span>, key = <span class="variable">$pass</span>)                   | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  14900 | Skip32 (PT = <span class="variable">$salt</span>, key = <span class="variable">$pass</span>)                 | Raw Cipher, Known-Plaintext attack</span><br><span class="line">  15400 | ChaCha20                                         | Raw Cipher, Known-Plaintext attack</span><br><span class="line">   2500 | WPA-EAPOL-PBKDF2                                 | Network Protocols</span><br><span class="line">   2501 | WPA-EAPOL-PMK                                    | Network Protocols</span><br><span class="line">  16800 | WPA-PMKID-PBKDF2                                 | Network Protocols</span><br><span class="line">  16801 | WPA-PMKID-PMK                                    | Network Protocols</span><br><span class="line">   7300 | IPMI2 RAKP HMAC-SHA1                             | Network Protocols</span><br><span class="line">   7500 | Kerberos 5 AS-REQ Pre-Auth etype 23              | Network Protocols</span><br><span class="line">   8300 | DNSSEC (NSEC3)                                   | Network Protocols</span><br><span class="line">  10200 | CRAM-MD5                                         | Network Protocols</span><br><span class="line">  11100 | PostgreSQL CRAM (MD5)                            | Network Protocols</span><br><span class="line">  11200 | MySQL CRAM (SHA1)                                | Network Protocols</span><br><span class="line">  16100 | TACACS+                                          | Network Protocols</span><br><span class="line">  16500 | JWT (JSON Web Token)                             | Network Protocols</span><br><span class="line">    121 | SMF (Simple Machines Forum) &gt; v1.1               | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | phpBB3 (MD5)                                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2811 | MyBB 1.2+                                        | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2811 | IPB2+ (Invision Power Board)                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   8400 | WBB3 (Woltlab Burning Board)                     | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     11 | Joomla &lt; 2.5.18                                  | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | Joomla &gt;= 2.5.18 (MD5)                           | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    400 | WordPress (MD5)                                  | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   2612 | PHPS                                             | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">   7900 | Drupal7                                          | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     21 | osCommerce                                       | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     21 | xt:Commerce                                      | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">  11000 | PrestaShop                                       | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">    124 | Django (SHA-1)                                   | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">  10000 | Django (PBKDF2-SHA256)                           | Forums, CMS, E-Commerce, Frameworks</span><br><span class="line">     12 | PostgreSQL                                       | Database Server</span><br><span class="line">    131 | MSSQL (2000)                                     | Database Server</span><br><span class="line">    132 | MSSQL (2005)                                     | Database Server</span><br><span class="line">   1731 | MSSQL (2012, 2014)                               | Database Server</span><br><span class="line">    200 | MySQL323                                         | Database Server</span><br><span class="line">    300 | MySQL4.1/MySQL5                                  | Database Server</span><br><span class="line">   3100 | Oracle H: Type (Oracle 7+)                       | Database Server</span><br><span class="line">    112 | Oracle S: Type (Oracle 11+)                      | Database Server</span><br><span class="line">  12300 | Oracle T: Type (Oracle 12+)                      | Database Server</span><br><span class="line">   8000 | Sybase ASE                                       | Database Server</span><br><span class="line">  15000 | FileZilla Server &gt;= 0.9.55                       | FTP Server</span><br><span class="line">  11500 | CRC32                                            | Checksums</span><br><span class="line">   3000 | LM                                               | Operating Systems</span><br><span class="line">   1000 | NTLM                                             | Operating Systems</span><br><span class="line">    500 | md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)        | Operating Systems</span><br><span class="line">   3200 | bcrypt <span class="variable">$2</span>*$, Blowfish (Unix)                     | Operating Systems</span><br><span class="line">   7400 | sha256crypt $5$, SHA256 (Unix)                   | Operating Systems</span><br><span class="line">   1800 | sha512crypt $6$, SHA512 (Unix)                   | Operating Systems</span><br><span class="line">    122 | macOS v10.4, MacOS v10.5, MacOS v10.6            | Operating Systems</span><br><span class="line">   1722 | macOS v10.7                                      | Operating Systems</span><br><span class="line">   7100 | macOS v10.8+ (PBKDF2-SHA512)                     | Operating Systems</span><br><span class="line">  11600 | 7-Zip                                            | Archives</span><br><span class="line">  12500 | RAR3-hp                                          | Archives</span><br><span class="line">  13000 | RAR5                                             | Archives</span><br><span class="line">  13600 | WinZip                                           | Archives</span><br><span class="line">   9700 | MS Office &lt;= 2003 <span class="variable">$0</span>/<span class="variable">$1</span>, MD5 + RC4               | Documents</span><br><span class="line">   9710 | MS Office &lt;= 2003 <span class="variable">$0</span>/<span class="variable">$1</span>, MD5 + RC4, collider <span class="comment">#1  | Documents</span></span><br><span class="line">   9720 | MS Office &lt;= 2003 <span class="variable">$0</span>/<span class="variable">$1</span>, MD5 + RC4, collider <span class="comment">#2  | Documents</span></span><br><span class="line">   9800 | MS Office &lt;= 2003 <span class="variable">$3</span>/<span class="variable">$4</span>, SHA1 + RC4              | Documents</span><br><span class="line">   9810 | MS Office &lt;= 2003 <span class="variable">$3</span>, SHA1 + RC4, collider <span class="comment">#1    | Documents</span></span><br><span class="line">   9820 | MS Office &lt;= 2003 <span class="variable">$3</span>, SHA1 + RC4, collider <span class="comment">#2    | Documents</span></span><br><span class="line">   9400 | MS Office 2007                                   | Documents</span><br><span class="line">   9500 | MS Office 2010                                   | Documents</span><br><span class="line">   9600 | MS Office 2013                                   | Documents</span><br><span class="line">  10400 | PDF 1.1 - 1.3 (Acrobat 2 - 4)                    | Documents</span><br><span class="line">  10410 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider <span class="comment">#1       | Documents</span></span><br><span class="line">  10420 | PDF 1.1 - 1.3 (Acrobat 2 - 4), collider <span class="comment">#2       | Documents</span></span><br><span class="line">  10500 | PDF 1.4 - 1.6 (Acrobat 5 - 8)                    | Documents</span><br><span class="line">  10600 | PDF 1.7 Level 3 (Acrobat 9)                      | Documents</span><br><span class="line">  10700 | PDF 1.7 Level 8 (Acrobat 10 - 11)                | Documents</span><br><span class="line">  99999 | Plaintext                                        | Plaintext</span><br></pre></td></tr></table></figure>

<h3 id="暴力破解MD5值"><a href="#暴力破解MD5值" class="headerlink" title="暴力破解MD5值"></a>暴力破解MD5值</h3><ol>
<li>使用字典进行破解:<code>hashcat -m 0 -a 0 0192023a7bbd73250516f069df18b500 top3000.txt --force --show</code></li>
</ol>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749270.png" data-fancybox="true"/></div></div>

<ol start="2">
<li>使用指定字符集进行破解:<code>hashcat -a 3 -m 0 63a9f0ea7bb98050796b649e85481845 ?l?l?l?l --force --show</code></li>
</ol>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749061.png" data-fancybox="true"/></div></div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749628.png" data-fancybox="true"/></div></div>

<ol start="3">
<li>使用字典+掩码进行破解:<code>hashcat -a 6 -m 0 1844156d4166d94387f1a4ad031ca5fa rockyou.txt ?d?d?d --force</code></li>
</ol>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749639.png" data-fancybox="true"/></div></div>

<ol start="4">
<li><p>使用掩码+字典进行破解:<code>hashcat -a 7 -m 0 1844156d4166d94387f1a4ad031ca5fa ?d?d?d rockyou.txt --force</code></p>
<p>经过测试,这里的掩码+字典组合破解,不是说简单的将掩码和字典的内容合并去重形成 1 个字典进行去重,而是说掩码的内容加上字典的内容组合成一个字典</p>
</li>
</ol>
<mark class="tag-plugin colorful mark" color="warning">如果破解时间太长,我们可以按s键查看破解进度,p键暂停,r键继续破解,q键退出破解</mark>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300749515.png" data-fancybox="true"/></div></div>

<h3 id="破解windows系统密码"><a href="#破解windows系统密码" class="headerlink" title="破解windows系统密码"></a>破解windows系统密码</h3><p>首先,执行以下命令通过reg的save选项将注册表中的SAM、System文件导出到本地磁盘.</p>
<mark class="tag-plugin colorful mark" color="warning">以管理员权限运行cmd!!!</mark>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg save HKLM\SYSTEM system.save</span><br><span class="line">reg save HKLM\SAM sam.save</span><br><span class="line">reg save HKLM\SECURITY security.save</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300906674.png" data-fancybox="true"/></div></div>

<p>将这三个文件拷贝到kali中</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300906261.png" data-fancybox="true"/></div></div>

<p>执行以下命令获取计算机账号原始<code>Hash</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># impacket-secretsdump -sam sam.save -system system.save -security security.save LOCAL</span></span><br><span class="line">Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0xe7af37b33872d8355dd3e7d06a54a2de</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:ef04605d66ffa6396d535bb157a6f802:::</span><br><span class="line"><span class="built_in">test</span>:1001:aad3b435b51404eeaad3b435b51404ee:0cb6948805f797bf2a82807973b89537:::</span><br><span class="line">[*] Dumping cached domain logon information (domain/username:<span class="built_in">hash</span>)</span><br><span class="line">[*] Dumping LSA Secrets</span><br><span class="line">[*] DPAPI_SYSTEM</span><br><span class="line">dpapi_machinekey:0xad14af85abe351048c63c486067b2428ce493627</span><br><span class="line">dpapi_userkey:0x46711e623e1d8e4ceec4413a89ee518dd0160c44</span><br><span class="line">[*] NL<span class="variable">$KM</span></span><br><span class="line"> 0000   53 0A 12 4E 1F E9 1C 75  E0 AD A1 A5 2A 74 BC C7   S..N...u....*t..</span><br><span class="line"> 0010   2B 19 06 05 9F D1 48 BA  E8 53 36 17 46 FC 5F 6E   +.....H..S6.F._n</span><br><span class="line"> 0020   5D C1 27 D5 71 57 7A 5D  BA 3B 76 45 02 92 0D 50   ].<span class="string">&#x27;.qWz].;vE...P</span></span><br><span class="line"><span class="string"> 0030   AA F5 D2 BC C8 11 26 FF  BA 4D 64 3A CD EA 9F B1   ......&amp;..Md:....</span></span><br><span class="line"><span class="string">NL$KM:530a124e1fe91c75e0ada1a52a74bcc72b1906059fd148bae853361746fc5f6e5dc127d571577a5dba3b764502920d50aaf5d2bcc81126ffba4d643acdea9fb1</span></span><br><span class="line"><span class="string">[*] Cleaning up...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">test:1001:aad3b435b51404eeaad3b435b51404ee:0cb6948805f797bf2a82807973b89537:::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">用户名:在这种情况下,用户名是 &quot;test&quot;.</span></span><br><span class="line"><span class="string">密码哈希:NTLM 哈希是 &quot;aad3b435b51404eeaad3b435b51404ee&quot;.</span></span><br><span class="line"><span class="string">LM 哈希:LM 哈希被表示为空,即 &quot;31d6cfe0d16ae931b73c59d7e0c089c0&quot;.</span></span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300750190.png" data-fancybox="true"/></div></div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># hashcat -a 0 -m 1000 0cb6948805f797bf2a82807973b89537   /opt/PasswordDic/用户名和密码/密码/15w密码字典.txt</span></span><br><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># hashcat -a 0 -m 1000 0cb6948805f797bf2a82807973b89537   /opt/PasswordDic/用户名和密码/密码/15w密码字典.txt --show</span></span><br><span class="line">0cb6948805f797bf2a82807973b89537:<span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h2 id="John-the-Ripper"><a href="#John-the-Ripper" class="headerlink" title="John the Ripper"></a>John the Ripper</h2><h3 id="John"><a href="#John" class="headerlink" title="John"></a>John</h3><blockquote>
<p><strong>John the Ripper</strong>是一个快速的密码破解工具,用于在已知密文的情况下尝试破解出明文,支持目前大多数的加密算法,如DES、MD4、MD5等.它支持多种不同类型的系统架构,包括Unix、Linux、Windows、DOS模式、BeOS和OpenVMS,主要目的是破解不够牢固的Unix&#x2F;Linux系统密码.除了在各种Unix系统上最常见的几种密码哈希类型之外,它还支持Windows LM散列,以及社区增强版本中的许多其他哈希和密码.它是一款开源软件.Kali中自带John</p>
<ul>
<li>可执行文件位置:          &#x2F;usr&#x2F;sbin&#x2F;john</li>
<li>密码字典所在目录:      &#x2F;usr&#x2F;share&#x2F;john&#x2F;</li>
</ul>
</blockquote>
<h3 id="john-John-the-Ripper密码破解器"><a href="#john-John-the-Ripper密码破解器" class="headerlink" title="john - John the Ripper密码破解器"></a>john - John the Ripper密码破解器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt]</span><br><span class="line">└─<span class="comment"># john</span></span><br><span class="line">John the Ripper密码破解器,版本:      1.7.9-jumbo-7_omp [linux-x86-sse2]</span><br><span class="line">版权所有 (c) 1996-2012 Solar Designer和其他人</span><br><span class="line">主页:      http://www.openwall.com/john/</span><br><span class="line"></span><br><span class="line">用法:      john [选项] [密码文件]</span><br><span class="line">--config=FILE             使用FILE而不是john.conf或john.ini</span><br><span class="line">--single[=SECTION]        <span class="string">&quot;single crack&quot;</span>模式</span><br><span class="line">--wordlist[=FILE] --stdin 从文件或stdin读取单词的wordlist模式</span><br><span class="line">                  --pipe 像--stdin一样,但批量读取,并允许规则</span><br><span class="line">--loopback[=FILE]         类似于--wordlist,但从.pot文件中获取单词</span><br><span class="line">--dupe-suppression        在wordlist中禁止所有重复项(并强制预加载)</span><br><span class="line">--encoding=NAME           输入数据为非ASCII(例如UTF-8,ISO-8859-1).</span><br><span class="line">                          要查看NAME的完整列表,请使用--list=encodings</span><br><span class="line">--rules[=SECTION]         启用wordlist模式的单词篡改规则</span><br><span class="line">--incremental[=MODE]      <span class="string">&quot;incremental&quot;</span>模式[使用节MODE]</span><br><span class="line">--markov[=OPTIONS]        <span class="string">&quot;Markov&quot;</span>模式(参见doc/MARKOV)</span><br><span class="line">--external=MODE           外部模式或单词过滤器</span><br><span class="line">--stdout[=LENGTH]         仅输出候选密码[最多LENGTH个字符]</span><br><span class="line">--restore[=NAME]          恢复中断的会话[名为NAME]</span><br><span class="line">--session=NAME            为新会话指定名称NAME</span><br><span class="line">--status[=NAME]           打印会话的状态[名为NAME]</span><br><span class="line">--make-charset=FILE       创建字符集文件.它将被覆盖</span><br><span class="line">--show[=LEFT]             显示破解的密码[如果=LEFT,则未破解]</span><br><span class="line">--<span class="built_in">test</span>[=TIME]             运行测试和基准,每个测试持续TIME秒</span><br><span class="line">--<span class="built_in">users</span>=[-]LOGIN|UID[,..] [不]仅加载此(这些)用户</span><br><span class="line">--<span class="built_in">groups</span>=[-]GID[,..]      [不]仅加载具有此(这些)组的用户</span><br><span class="line">--shells=[-]SHELL[,..]    [不]仅加载具有此(这些)shell的用户</span><br><span class="line">--salts=[-]COUNT[:MAX]    [无]加载COUNT [至MAX]个哈希的盐</span><br><span class="line">--pot=NAME                要使用的pot文件</span><br><span class="line">--format=NAME             强制使用哈希类型NAME:      afs bf bfegg bsdi crc32 crypt</span><br><span class="line">                          des django dmd5 dominosec dragonfly3-32 dragonfly3-64</span><br><span class="line">                          dragonfly4-32 dragonfly4-64 drupal7 dummy dynamic_n</span><br><span class="line">                          epi episerver gost hdaa hmac-md5 hmac-sha1</span><br><span class="line">                          hmac-sha224 hmac-sha256 hmac-sha384 hmac-sha512</span><br><span class="line">                          hmailserver ipb2 keepass keychain krb4 krb5 lm lotus5</span><br><span class="line">                          md4-gen md5 md5ns mediawiki mscash mscash2 mschapv2</span><br><span class="line">                          mskrb5 mssql mssql05 mysql mysql-sha1 nethalflm netlm</span><br><span class="line">                          netlmv2 netntlm netntlmv2 nsldap nt nt2 odf office</span><br><span class="line">                          oracle oracle11 osc pdf phpass phps pix-md5 pkzip po</span><br><span class="line">                          pwsafe racf rar raw-md4 raw-md5 raw-md5u raw-sha</span><br><span class="line">                          raw-sha1 raw-sha1-linkedin raw-sha1-ng raw-sha224</span><br><span class="line">                          raw-sha256 raw-sha384 raw-sha512 salted-sha1 sapb</span><br><span class="line">                          sapg sha1-gen sha256crypt sha512crypt sip ssh</span><br><span class="line">                          sybasease trip vnc wbb3 wpapsk xsha xsha512 zip</span><br><span class="line">--list=WHAT               列出功能,参见--list=<span class="built_in">help</span>或doc/OPTIONS</span><br><span class="line">--save-memory=LEVEL       启用内存节省,在LEVEL 1..3之间</span><br><span class="line">--mem-file-size=SIZE      用于wordlist预加载的大小阈值(默认为5 MB)</span><br><span class="line">--nolog                   禁止创建和写入john.log文件</span><br><span class="line">--crack-status            每次破解密码时发出状态行</span><br><span class="line">--max-run-time=N          在N秒后平滑退出</span><br><span class="line">--regen-lost-salts=N      重新生成丢失的盐(参见doc/OPTIONS)</span><br><span class="line">--plugin=NAME[,..]        加载此(这些)动态插件</span><br></pre></td></tr></table></figure>

<h3 id="john-使用示例"><a href="#john-使用示例" class="headerlink" title="john 使用示例"></a>john 使用示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu&#x27;</span> &gt;1</span><br><span class="line">┌──(root㉿kill3r)-[/opt]</span><br><span class="line">└─<span class="comment"># john 1 --show</span></span><br><span class="line">?:snoopy</span><br><span class="line"></span><br><span class="line">1 password <span class="built_in">hash</span> cracked, 0 left</span><br></pre></td></tr></table></figure>

<h3 id="john-破解windows密码"><a href="#john-破解windows密码" class="headerlink" title="john 破解windows密码"></a>john 破解windows密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># echo &#x27;0cb6948805f797bf2a82807973b89537&#x27; &gt; 1.txt</span></span><br><span class="line"><span class="comment"># 执行以下命令进行破解</span></span><br><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># john 1.txt -format=NT</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (NT [MD4 256/256 AVX2 8x3])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=4</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst</span><br><span class="line"><span class="built_in">test</span>             (?)</span><br><span class="line">1g 0:00:00:00 DONE 2/3 (2023-08-15 18:08) 100.0g/s 38400p/s 38400c/s 38400C/s lacrosse..larry</span><br><span class="line">Use the <span class="string">&quot;--show --format=NT&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session completed.</span><br><span class="line"></span><br><span class="line">┌──(root㉿kill3r)-[/home/kill3r]</span><br><span class="line">└─<span class="comment"># john 1 -format=NT --show</span></span><br><span class="line">?:<span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">1 password <span class="built_in">hash</span> cracked, 0 left</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401300750914.png" data-fancybox="true"/></div></div>

<h2 id="Ophcrack"><a href="#Ophcrack" class="headerlink" title="Ophcrack"></a>Ophcrack</h2><blockquote>
<p>Ophcrack 是一款流行的开源密码破解工具,用于恢复 Windows 系统用户密码.Ophcrack 使用预先计算的彩虹表(rainbow table)来加快密码破解过程.彩虹表是一种密码哈希值和对应明文密码的大规模预计算表格,可以显著提高密码破解效率.</p>
</blockquote>
<h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt/PasswordDic/密码]</span><br><span class="line">└─<span class="comment"># ophcrack-cli</span></span><br><span class="line">ophcrack 3.8.0由Objectif Securite(http://www.objectif-securite.ch)开发</span><br><span class="line"></span><br><span class="line">用法:ophcrack [OPTIONS]</span><br><span class="line">使用彩虹表破解Windows密码</span><br><span class="line">    -a                  禁用审计模式(默认)</span><br><span class="line">    -A                  启用审计模式</span><br><span class="line">    -b                  禁用暴力破解</span><br><span class="line">    -B                  启用暴力破解(默认)</span><br><span class="line">    -c config_file      指定要使用的配置文件</span><br><span class="line">    -D                  显示(大量的!)调试信息</span><br><span class="line">    -d <span class="built_in">dir</span>              指定表的基本目录</span><br><span class="line">    -e                  不显示空密码</span><br><span class="line">    -f file             从指定的文件加载哈希值(pwdump或会话)</span><br><span class="line">    -g                  禁用图形用户界面(GUI)</span><br><span class="line">    -h                  显示此信息</span><br><span class="line">    -i                  隐藏用户名</span><br><span class="line">    -I                  显示用户名(默认)</span><br><span class="line">    -l file             将所有输出记录到指定的文件</span><br><span class="line">    -n num              指定要使用的线程数</span><br><span class="line">    -o file             将破解结果以pwdump格式写入文件</span><br><span class="line">    -p num              预加载(0无,1索引,2索引+结束,3全部默认)</span><br><span class="line">    -q                  静默模式</span><br><span class="line">    -r                  在ophcrack启动时启动破解(仅限GUI)</span><br><span class="line">    -s                  禁用会话自动保存</span><br><span class="line">    -S session_file     指定用于自动保存搜索进度的文件</span><br><span class="line">    -u                  破解结束时显示统计信息</span><br><span class="line">    -t table1[,a[,b,...]][:table2[,a[,b,...]]]</span><br><span class="line">                        指定要在-d给出的目录中使用的表</span><br><span class="line">    -v                  冗长模式</span><br><span class="line">    -w <span class="built_in">dir</span>              从目录<span class="built_in">dir</span>中的加密SAM文件加载哈希值</span><br><span class="line">    -x file             将数据以CSV格式导出到文件</span><br><span class="line"></span><br><span class="line">示例:ophcrack -g -d /path/to/tables -t xp_free_fast,0,3:vista_free -f in.txt</span><br><span class="line"></span><br><span class="line">使用命令行启动ophcrack,使用路径/path/to/tables/xp_free_fast中的表0和3以及路径/path/to/tables/vista_free中的所有表,并破解来自in.txt文件的哈希值</span><br><span class="line"><span class="comment"># tables可通过https://ophcrack.sourceforge.io/tables.php下载</span></span><br></pre></td></tr></table></figure>

<h2 id="pwcrack-framework"><a href="#pwcrack-framework" class="headerlink" title="pwcrack-framework"></a>pwcrack-framework</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack]</span><br><span class="line">└─<span class="comment"># git clone https://github.com/L-codes/pwcrack-framework</span></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack]</span><br><span class="line">└─<span class="comment"># cd pwcrack-framework</span></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># bundle update</span></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># bundle install</span></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># banner view</span></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># ./pwcrack banner</span></span><br><span class="line"></span><br><span class="line">                                             </span><br><span class="line">          <span class="string">&quot;$$$$$$&#x27;&#x27;  &#x27;M$  &#x27;$$<span class="variable">$@m</span>            </span></span><br><span class="line"><span class="string">        :$$$$$$$$$$$$$$&#x27;&#x27;$$$$&#x27;               </span></span><br><span class="line"><span class="string">       &#x27;$&#x27;    &#x27;JZI&#x27;$$&amp;  $$$$&#x27;                </span></span><br><span class="line"><span class="string">                 &#x27;$$$  &#x27;$$$$                 </span></span><br><span class="line"><span class="string">                 $$$$  J$$$$&#x27;                </span></span><br><span class="line"><span class="string">                m$$$$  $$$$,                </span></span><br><span class="line"><span class="string">                $$$<span class="variable">$@</span>  &#x27;$$$<span class="variable">$_</span>         pwcrack-framework</span></span><br><span class="line"><span class="string">             &#x27;1t$$$$&#x27; &#x27;$$$$&lt;               </span></span><br><span class="line"><span class="string">          &#x27;$$$$$$$$$$&#x27;  $$$$          version 1.19.0</span></span><br><span class="line"><span class="string">               &#x27;@$$$$&#x27;  $$$$&#x27;                </span></span><br><span class="line"><span class="string">                &#x27;$$$$  &#x27;$$<span class="variable">$@</span>                 </span></span><br><span class="line"><span class="string">             &#x27;z$$$$$$  @$$$                  </span></span><br><span class="line"><span class="string">                r$$$   $$|                   </span></span><br><span class="line"><span class="string">                &#x27;$<span class="variable">$v</span> c$$                     </span></span><br><span class="line"><span class="string">               &#x27;$<span class="variable">$v</span> $$v$$$$$$$$<span class="variable">$#</span>            </span></span><br><span class="line"><span class="string">               $$x$$$$$$$$$twelve$$$@$&#x27;      </span></span><br><span class="line"><span class="string">             @$$<span class="variable">$@L</span> &#x27;    &#x27;&lt;@$$$$$$$$`        </span></span><br><span class="line"><span class="string">           $$                 &#x27;$$$           </span></span><br><span class="line"><span class="string">                                             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    [ Github ] https://github.com/L-codes/pwcrack-framework</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       [ Plugin Count ] </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         Online Plugin: 23        Offline Plugin: 37</span></span><br><span class="line"><span class="string">                   supporting algorithms: 60</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                  [ Algorithm Plugin Count ] </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         serv_u: 21             md5: 21            sha1: 13</span></span><br><span class="line"><span class="string">        dedecms: 10          md5_16: 10           mysql:  8</span></span><br><span class="line"><span class="string">           ntlm:  7          sha512:  7          sha256:  7</span></span><br><span class="line"><span class="string">         mysql3:  6             md4:  4              lm:  4</span></span><br><span class="line"><span class="string">         sha384:  3           mssql:  2          zfsoft:  1</span></span><br><span class="line"><span class="string">         xshell:  1            xftp:  1       websphere:  1</span></span><br><span class="line"><span class="string">    uportal2800:  1          trswcm:  1          signer:  1</span></span><br><span class="line"><span class="string">      seeyon_nc:  1 seeyon_analyze_icloud:  1       seeyon_a8:  1</span></span><br><span class="line"><span class="string">   securecrt_v2:  1       securecrt:  1        richmail:  1</span></span><br><span class="line"><span class="string">      qizhi_php:  1       navicat12:  1       navicat11:  1</span></span><br><span class="line"><span class="string">      mobaxterm:  1     mac_osx_vnc:  1        lsrunase:  1</span></span><br><span class="line"><span class="string">    landray_ekp:  1   juniper_type9:  1        interlib:  1</span></span><br><span class="line"><span class="string">        h3c_imc:  1      h3c_huawei:  1         h3c_cvm:  1</span></span><br><span class="line"><span class="string">        grafana:  1             gpp:  1         foxmail:  1</span></span><br><span class="line"><span class="string">       foxmail6:  1        flashfxp:  1      finereport:  1</span></span><br><span class="line"><span class="string">     finalshell:  1       filezilla:  1       druid_rsa:  1</span></span><br><span class="line"><span class="string">     dongao_rc4:  1       whirlpool:  1          sha224:  1</span></span><br><span class="line"><span class="string">      ripemd320:  1       ripemd256:  1       ripemd160:  1</span></span><br><span class="line"><span class="string">      ripemd128:  1            mdc2:  1             md2:  1</span></span><br><span class="line"><span class="string">      dahan_jis:  1       d3des_vnc:  1       cisco_vpn:  1</span></span><br><span class="line"><span class="string">    cisco_type7:  1</span></span><br></pre></td></tr></table></figure>

<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">用法: ./pwcrack [选项] (密文|获取|横幅|初始化数据库) [算法...]</span><br><span class="line">-q, --quiet                      发现明文后立即退出</span><br><span class="line">-t, --<span class="built_in">timeout</span> 秒                 指定请求超时时间 [默认值: 4]</span><br><span class="line">-o, --open-timeout 秒            指定TCP打开超时时间 [默认值: 8]</span><br><span class="line">-r, --retry 次数                 重试次数 [默认值: 1]</span><br><span class="line">-i, --retry-interval 秒          重试间隔秒数 [默认值: 0.5]</span><br><span class="line">-s, --<span class="keyword">select</span> 插件名称            指定插件 (插件1[,插件2...])</span><br><span class="line">-x, --proxy <span class="string">&quot;协议://IP:端口&quot;</span>     设置代理</span><br><span class="line">-v, --verbose                    以详细模式运行</span><br><span class="line">-d, --debug                      以调试模式运行</span><br><span class="line">--nocolor                    禁用彩色输出</span><br><span class="line">--version                    显示版本</span><br><span class="line"></span><br><span class="line">使用示例:</span><br><span class="line">./pwcrack banner</span><br><span class="line">./pwcrack initdb</span><br><span class="line">./pwcrack e10adc3949ba59abbe56e057f20f883e</span><br><span class="line">./pwcrack e10adc3949ba59abbe56e057f20f883e md5</span><br><span class="line">./pwcrack <span class="built_in">base64</span>:ZTEwYWRjMzk0OWJhNTlhYmJlNTZlMDU3ZjIwZjg4M2UK -s pmd5</span><br></pre></td></tr></table></figure>

<h3 id="简单使用-1"><a href="#简单使用-1" class="headerlink" title="简单使用"></a>简单使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># ./pwcrack e10adc3949ba59abbe56e057f20f883e</span></span><br><span class="line">[+] Cipher Algorithm: MD2 or MD4 or MD5 or MDC2 or LM or NTLM or RIPEMD128 or RICHMAIL or UPORTAL2800 or NAVICAT12 or INTERLIB or FOXMAIL or FOXMAIL6 or FLASHFXP or NAVICAT11 or SECURECRT or D3DES_VNC or SEEYON_NC or SEEYON_ANALYZE_ICLOUD</span><br><span class="line"></span><br><span class="line">( 0.69s)           bugbank: 123456</span><br><span class="line">( 0.69s)            cmd5la: 包含123456的字符串</span><br><span class="line">( 0.64s)             ttmd5: 123456</span><br><span class="line">( 0.78s)           localdb: 123456</span><br><span class="line">( 2.09s)            hashes: 123456</span><br><span class="line">( 2.18s)           gromweb: 123456</span><br><span class="line">( 2.22s)       md5_my_addr: 123456</span><br><span class="line">( 2.87s)            dehash: 123456</span><br><span class="line">( 2.88s)        md5cracker: 123456</span><br><span class="line"></span><br><span class="line">[+] PWCrack (9/33) <span class="keyword">in</span> 21.21 seconds.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(root㉿kill3r)-[/opt/pwcrack/pwcrack-framework]</span><br><span class="line">└─<span class="comment"># ./pwcrack e10adc3949ba59abbe56e057f20f883e md5</span></span><br><span class="line">[+] Cipher Algorithm: MD5</span><br><span class="line"></span><br><span class="line">( 0.40s)            cmd5la: 包含123456的字符串</span><br><span class="line">( 0.45s)           localdb: 123456</span><br><span class="line">( 0.38s)             ttmd5: 123456</span><br><span class="line">( 0.41s)           bugbank: 123456</span><br><span class="line">( 0.74s)              cmd5: 123456</span><br><span class="line">( 1.00s)            cmd5en: 123456</span><br><span class="line">( 1.17s)       md5_my_addr: 123456</span><br><span class="line">( 1.85s)           gromweb: 123456</span><br><span class="line">( 1.84s)        md5cracker: 123456</span><br><span class="line">( 4.13s)            hashes: 123456</span><br><span class="line">( 6.30s)            dehash: 123456</span><br><span class="line"></span><br><span class="line">[+] PWCrack (11/21) <span class="keyword">in</span> 20.61 seconds.</span><br></pre></td></tr></table></figure>

<h2 id="RainbowCrack"><a href="#RainbowCrack" class="headerlink" title="RainbowCrack"></a>RainbowCrack</h2><blockquote>
<ul>
<li>基于时间记忆权衡技术生成彩虹表</li>
<li>提前计算密码的HASH值,通过比对HASH值破解密码</li>
<li>计算HASH的速度很慢,修改版支持CUDA GPU</li>
<li>Kali中包含的RainbowCrack工具<ul>
<li>rtgen:预计算,生成彩虹表,耗时的阶段</li>
<li>rtsort:对rtgen生成的彩虹表进行排序</li>
<li>tcrack:查找彩虹表破解密码</li>
<li>以上命令必须顺序使用</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>彩虹表攻击(RainbowCrack)是<mark class="tag-plugin colorful mark" color="red">利用彩虹表</mark>来<mark class="tag-plugin colorful mark" color="red">破解哈希数据的工具.</mark>它实现了由<code>PhILippe Oechslin</code>提倡的”以空间换时间”的技术思想</p>
<p>在进行彩虹表离线破解时,我们需要拥有目标Hash散列值</p>
<h4 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h4><mark class="tag-plugin colorful mark" color="red">这种密码破解的方式有别于暴力破解</mark>,暴力破解攻击首先计算密码的备选值(字典里的密码)的Hash值,然后再将计算出来的Hash与获取到的Hash进行对比,如果这两个值相等,则确定Hash的原始内容即是密码;否则就说明密码不正确

<h4 id="彩虹表破解法"><a href="#彩虹表破解法" class="headerlink" title="彩虹表破解法"></a>彩虹表破解法</h4><mark class="tag-plugin colorful mark" color="red">彩虹表破解的效率也高于暴力破解法</mark>,因为暴力破解法必须计算字典内容的Hash值然后进行匹配,而使用"以空间换时间"技术的彩虹表破解法,<mark class="tag-plugin colorful mark" color="red">实现就计算好了字典各项的Hash值,破解过程只是简单的数值比较</mark>,所以效率更高

<h4 id="彩虹表的组成方式"><a href="#彩虹表的组成方式" class="headerlink" title="彩虹表的组成方式"></a>彩虹表的组成方式</h4><p>彩虹表的组成方式实际是以指定数量,或者无数条彩虹链组成的</p>
<h3 id="RainbowCrack-implements"><a href="#RainbowCrack-implements" class="headerlink" title="RainbowCrack implements"></a>RainbowCrack implements</h3><blockquote>
<p>Kali Linux收录了RainbowCrack的三大工具.在破解Hash时,您必须依次使用这些工具.</p>
<ul>
<li>rtgen:生成彩虹表的程序.生成彩虹表的计算过程也被称为彩虹表的预计算阶段.彩虹表包含字典、哈希值、哈希算法、字符集以及字典的长度范围.彩虹表的预计算相当费时.但是生成彩虹表之后,彩虹表破解法将比暴力破解法的效率要高上不少.rtgen程序支持的算法有LanMan、NTLM、MD2、MD4、MD5、SHA1以及RIPEMD160</li>
<li>rtsort:对rtgen生成的彩虹表进行排序的工具</li>
<li>rcrack:利用彩虹表查找哈希值的工具</li>
</ul>
<p>而Windows端我们使用rainbowcrack即可</p>
</blockquote>
<h4 id="rtgen生成"><a href="#rtgen生成" class="headerlink" title="rtgen生成"></a>rtgen生成</h4><p>rtgen支持算法:LanMan、NTLM、MD2、MD4、MD5、SHA1以及RIPEMD160</p>
<p>本次操作实例为使用rtgen生成MD5彩虹表</p>
<mark class="tag-plugin colorful mark" color="warning">在Kali Linux中使用rtgen生成的彩虹表都默认保存在该目录下:/usr/share/rainbowcrack</mark>

<p>运行该工具输出帮助命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen </span></span><br><span class="line">RainbowCrack 1.8</span><br><span class="line">版权所有2020年彩虹表项目.保留所有权利.</span><br><span class="line">http://project-rainbowcrack.com/</span><br><span class="line"></span><br><span class="line">用法: </span><br><span class="line">rtgen 哈希算法 字符集 最小明文长度 最大明文长度 表索引 链长度 链数量 分块索引</span><br><span class="line">rtgen 哈希算法 字符集 最小明文长度 最大明文长度 表索引 -bench</span><br><span class="line"></span><br><span class="line">已实现的哈希算法:</span><br><span class="line">    lm HashLen=8 PlaintextLen=0-7</span><br><span class="line">    ntlm HashLen=16 PlaintextLen=0-15</span><br><span class="line">    md5 HashLen=16 PlaintextLen=0-15</span><br><span class="line">    sha1 HashLen=20 PlaintextLen=0-20</span><br><span class="line">    sha256 HashLen=32 PlaintextLen=0-20</span><br><span class="line"></span><br><span class="line">示例:</span><br><span class="line">    rtgen md5 loweralpha 1 7 0 1000 1000 0</span><br><span class="line">    rtgen md5 loweralpha 1 7 0 -bench</span><br></pre></td></tr></table></figure>

<p>可以分析看到,rtgen通过不同的数字限制操作生成的彩虹表面积</p>
<p>同时指定<code>loweralpha</code>以生成为<code>abcdefghjklmnopqrstuvwxyz</code>的<code>rainbow tables</code></p>
<p><strong>参数分析</strong></p>
<table>
<thead>
<tr>
<th>code</th>
<th>explanation</th>
</tr>
</thead>
<tbody><tr>
<td><code>hash_algorithm</code></td>
<td>该参数以指定Hash算法目前rtgen支持算法如下:lm、ntlm、md5、sha1、mysqlsha1、halflmchall、ntlmchall、oracle-SYSTEM和md5-half</td>
</tr>
<tr>
<td><code>charset</code></td>
<td>该参数以指定不同的字符集,包括了明文所有可能字符,该参数在配置文件<code>/usr/share/rainbowcrack/charset.txt</code>中被定义,其中包括其他指定</td>
</tr>
<tr>
<td><code>plaintext_len_min</code></td>
<td>该参数指定为使用明文生成的最小长度</td>
</tr>
<tr>
<td><code>plaintext_len_max</code></td>
<td>该参数指定为使用明文生成的最大长度,两个参数是共同作用,如果我们指定为loweralpha 1 7 那么则会生成a-f的不同长度彩虹链</td>
</tr>
<tr>
<td><code>table_index</code></td>
<td>该参数指定<code>归约函数</code>,关于归约函数的概念我们上方提过了,以及简述生成彩虹表的归约函数不同又有什么作用</td>
</tr>
<tr>
<td><code>chain_len</code></td>
<td>该参数指定每一条彩虹链的长度,更长的彩虹链存储更多的明文,需要更长的时间来生成</td>
</tr>
<tr>
<td><code>chain_num</code></td>
<td>该参数指定要生成彩虹链的数量,彩虹表只是彩虹链的阵列.每个彩虹链的大小为16个字节</td>
</tr>
<tr>
<td><code>part_index</code></td>
<td>该参数意义忽视即可,在生成彩虹表时,均以0值操作</td>
</tr>
</tbody></table>
<h5 id="生成彩虹表"><a href="#生成彩虹表" class="headerlink" title="生成彩虹表"></a>生成彩虹表</h5> <div class="tag-plugin colorful note" color="red"><div class="body"><p>通常情况下,我们会生成彩虹表使用不同的归约函数,来代替庞大的彩虹链数量,以节省时间,同时提高成功率</p></div></div>

<p>这里就生成两张彩虹表参考即可</p>
<p>最终生成的彩虹表会在其默认目录下<code>/usr/share/rainbowcrack</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成以MD5散列值、明文组合为a-z最小长度为1,最大长度为10的彩虹表,并且每一条彩虹链长度为2000,增加我们生成的彩虹表大小,生成8000个彩虹链,最终组成彩虹表</span></span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen md5 loweralpha 1 10 0 2000 80000 0</span></span><br><span class="line">rainbow table md5_loweralpha<span class="comment">#1-10_0_2000x80000_0.rt parameters</span></span><br><span class="line"><span class="built_in">hash</span> algorithm:         md5</span><br><span class="line"><span class="built_in">hash</span> length:            16</span><br><span class="line">charset name:           loweralpha</span><br><span class="line">charset data:           abcdefghijklmnopqrstuvwxyz</span><br><span class="line">charset data <span class="keyword">in</span> hex:    61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a </span><br><span class="line">charset length:         26</span><br><span class="line">plaintext length range: 1 - 10</span><br><span class="line">reduce offset:          0x00000000</span><br><span class="line">plaintext total:        146813779479510</span><br><span class="line"></span><br><span class="line">sequential starting point begin from 0 (0x0000000000000000)</span><br><span class="line">generating...</span><br><span class="line">80000 of 80000 rainbow chains generated (0 m 15.2 s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们同样可以猜测密码长度...这只是时间问题和大小问题罢了</span></span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen md5 loweralpha 4 5 0 2000 80000 0</span></span><br><span class="line"><span class="comment"># 使用不同的归约函数</span></span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen md5 loweralpha 4 5 1 2000 80000 0</span></span><br><span class="line">rainbow table md5_loweralpha<span class="comment">#4-5_1_2000x80000_0.rt parameters</span></span><br><span class="line"><span class="built_in">hash</span> algorithm:         md5</span><br><span class="line"><span class="built_in">hash</span> length:            16</span><br><span class="line">charset name:           loweralpha</span><br><span class="line">charset data:           abcdefghijklmnopqrstuvwxyz</span><br><span class="line">charset data <span class="keyword">in</span> hex:    61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a </span><br><span class="line">charset length:         26</span><br><span class="line">plaintext length range: 4 - 5</span><br><span class="line">reduce offset:          0x00010000</span><br><span class="line">plaintext total:        12338352</span><br><span class="line"></span><br><span class="line">sequential starting point begin from 0 (0x0000000000000000)</span><br><span class="line">generating...</span><br><span class="line">80000 of 80000 rainbow chains generated (0 m 12.2 s)</span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen md5 loweralpha 4 5 2 2000 80000 0</span></span><br><span class="line">rainbow table md5_loweralpha<span class="comment">#4-5_2_2000x80000_0.rt parameters</span></span><br><span class="line"><span class="built_in">hash</span> algorithm:         md5</span><br><span class="line"><span class="built_in">hash</span> length:            16</span><br><span class="line">charset name:           loweralpha</span><br><span class="line">charset data:           abcdefghijklmnopqrstuvwxyz</span><br><span class="line">charset data <span class="keyword">in</span> hex:    61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a </span><br><span class="line">charset length:         26</span><br><span class="line">plaintext length range: 4 - 5</span><br><span class="line">reduce offset:          0x00020000</span><br><span class="line">plaintext total:        12338352</span><br><span class="line"></span><br><span class="line">sequential starting point begin from 0 (0x0000000000000000)</span><br><span class="line">generating...</span><br><span class="line">80000 of 80000 rainbow chains generated (0 m 12.0 s)</span><br><span class="line">                                                      </span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtgen md5 loweralpha 4 5 3 2000 80000 0</span></span><br><span class="line">rainbow table md5_loweralpha<span class="comment">#4-5_3_2000x80000_0.rt parameters</span></span><br><span class="line"><span class="built_in">hash</span> algorithm:         md5</span><br><span class="line"><span class="built_in">hash</span> length:            16</span><br><span class="line">charset name:           loweralpha</span><br><span class="line">charset data:           abcdefghijklmnopqrstuvwxyz</span><br><span class="line">charset data <span class="keyword">in</span> hex:    61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a </span><br><span class="line">charset length:         26</span><br><span class="line">plaintext length range: 4 - 5</span><br><span class="line">reduce offset:          0x00030000</span><br><span class="line">plaintext total:        12338352</span><br><span class="line"></span><br><span class="line">sequential starting point begin from 0 (0x0000000000000000)</span><br><span class="line">generating...</span><br><span class="line">80000 of 80000 rainbow chains generated (0 m 12.1 s)</span><br></pre></td></tr></table></figure>

<h5 id="rtsort-排序"><a href="#rtsort-排序" class="headerlink" title="rtsort 排序"></a>rtsort 排序</h5><p>生成好了彩虹表,我们应当对其进行排序,以帮助我们更快速的破解</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里有个坑,指定文件名无法排序</span></span><br><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rtsort .                                     </span></span><br><span class="line">./md5_loweralpha<span class="comment">#4-5_2_2000x80000_0.rt:</span></span><br><span class="line">3139784704 bytes memory available</span><br><span class="line">loading data...</span><br><span class="line">sorting data...</span><br><span class="line">writing sorted data...</span><br><span class="line"></span><br><span class="line">./md5_loweralpha<span class="comment">#4-5_3_2000x80000_0.rt:</span></span><br><span class="line">3139784704 bytes memory available</span><br><span class="line">loading data...</span><br><span class="line">sorting data...</span><br><span class="line">writing sorted data...</span><br><span class="line"></span><br><span class="line">./md5_loweralpha<span class="comment">#4-5_1_2000x80000_0.rt:</span></span><br><span class="line">3139784704 bytes memory available</span><br><span class="line">loading data...</span><br><span class="line">sorting data...</span><br><span class="line">writing sorted data...</span><br><span class="line"></span><br><span class="line">./md5_loweralpha<span class="comment">#1-10_0_2000x80000_0.rt:</span></span><br><span class="line">3139784704 bytes memory available</span><br><span class="line">loading data...</span><br><span class="line">sorting data...</span><br><span class="line">writing sorted data...</span><br></pre></td></tr></table></figure>

<h5 id="rcrcak破解"><a href="#rcrcak破解" class="headerlink" title="rcrcak破解"></a>rcrcak破解</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rcrack -h</span></span><br><span class="line">RainbowCrack 1.8</span><br><span class="line">Copyright 2020 RainbowCrack Project. All rights reserved.</span><br><span class="line">http://project-rainbowcrack.com/</span><br><span class="line"></span><br><span class="line">usage: ./rcrack path [path] [...] -h <span class="built_in">hash</span></span><br><span class="line">       ./rcrack path [path] [...] -l hash_list_file</span><br><span class="line">       ./rcrack path [path] [...] -lm pwdump_file</span><br><span class="line">       ./rcrack path [path] [...] -ntlm pwdump_file</span><br><span class="line">path:              directory <span class="built_in">where</span> rainbow tables (*.rt, *.rtc) are stored</span><br><span class="line">-h <span class="built_in">hash</span>:           load single <span class="built_in">hash</span></span><br><span class="line">-l hash_list_file: load hashes from a file, each <span class="built_in">hash</span> <span class="keyword">in</span> a line</span><br><span class="line">-lm pwdump_file:   load lm hashes from pwdump file</span><br><span class="line">-ntlm pwdump_file: load ntlm hashes from pwdump file</span><br><span class="line"></span><br><span class="line">implemented <span class="built_in">hash</span> algorithms:</span><br><span class="line">    lm HashLen=8 PlaintextLen=0-7</span><br><span class="line">    ntlm HashLen=16 PlaintextLen=0-15</span><br><span class="line">    md5 HashLen=16 PlaintextLen=0-15</span><br><span class="line">    sha1 HashLen=20 PlaintextLen=0-20</span><br><span class="line">    sha256 HashLen=32 PlaintextLen=0-20</span><br><span class="line"></span><br><span class="line">examples:</span><br><span class="line">    ./rcrack . -h 5d41402abc4b2a76b9719d911017c592</span><br><span class="line">    ./rcrack . -l hash.txt</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>释义</th>
</tr>
</thead>
<tbody><tr>
<td><code>-h</code></td>
<td><code>-h</code>指定单个散列值破解</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>若散列Hash值较多,可以保存在一个文件中,<code>-l</code>指定读取散列值文件内的散列进行破解</td>
</tr>
<tr>
<td><code>-lm</code></td>
<td>加载有关Windows 2003内比较老的机器的系统散列值加密算法<code>lm</code>散列文件,与上一个指令相同,他的不同就在于:若破解有关的lm的多个散列组成的文件,需要指定</td>
</tr>
<tr>
<td><code>-ntlm</code></td>
<td>与<code>-lm</code>相同,<code>ntlm</code>是Windows现如今流行的系统加密算法</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kill3r)-[/usr/share/rainbowcrack]</span><br><span class="line">└─<span class="comment"># rcrack . -h 21232f297a57a5a743894a0e4a801fc3</span></span><br><span class="line">4 rainbow tables found</span><br><span class="line">memory available: 2510874214 bytes</span><br><span class="line">memory <span class="keyword">for</span> rainbow chain traverse: 32000 bytes per <span class="built_in">hash</span>, 32000 bytes <span class="keyword">for</span> 1 hashes</span><br><span class="line">memory <span class="keyword">for</span> rainbow table buffer: 4 x 1280016 bytes</span><br><span class="line">disk: ./md5_loweralpha<span class="comment">#1-10_0_2000x80000_0.rt: 1280000 bytes read</span></span><br><span class="line">disk: ./md5_loweralpha<span class="comment">#4-5_1_2000x80000_0.rt: 1280000 bytes read</span></span><br><span class="line">disk: ./md5_loweralpha<span class="comment">#4-5_2_2000x80000_0.rt: 1280000 bytes read</span></span><br><span class="line">disk: ./md5_loweralpha<span class="comment">#4-5_3_2000x80000_0.rt: 1280000 bytes read</span></span><br><span class="line">disk: finished reading all files</span><br><span class="line">plaintext of 21232f297a57a5a743894a0e4a801fc3 is admin</span><br><span class="line"></span><br><span class="line">statistics</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">plaintext found:                             1 of 1</span><br><span class="line">total time:                                  0.40 s</span><br><span class="line">time of chain traverse:                      0.39 s</span><br><span class="line">time of alarm check:                         0.00 s</span><br><span class="line">time of disk <span class="built_in">read</span>:                           0.01 s</span><br><span class="line"><span class="built_in">hash</span> &amp; reduce calculation of chain traverse: 3996000</span><br><span class="line"><span class="built_in">hash</span> &amp; reduce calculation of alarm check:    896</span><br><span class="line">number of alarm:                             130</span><br><span class="line">performance of chain traverse:               10.22 million/s</span><br><span class="line">performance of alarm check:                  0.45 million/s</span><br><span class="line"></span><br><span class="line">result</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">21232f297a57a5a743894a0e4a801fc3  admin  hex:61646d696e        </span><br></pre></td></tr></table></figure>



</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">回顾上一篇</div><a href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%9C%A8%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html">二. 在线密码破解</a></div><div class="item" id="next"><div class="note">接下来阅读</div><a href="/wiki/VulnerabilityInsightDocs/%E4%B8%89.%20SQL%E6%B3%A8%E5%85%A5.html">三. SQL注入</a></div></section></div>


  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>快来参与讨论吧~</p>

    </section>
    <section class='body cmt-body waline'>
      

<div id="waline_container" class="waline_thread"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>

    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs15">博客</span><a href="/">近期</a><a href="/categories/">分类</a><a href="/tags/">标签</a><a href="/archives/">归档</a><a href="/tools/">工具</a></div><div class="sitemap-group"><span class="fs15">笔记</span><a href="/wiki/tags/DevOps/index.html">DevOps</a><a href="/wiki/tags/Vulnerability/index.html">常见漏洞分析</a><a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a></div><div class="sitemap-group"><span class="fs15">社交</span><a href="/friends/">友链</a><a href="/comments/">留言板</a></div><div class="sitemap-group"><span class="fs15">更多</span><a href="/about/">关于本站</a><a target="_blank" rel="noopener" href="https://github.com/JiangJiYue">GitHub</a></div></div><div class="text"><center>
  <p>本破站由 <a href="/">@SafeKiller Zone</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> 主题创建。<br>本博客部分素材来源于网络，如有侵权请联系<a href="mailto:jiangjiyue1@gmail.com">jiangjiyue1@gmail.com</a>删除<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
  <!--不蒜子计数器-->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span>本"页面"访问 <span id="busuanzi_value_page_pv"></span> 次 | 👀总访问 <span id="busuanzi_value_site_pv"></span> 次 | 总访客 <span id="busuanzi_value_site_uv"></span> 人</span>
  <br>
  <span id="runtime_span"></span>
  <script type="text/javascript">
    // JavaScript for showing runtime here
  </script>
</center>
<div style="display: flex;justify-content: center;align-items: center;margin: 10px;">
  <a target="_blank" rel="noopener" href="https://notbyai.fyi/"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/website/Written-By-Human-white.png" style="width:140px;height:50px;margin-right: 10px " id='notbyai'></a>
  <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/website/by-nc-sa.eu.png" style="width:140px;height:50px"></a>
</div>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%B8%8C-%E5%AF%86%E7%A0%81%E5%9F%BA%E7%A1%80"><span class="toc-text">哈希-密码基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD"><span class="toc-text">专业术语</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%B8%8C-%E6%95%A3%E5%88%97-%E5%87%BD%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">哈希(散列)函数是什么?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-text">哈希函数介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hash%E7%A2%B0%E6%92%9E"><span class="toc-text">hash碰撞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-text">哈希的用途</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8hash%E8%BF%9B%E8%A1%8C%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81"><span class="toc-text">使用hash进行密码验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B2%E8%8C%83%E5%BD%A9%E8%99%B9%E8%A1%A8"><span class="toc-text">防范彩虹表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8-%E5%AF%86%E7%A0%81%E5%9F%BA%E7%A1%80"><span class="toc-text">彩虹表-密码基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E5%AF%86%E7%A0%81%E6%89%8D%E6%98%AF%E5%AE%89%E5%85%A8%E7%9A%84"><span class="toc-text">如何存储密码才是安全的?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E4%B8%8D%E6%98%AF-%E5%AF%86%E7%A0%81%E2%80%93-%E6%98%8E%E6%96%87-%E7%9A%84%E7%AE%80%E5%8D%95%E5%AD%98%E5%82%A8"><span class="toc-text">彩虹表不是 密码–&gt;明文 的简单存储</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%9A%84%E5%89%8D%E8%BA%AB%E2%80%93%E9%A2%84%E5%85%88%E8%AE%A1%E7%AE%97%E7%9A%84%E6%95%A3%E5%88%97%E9%93%BE"><span class="toc-text">彩虹表的前身–预先计算的散列链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8"><span class="toc-text">彩虹表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">彩虹表的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E4%B8%AD%E6%97%B6%E9%97%B4%E3%80%81%E7%A9%BA%E9%97%B4%E7%9A%84%E5%B9%B3%E8%A1%A1"><span class="toc-text">彩虹表中时间、空间的平衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%BD%A9%E8%99%B9%E8%A1%A8%E5%92%8CR%E5%87%BD%E6%95%B0%E4%B8%BE%E4%BE%8B"><span class="toc-text">常见的彩虹表和R函数举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-text">彩虹表的获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%98%B2%E5%BE%A1%E5%BD%A9%E8%99%B9%E8%A1%A8"><span class="toc-text">如何防御彩虹表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%92%E7%BA%A6%E5%87%BD%E6%95%B0"><span class="toc-text">归约函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE"><span class="toc-text">前置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-text">作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%90%E8%BF%B0%E5%BD%92%E7%BA%A6%E8%BF%87%E7%A8%8B"><span class="toc-text">阐述归约过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%A0%B4%E8%A7%A3%E6%95%A3%E5%88%97%E5%80%BC%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="toc-text">彩虹表破解散列值的基本思想</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-%E8%AE%A4%E8%AF%81-%E5%AF%86%E7%A0%81%E5%9F%BA%E7%A1%80"><span class="toc-text">Windows 认证-密码基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Hash"><span class="toc-text">Windows Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-Hash%E7%AE%80%E4%BB%8B"><span class="toc-text">Windows Hash简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NTLM-Hash"><span class="toc-text">NTLM Hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LM-Hash"><span class="toc-text">LM Hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-text">本地认证流程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Net-NTLM-Hash-Windows-%E7%BD%91%E7%BB%9C%E8%AE%A4%E8%AF%81"><span class="toc-text">Net NTLM Hash(Windows 网络认证)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NTLM-NT-LAN-Manager-%E5%8D%8F%E8%AE%AE"><span class="toc-text">NTLM(NT LAN Manager) 协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NTLM-V2%E5%8D%8F%E8%AE%AE"><span class="toc-text">NTLM V2协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E7%B1%BB%E5%9E%8B%E8%AF%86%E5%88%AB"><span class="toc-text">哈希类型识别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash-identifier"><span class="toc-text">Hash-identifier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hashid"><span class="toc-text">Hashid</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HashCat"><span class="toc-text">HashCat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hashcat%E7%AE%80%E4%BB%8B"><span class="toc-text">hashcat简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashcat%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">hashcat常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-id-%E5%AF%B9%E7%85%A7%E8%A1%A8"><span class="toc-text">hash id 对照表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3MD5%E5%80%BC"><span class="toc-text">暴力破解MD5值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3windows%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81"><span class="toc-text">破解windows系统密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#John-the-Ripper"><span class="toc-text">John the Ripper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#John"><span class="toc-text">John</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#john-John-the-Ripper%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3%E5%99%A8"><span class="toc-text">john - John the Ripper密码破解器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#john-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">john 使用示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#john-%E7%A0%B4%E8%A7%A3windows%E5%AF%86%E7%A0%81"><span class="toc-text">john 破解windows密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ophcrack"><span class="toc-text">Ophcrack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-text">简单使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwcrack-framework"><span class="toc-text">pwcrack-framework</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%B3%95"><span class="toc-text">用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8-1"><span class="toc-text">简单使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RainbowCrack"><span class="toc-text">RainbowCrack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-text">暴力破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%A0%B4%E8%A7%A3%E6%B3%95"><span class="toc-text">彩虹表破解法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%A9%E8%99%B9%E8%A1%A8%E7%9A%84%E7%BB%84%E6%88%90%E6%96%B9%E5%BC%8F"><span class="toc-text">彩虹表的组成方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RainbowCrack-implements"><span class="toc-text">RainbowCrack implements</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rtgen%E7%94%9F%E6%88%90"><span class="toc-text">rtgen生成</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%BD%A9%E8%99%B9%E8%A1%A8"><span class="toc-text">生成彩虹表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rtsort-%E6%8E%92%E5%BA%8F"><span class="toc-text">rtsort 排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rcrcak%E7%A0%B4%E8%A7%A3"><span class="toc-text">rcrcak破解</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"codeblock":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.27.0" async></script>

<!-- optional -->

  <script type="module">
  import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js'

  function load_comment(){
    if(!document.getElementById("waline_container"))return;

    utils.css('https://unpkg.com/@waline/client@v3/dist/waline.css');
    utils.css('https://gcore.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline-meta.css');

    const el = document.getElementById("waline_container");
    var path = el.getAttribute('comment_id');
    if (!path) {
      path = decodeURI(window.location.pathname);
    }

    const waline = init(Object.assign({"js":"https://unpkg.com/@waline/client@v3/dist/waline.js","css":"https://unpkg.com/@waline/client@v3/dist/waline.css","meta_css":"https://gcore.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline-meta.css","serverURL":"https://www.regret.live","commentCount":true,"pageview":false,"locale":{"placeholder":"有什么想说的？大胆说出来吧(*^_^*)","reactionTitle":"请给这篇文章做个评价吧","reaction0":"感兴趣","reaction1":"给心心","reaction2":"什么？","reaction3":"心碎了","reaction4":"别过来","reaction5":"矮油~","reaction6":"不忍直视","reaction7":"我真生气辣！","reaction8":"摇晃","level0":"潜水","level1":"冒泡","level2":"吐槽","level3":"活跃","level4":"话痨","level5":"传说"},"reaction":["/emojis/ablobcatattentionreverse.png","/emojis/ablobcatheart.png","/emojis/ablobcatdoubt.png","/emojis/ablobcatheartbroken.png","/emojis/ablobcatterrified.png","/emojis/ablobcatshy.png","/emojis/ablobcatnoface.png","/emojis/ablobcatanger.gif","/emojis/ablobcatrainbow.png"],"emoji":["https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs"]}, {
      el: '#waline_container',
      path: path,
      
    }));

  }
  window.addEventListener('DOMContentLoaded', (event) => {
    load_comment();
  });

</script>




<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.swiper-slide img, .gallery img ,#waline_container .vcontent img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || null
        }
      });
    })
  }
</script><script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          loop: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script><script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->
<script type="text/javascript" src="/js/darkmode.js"></script>
</div></body></html>
